attr global userattr DbLogExclude DbLogInclude cmdIcon devStateIcon devStateStyle fp_Erdgeschoss fp_fp_test icon sortby structexclude uiDeviceColor uiDeviceIcon uiDeviceType uiDeviceTypeParameter uiDisplayName uiDisplayOrder uiDisplayRoom uiGet uiOption uiSet uiShow uiWatch verboseTelegram webCmd webCmdLabel:textField-long webcmdDevice widgetOverride
attr global autoload_undefined_devices 1
attr global autosave 0
attr global backup_before_update 0
attr global dnsServer 192.168.0.1
attr global exclude_from_update 15_vz.pm 15_CUL_EM.pm 98_PID20.pm
attr global language EN
attr global latitude 50.106173
attr global logfile ./log/fhem-%Y-%m-%d.log
attr global longitude 8.662170
attr global modpath .
attr global motd SecurityCheck:\
  telnetPort is not password protected\
  WEBnadine is not password protected\
  WEB is not password protected\
  MQTT_SERVER is not password protected\
  WEBdevel is not password protected\
\
Protect this FHEM installation by defining an allowed device with define allowed allowed\
You can disable this message with attr global motd none
attr global mseclog 1
attr global room HTTP,System
attr global sendStatistics onUpdate
attr global stacktrace 0
attr global statefile ./log/fhem.save
attr global title Main-FHEM
attr global updateInBackground 0
attr global verbose 4
attr global verboseTelegram 3
# Statistics: onUpdate|manually|never
#attr global uniqueID ./FHEM/FhemUtils/uniqueID

define telnetPort telnet 7072 global
attr telnetPort room System

define WEB FHEMWEB 8083 global
attr WEB JavaScripts codemirror/fhem_codemirror.js
attr WEB SVGcache 1
attr WEB codemirrorParam { "lineWrapping":false, "height":"auto"}
attr WEB comment { "lineWrapping":true, "height":"auto", "scrollbarStyle":"null"}
attr WEB confirmDelete 0
attr WEB csrfToken none
attr WEB editConfig 1
attr WEB endPlotNow 1
attr WEB longpoll 1
attr WEB longpollSVG 1
attr WEB mainInputLength 120
attr WEB menuEntries ReloadBOTVAC,http://192.168.0.30:8083/fhem?cmd=reload%2070_BOTVAC.pm,DOIFtools,/fhem?detail=DOIFtools,Grafik,/fhem/frontend/index.html
attr WEB plotEmbed 1
attr WEB plotfork 1
attr WEB room HTTP,System
attr WEB stylesheetPrefix newstephan
#attr WEB plotfork 1
#attr WEB refresh 60
#attr WEB defaultRoom Light
#attr WEB hiddenroom DashboardRoom
#attr WEB iconPath openautomation:fhemSVG
#attr WEB longpoll on # default is on
#attr WEB plotmode SVG # default is SVG
#attr WEB sortRooms Light Cinema Residents Sensors System
# eigene ########################
#attr WEB endPlotToday 1
#attr WEB plotsize 900,200
#attr WEB longpollSVG on


#define WEBphone FHEMWEB 8084 global
#attr WEBphone hiddengroup !LichtAktoren
#attr WEBphone hiddenroom DashboardRoom
#attr WEBphone room HTTP,System
#attr WEBphone stylesheetPrefix smallscreen
#attr WEBphone iconPath openautomation:fhemSVG
#attr WEBphone sortRooms Light Cinema Residents Sensors System

#define WEBtablet FHEMWEB 8085 global
#attr WEBtablet hiddenroom DashboardRoom
#attr WEBtablet iconPath openautomation:fhemSVG
#attr WEBtablet room System
#attr WEBtablet sortRooms Light Cinema Residents Sensors System
#attr WEBtablet stylesheetPrefix ios7

# Fake FileLog entry, to access the fhem log from FHEMWEB 
define Logfile FileLog ./log/fhem-%Y-%m-%d.log fakelog
attr Logfile nrarchive 10
attr Logfile room Logging

define autocreate autocreate
attr autocreate room System
#attr autocreate disable 1
#attr autocreate autosave 1
#attr autocreate device_room %TYPE
#attr autocreate filelog ./log/%NAME-%Y.log
#attr autocreate weblink 0
#attr autocreate weblink_room Plots

#define et eventTypes log/eventTypes.txt
#attr et room System



#
###############################
#### verschiedene Definitionen 
###############################
#include FHEM/define.cfg

###############################
#### oneWire
###############################
# define myOWServer OWServer localhost:4304
# attr myOWServer room OWDevice

# define DS18B20_Mischer_oben OWDevice 28.6A568A060000 10
# attr DS18B20_Mischer_oben IODev myOWServer
# attr DS18B20_Mischer_oben event-on-change-reading .*
# attr DS18B20_Mischer_oben group Thermometer
# attr DS18B20_Mischer_oben model DS18B20
# attr DS18B20_Mischer_oben resolution 10
# attr DS18B20_Mischer_oben room OWDevice,Heizung
# attr DS18B20_Mischer_oben stateFormat T: temperature °C

# define DS18B20_Mischer_mitte OWDevice 28.F4C58A060000 10
# attr DS18B20_Mischer_mitte DbLogExclude failures,T,85
# attr DS18B20_Mischer_mitte IODev myOWServer
# attr DS18B20_Mischer_mitte event-on-change-reading .*
# attr DS18B20_Mischer_mitte group Thermometer
# attr DS18B20_Mischer_mitte model DS18B20
# attr DS18B20_Mischer_mitte resolution 10
# attr DS18B20_Mischer_mitte room OWDevice,Heizung
# attr DS18B20_Mischer_mitte stateFormat T: temperature °C

# define DS18B20_Mischer_unten OWDevice 28.22F389060000 10
# attr DS18B20_Mischer_unten IODev myOWServer
# attr DS18B20_Mischer_unten event-on-change-reading .*
# attr DS18B20_Mischer_unten group Thermometer
# attr DS18B20_Mischer_unten model DS18B20
# attr DS18B20_Mischer_unten resolution 10
# attr DS18B20_Mischer_unten room OWDevice,Heizung
# attr DS18B20_Mischer_unten stateFormat T: temperature °C

# define DS18B20_VorlaufHK OWDevice 28.6B878A060000 10
# attr DS18B20_VorlaufHK IODev myOWServer
# attr DS18B20_VorlaufHK event-on-update-reading temperature
# attr DS18B20_VorlaufHK group Thermometer
# attr DS18B20_VorlaufHK model DS18B20
# attr DS18B20_VorlaufHK resolution 10
# attr DS18B20_VorlaufHK room OWDevice,Heizung
# attr DS18B20_VorlaufHK stateFormat T: temperature °C

# define DS18B20_Speicher_oben OWDevice 28.67B88A060000 10
# attr DS18B20_Speicher_oben IODev myOWServer
# attr DS18B20_Speicher_oben event-on-change-reading .*
# attr DS18B20_Speicher_oben group Thermometer
# attr DS18B20_Speicher_oben model DS18B20
# attr DS18B20_Speicher_oben resolution 10
# attr DS18B20_Speicher_oben room Heizung,OWDevice,Wasser
# attr DS18B20_Speicher_oben stateFormat T: temperature °

# define DS18B20_Speicher_mitte OWDevice 28.AF6551070000 10
# attr DS18B20_Speicher_mitte IODev myOWServer
# attr DS18B20_Speicher_mitte event-on-change-reading .*
# attr DS18B20_Speicher_mitte group Thermometer
# attr DS18B20_Speicher_mitte model DS18B20
# attr DS18B20_Speicher_mitte resolution 10
# attr DS18B20_Speicher_mitte room Heizung,OWDevice,Wasser
# attr DS18B20_Speicher_mitte stateFormat T: temperature °C

# define DS18B20_Ruecklauf_HKGarage OWDevice 28.856820070000 10
# attr DS18B20_Ruecklauf_HKGarage IODev myOWServer
# attr DS18B20_Ruecklauf_HKGarage event-on-change-reading .*
# attr DS18B20_Ruecklauf_HKGarage group Thermometer
# attr DS18B20_Ruecklauf_HKGarage model DS18B20
# attr DS18B20_Ruecklauf_HKGarage resolution 10
# attr DS18B20_Ruecklauf_HKGarage room Heizung,OWDevice
# attr DS18B20_Ruecklauf_HKGarage stateFormat T: temperature °C

# define DS18B20_Ruecklauf_Zirkulation OWDevice 28.3BC952070000 10
# attr DS18B20_Ruecklauf_Zirkulation IODev myOWServer
# attr DS18B20_Ruecklauf_Zirkulation event-on-change-reading .*
# attr DS18B20_Ruecklauf_Zirkulation group WasserThermometer
# attr DS18B20_Ruecklauf_Zirkulation model DS18B20
# attr DS18B20_Ruecklauf_Zirkulation resolution 10
# attr DS18B20_Ruecklauf_Zirkulation room OWDevice,Wasser
# attr DS18B20_Ruecklauf_Zirkulation stateFormat T: temperature °C

# define DS18B20_Vorlauf_WW OWDevice 28.AE7720070000 10
# attr DS18B20_Vorlauf_WW IODev myOWServer
# attr DS18B20_Vorlauf_WW event-on-change-reading .*
# attr DS18B20_Vorlauf_WW group WasserThermometer
# attr DS18B20_Vorlauf_WW model DS18B20
# attr DS18B20_Vorlauf_WW resolution 10
# attr DS18B20_Vorlauf_WW room Wasser,OWDevice
# attr DS18B20_Vorlauf_WW stateFormat T: temperature °C

# define DS18B20_RuecklaufHK OWDevice 28.2B308A060000 10
# attr DS18B20_RuecklaufHK IODev myOWServer
# attr DS18B20_RuecklaufHK event-on-change-reading .*
# attr DS18B20_RuecklaufHK group Thermometer
# attr DS18B20_RuecklaufHK model DS18B20
# attr DS18B20_RuecklaufHK resolution 10
# attr DS18B20_RuecklaufHK room OWDevice,Heizung
# attr DS18B20_RuecklaufHK stateFormat T: temperature °C

# define DS18B20_FlurOG OWDevice 28.FF9BA5A41503 10
# attr DS18B20_FlurOG IODev myOWServer
# attr DS18B20_FlurOG event-on-change-reading .*
# attr DS18B20_FlurOG group RaumThermometer
# attr DS18B20_FlurOG model DS18B20
# attr DS18B20_FlurOG resolution 10
# attr DS18B20_FlurOG room Heizung,OWDevice
# attr DS18B20_FlurOG stateFormat T: temperature °C

# define DS18B20_Schlafzimmer OWDevice 28.FF8EE6A41503 10
# attr DS18B20_Schlafzimmer IODev myOWServer
# attr DS18B20_Schlafzimmer event-on-change-reading .*
# attr DS18B20_Schlafzimmer group RaumThermometer
# attr DS18B20_Schlafzimmer model DS18B20
# attr DS18B20_Schlafzimmer resolution 10
# attr DS18B20_Schlafzimmer room Heizung,OWDevice
# attr DS18B20_Schlafzimmer stateFormat T: temperature °C

# define N_global_define_DS18B20_attr notify global:DEFINED.DS18B20_.* attr $EVTPART1 stateFormat T: temperature °C;; attr $EVTPART1 resolution 10;; attr $EVTPART1 DbLogExclude failures,T,85;; attr $EVTPART1 event-on-change-reading .*;; attr $EVTPART1 room OWDevice,Heizung;;
# attr N_global_define_DS18B20_attr room _notify

# define DS18B20_Ankleide OWDevice 28.FF7DE5A41503 10
# attr DS18B20_Ankleide IODev myOWServer
# attr DS18B20_Ankleide event-on-change-reading .*
# attr DS18B20_Ankleide group RaumThermometer
# attr DS18B20_Ankleide model DS18B20
# attr DS18B20_Ankleide resolution 10
# attr DS18B20_Ankleide room Heizung,OWDevice
# attr DS18B20_Ankleide stateFormat T: temperature °C

# define DS18B20_TEST OWDevice 28.615050070000 10
# attr DS18B20_TEST DbLogExclude failures,T,85
# attr DS18B20_TEST IODev myOWServer
# attr DS18B20_TEST event-on-change-reading .*
# attr DS18B20_TEST model DS18B20
# attr DS18B20_TEST resolution 10
# attr DS18B20_TEST room OWDevice
# attr DS18B20_TEST stateFormat T: temperature °C

# define DS18B20_Ruecklauf_EG_Boden OWDevice 28.59F550070000 10
# attr DS18B20_Ruecklauf_EG_Boden DbLogExclude failures,T,85
# attr DS18B20_Ruecklauf_EG_Boden IODev myOWServer
# attr DS18B20_Ruecklauf_EG_Boden event-on-change-reading .*
# attr DS18B20_Ruecklauf_EG_Boden group Thermometer
# attr DS18B20_Ruecklauf_EG_Boden model DS18B20
# attr DS18B20_Ruecklauf_EG_Boden resolution 10
# attr DS18B20_Ruecklauf_EG_Boden room Heizung,OWDevice
# attr DS18B20_Ruecklauf_EG_Boden stateFormat T: temperature °C

# define DS18B20_Ruecklauf_WT_EG OWDevice 28.058A50070000 10
# attr DS18B20_Ruecklauf_WT_EG DbLogExclude failures,T,85
# attr DS18B20_Ruecklauf_WT_EG IODev myOWServer
# attr DS18B20_Ruecklauf_WT_EG event-on-change-reading .*
# attr DS18B20_Ruecklauf_WT_EG group Thermometer
# attr DS18B20_Ruecklauf_WT_EG model DS18B20
# attr DS18B20_Ruecklauf_WT_EG resolution 10
# attr DS18B20_Ruecklauf_WT_EG room Heizung,OWDevice
# attr DS18B20_Ruecklauf_WT_EG stateFormat T: temperature °C

# define DS18B20_WW_Ausgang_Speicher OWDevice 28.95CD51070000 10
# attr DS18B20_WW_Ausgang_Speicher DbLogExclude failures,T,85
# attr DS18B20_WW_Ausgang_Speicher IODev myOWServer
# attr DS18B20_WW_Ausgang_Speicher event-on-change-reading Zirkutemp:5, temperature,alarm
# attr DS18B20_WW_Ausgang_Speicher group WasserThermometer
# attr DS18B20_WW_Ausgang_Speicher model DS18B20
# attr DS18B20_WW_Ausgang_Speicher resolution 10
# attr DS18B20_WW_Ausgang_Speicher room OWDevice
# attr DS18B20_WW_Ausgang_Speicher stateFormat T: temperature °C
# attr DS18B20_WW_Ausgang_Speicher userReadings zirkutemp { ReadingsVal("DS18B20_WW_Ausgang_Speicher","temperature",0);; }

# define DS18B20_Vorlauf_EG_Boden OWDevice 28.36FE4F070000 10
# attr DS18B20_Vorlauf_EG_Boden DbLogExclude failures,T,85
# attr DS18B20_Vorlauf_EG_Boden IODev myOWServer
# attr DS18B20_Vorlauf_EG_Boden event-on-change-reading .*
# attr DS18B20_Vorlauf_EG_Boden group Thermometer
# attr DS18B20_Vorlauf_EG_Boden model DS18B20
# attr DS18B20_Vorlauf_EG_Boden resolution 10
# attr DS18B20_Vorlauf_EG_Boden room Heizung,OWDevice
# attr DS18B20_Vorlauf_EG_Boden stateFormat T: temperature °C



# define HostAdapter OWDevice 81.E39D30000000
# attr HostAdapter IODev myOWServer
# attr HostAdapter model DS1420
# attr HostAdapter room OWDevice,System

###############################
#### Energiemessung
###############################
# Faktor 2: Ticks gibts doppelt so viele wie dekaLiter
# d.h. Ticks * 0.005 = m³
# Faktor 2: 0.005 * 11kWh/m³ * 12[5-Minuten-Messungen] = kW. Mal schauen... 

#
#define myTwilightN notify myTwilight:.* {fhem("set twilight_condition ". ReadingsVal("myTwilight", "condition", 77))}
#{ReadingsVal("Heizung_Slider","state","0")}
#a0=1&a1=1,2*((20-x)^0,7)+20&a2=&a3=&a4=1&a5=4&a6=8&a7=1&a8=1&a9=1&b0=500&b1=500&b2=20&b3=-20&b4=20&b5=45&b6=10&b7=10&b8=5&b9=5&c0=3&c1=0&c2=1&c3=1&c4=1&c5=1&c6=1&c7=0&c8=0&c9=0&d0=1&d1=20&d2=20&d3=0&d4=&d5=&d6=&d7=&d8=&d9=&e0=&e1=&e2=&e3=&e4=14&e5=14&e6=13&e7=12&e8=0&e9=0&f0=0&f1=1&f2=1&f3=0&f4=0&f5=&f6=&f7=&f8=&f9=&g0=&g1=1&g2=1&g3=0&g4=0&g5=0&g6=Y&g7=ffffff&g8=a0b0c0&g9=6080a0&h0=1&z
#define setVL notify S300TH:temperature.* set VLTemp_Soll {calcVL("20")}
# Vorlauftemperatur regeln
#Bei unzureichender Speicherladung Kessel freigeben:

#
#
#

########################################
define Garagentor_Zustand CUL_FHTTK ed84ce
attr Garagentor_Zustand IODev CUL_0
attr Garagentor_Zustand room x_devel
define FS20_Garage FS20 48c5 00
attr FS20_Garage userattr building building_map floor floor_map room_map structexclude
attr FS20_Garage IODev CUL_0
attr FS20_Garage floor S_EG
attr FS20_Garage follow-on-for-timer 1
attr FS20_Garage group FS20,LichtAktoren
attr FS20_Garage room FS20
define HMS_Kuehlschrank HMS 5f5e
attr HMS_Kuehlschrank DbLogInclude temperature,humidity,taupunkt
attr HMS_Kuehlschrank IODev CUL_0
attr HMS_Kuehlschrank event-on-change-reading .*
attr HMS_Kuehlschrank group Thermometer
attr HMS_Kuehlschrank room OW_Remote
attr HMS_Kuehlschrank stateFormat {sprintf("T: %.1f H: %.1f TP: %.1f ", ReadingsVal($name,"temperature",0), ReadingsVal($name,"humidity",0), ReadingsVal($name,"taupunkt",0))}
attr HMS_Kuehlschrank userReadings dewpoint {myDewpoint($name)}
define D_MischerWert dummy
attr D_MischerWert room Heizung,_dummy
define remotebot TelegramBot
attr remotebot cmdFavorites s
attr remotebot cmdKeyword doit
attr remotebot cmdRestrictedPeer 137545657 157487574 -202196098
attr remotebot cmdReturnEmptyResult 0
attr remotebot cmdSentCommands Lastcmd
attr remotebot defaultPeer -202196098
attr remotebot defaultPeerCopy 1
attr remotebot event-on-change-reading contacts
attr remotebot favorites /energy={sendAllEnergy()};;\
/temp={sendAllTemp()};;\
/hzg={sendAllHeating()};;\
/gasoff=set DF_Gaskessel_Handbetrieb cmd_4;;\
/gason=set DF_Gaskessel_Handbetrieb cmd_2;;\
/gas3600=set DF_Gaskessel_Handbetrieb cmd_3;;\
/vl=set DF_calcVLSoll value;;\
/3t1on=?set KNX32.O02_Aktor_UWP_3000_1500 on;;\
/3t1off=set KNX32.O02_Aktor_UWP_3000_1500 off;;\
/1t3on=?set KNX32.O03_Aktor_UWP_1500_3000 on;;\
/1t3off=set KNX32.O03_Aktor_UWP_1500_3000 off;;\
/alloff=?{SetAllOff()};;\
/order=?{askBeforeExecution()};;
attr remotebot pollingTimeout 30
attr remotebot room Telegram_BOT
define N_Telegram_fhemreload notify global:INITIALIZED {\
fhem("set alarmbot message fhem newly started - just now !");;\
fhem("set KNX02.O01_Aktor_Brunnen on");;\
# Status der Pumpen auslesen und setzen. Im Zweifel "on".\
# my $HZG_main = ReadingsVal("FS20_Pumpe_HZG_main","state","on");;\
# fhem("set FS20_Pumpe_HZG_main $HZG_main");;\
# my $HZG_EG = ReadingsVal("FS20_Pumpe_HZG_EG","state","on");;\
# fhem("set FS20_Pumpe_HZG_EG $HZG_EG");;\
# fhem("set DF_RLA_einaus initialize")\
}
attr N_Telegram_fhemreload room Telegram_BOT,_notify
define WEBnadine FHEMWEB 8089 global
attr WEBnadine editConfig 1
attr WEBnadine hiddengroup FS20,HM485 #1,HM485 #2,HM485 #3
attr WEBnadine hiddenroom _doif,Handy,_structure,PID,CUL_FHTTK,Dashboard,FS20,HM485,HMS,HTTP,Heizung,Logging,OWDevice,SVG,System,TEST,Telegram_BOT,Unsorted,WLAN,Wasser,_at,_dummy,_notify,_watchdog,x_devel,Everything,anyViews,Floorplans,Gastzugang
attr WEBnadine room HTTP,System
define SVG_HZG_OutPower SVG logdb:SVG_HZG_OutPower:HISTORY
attr SVG_HZG_OutPower plotsize 1500,500
attr SVG_HZG_OutPower room SVG,SVG_Heizung
define SVG_Stromzaehler SVG logdb:SVG_Stromzaehler:HISTORY
attr SVG_Stromzaehler plotsize 1500,600
attr SVG_Stromzaehler room SVG
define FS20_Zirkulationspumpe FS20 4806 00
attr FS20_Zirkulationspumpe DbLogInclude state
attr FS20_Zirkulationspumpe IODev CUL_0
attr FS20_Zirkulationspumpe eventMap /on:Ein/off:Aus/on-for-timer 10:10 Sekunden an/on-for-timer 30:30 Sekunden an/
attr FS20_Zirkulationspumpe follow-on-for-timer 1
attr FS20_Zirkulationspumpe room FS20,Wasser
attr FS20_Zirkulationspumpe webCmd Ein:Aus:10 Sekunden an:30 Sekunden an
attr FS20_Zirkulationspumpe webcmdDevice true
define N_global_define_DbLogExclude notify global:DEFINED.* attr $EVTPART1 DbLogExclude .*
attr N_global_define_DbLogExclude disable 1
attr N_global_define_DbLogExclude room _notify
define SVG_logdb_1 SVG logdb:SVG_logdb_1:HISTORY
attr SVG_logdb_1 plotsize 1500,500
attr SVG_logdb_1 room SVG
define D_MischerPID dummy
attr D_MischerPID event-on-update-reading state
attr D_MischerPID room Heizung
define SVG_PID.FUBO SVG logdb:SVG_PID.FUBO:HISTORY
attr SVG_PID.FUBO endPlotNow 1
attr SVG_PID.FUBO plotsize 1300,800
attr SVG_PID.FUBO room Heizung,SVG,x_devel
define WEBdevel FHEMWEB 8085 global
attr WEBdevel editConfig 1
attr WEBdevel longpoll 1
attr WEBdevel room HTTP,System
attr WEBdevel smallscreenCommands 1
attr WEBdevel stylesheetPrefix smallscreen
define SVG_Heizkurve_Offset SVG logdb:SVG_Heizkurve_offset:HISTORY
attr SVG_Heizkurve_Offset plotsize 1500,500
attr SVG_Heizkurve_Offset room SVG

define S300TH CUL_WS 1
attr S300TH DbLogInclude temperature,humidity,taupunkt
attr S300TH comment smoothtemp::linear:median:43200
attr S300TH event-aggregator t1::none:mean:86400,t2::linear:mean:86400,t3:86400:none:mean
attr S300TH group Thermometer
attr S300TH room x_devel
attr S300TH stateFormat {sprintf("T: %.1f Ts: %.1f H: %.1f TP: %.1f ", ReadingsVal("S300TH","temperature",0), ReadingsVal("S300TH","smoothtemp",0), ReadingsVal("S300TH","humidity",0), ReadingsVal("S300TH","taupunkt",0))}
attr S300TH userReadings dewpoint {myDewpoint($name)},smoothtemp {ReadingsVal("S300TH","temperature",0)},t1 {ReadingsVal("S300TH","temperature",0)},t2 {ReadingsVal("S300TH","temperature",0)},t3 {ReadingsVal("S300TH","temperature",0)}
define tul TUL eibd:localhost 1.1.3
attr tul room KNX
define KNX01.O01_Status KNX 1/0/1:dpt1
attr KNX01.O01_Status IODev tul
attr KNX01.O01_Status listenonly 1
attr KNX01.O01_Status room KNX
define KNX01.O02_Aktor_Leuchte_Rumpel KNX 1/0/2:dpt1:steuern 1/0/3:dpt1:status
attr KNX01.O02_Aktor_Leuchte_Rumpel DbLogInclude state
attr KNX01.O02_Aktor_Leuchte_Rumpel IODev tul
attr KNX01.O02_Aktor_Leuchte_Rumpel devStateIcon status-on:general_an:Aus status-off:general_aus:Ein steuern.*:hourglass:Aus
attr KNX01.O02_Aktor_Leuchte_Rumpel eventMap /steuern on:on/steuern off:off/
attr KNX01.O02_Aktor_Leuchte_Rumpel room KNX
attr KNX01.O02_Aktor_Leuchte_Rumpel stateRegex /steuern-[sg]et:/steuern-/ /status-get:/status-/
attr KNX01.O02_Aktor_Leuchte_Rumpel webCmd on:off
define KNX01.O03_Aktor_Leuchte_HZGRaum KNX 1/0/4:dpt1
attr KNX01.O03_Aktor_Leuchte_HZGRaum DbLogInclude state
attr KNX01.O03_Aktor_Leuchte_HZGRaum IODev tul
attr KNX01.O03_Aktor_Leuchte_HZGRaum devStateIcon on::off off::on
attr KNX01.O03_Aktor_Leuchte_HZGRaum room KNX
define KNX01.O03_Status KNX 1/0/5:dpt1
attr KNX01.O03_Status IODev tul
attr KNX01.O03_Status listenonly 1
attr KNX01.O03_Status room KNX
define KNX01.O02_Status KNX 1/0/3:dpt1
attr KNX01.O02_Status IODev tul
attr KNX01.O02_Status listenonly 1
attr KNX01.O02_Status room KNX
define KNX01.O04_Aktor_Leuchte_Ankleide KNX 1/0/6:dpt1
attr KNX01.O04_Aktor_Leuchte_Ankleide DbLogInclude state
attr KNX01.O04_Aktor_Leuchte_Ankleide IODev tul
attr KNX01.O04_Aktor_Leuchte_Ankleide devStateIcon on::off off::on
attr KNX01.O04_Aktor_Leuchte_Ankleide room KNX
define KNX01.O04_Status KNX 1/0/7:dpt1
attr KNX01.O04_Status IODev tul
attr KNX01.O04_Status listenonly 1
attr KNX01.O04_Status room KNX
define KNX01.O05_Aktor_Leuchte_Schlafzimmer KNX 1/0/8:dpt1
attr KNX01.O05_Aktor_Leuchte_Schlafzimmer DbLogInclude state
attr KNX01.O05_Aktor_Leuchte_Schlafzimmer IODev tul
attr KNX01.O05_Aktor_Leuchte_Schlafzimmer devStateIcon on::off off::on
attr KNX01.O05_Aktor_Leuchte_Schlafzimmer room KNX
define KNX01.O05_Status KNX 1/0/9:dpt1
attr KNX01.O05_Status IODev tul
attr KNX01.O05_Status listenonly 1
attr KNX01.O05_Status room KNX
define KNX01.O06_Aktor_PSU_Arduino KNX 1/0/10:dpt1
attr KNX01.O06_Aktor_PSU_Arduino DbLogInclude state
attr KNX01.O06_Aktor_PSU_Arduino IODev tul
attr KNX01.O06_Aktor_PSU_Arduino devStateIcon on::off off::on
attr KNX01.O06_Aktor_PSU_Arduino room KNX
define KNX01.O06_Status KNX 1/0/11:dpt1
attr KNX01.O06_Status IODev tul
attr KNX01.O06_Status listenonly 1
attr KNX01.O06_Status room KNX
define KNX01.O07_Aktor_Leuchte_DG_provisorisch KNX 1/0/12:dpt1
attr KNX01.O07_Aktor_Leuchte_DG_provisorisch DbLogInclude state
attr KNX01.O07_Aktor_Leuchte_DG_provisorisch IODev tul
attr KNX01.O07_Aktor_Leuchte_DG_provisorisch devStateIcon on::off off::on
attr KNX01.O07_Aktor_Leuchte_DG_provisorisch room KNX
define KNX01.O07_Status KNX 1/0/13:dpt1
attr KNX01.O07_Status IODev tul
attr KNX01.O07_Status listenonly 1
attr KNX01.O07_Status room KNX
define KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch KNX 1/0/14:dpt1
attr KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch DbLogInclude state
attr KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch IODev tul
attr KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch devStateIcon on::off off::on
attr KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch readonly 0
attr KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch room KNX
define KNX01.O08_Status KNX 1/0/15:dpt1
attr KNX01.O08_Status IODev tul
attr KNX01.O08_Status listenonly 1
attr KNX01.O08_Status room KNX
define KNX01.I01_Schlafzimmer KNX 1/0/16:dpt1
attr KNX01.I01_Schlafzimmer DbLogInclude state
attr KNX01.I01_Schlafzimmer IODev tul
attr KNX01.I01_Schlafzimmer room KNX
define KNX01.I02_Schlafzimmer KNX 1/0/17:dpt1
attr KNX01.I02_Schlafzimmer DbLogInclude state
attr KNX01.I02_Schlafzimmer IODev tul
attr KNX01.I02_Schlafzimmer room KNX
define KNX01.I03_Schlafzimmer KNX 1/0/18:dpt1
attr KNX01.I03_Schlafzimmer DbLogInclude state
attr KNX01.I03_Schlafzimmer IODev tul
attr KNX01.I03_Schlafzimmer room KNX
define KNX01.I04_Schlafzimmer KNX 1/0/19:dpt1
attr KNX01.I04_Schlafzimmer DbLogInclude state
attr KNX01.I04_Schlafzimmer IODev tul
attr KNX01.I04_Schlafzimmer room KNX
define KNX01.I05_Schlafzimmer KNX 1/0/20:dpt1
attr KNX01.I05_Schlafzimmer DbLogInclude state
attr KNX01.I05_Schlafzimmer IODev tul
attr KNX01.I05_Schlafzimmer room KNX
define KNX01.I06_Schlafzimmer KNX 1/0/21:dpt1
attr KNX01.I06_Schlafzimmer DbLogInclude state
attr KNX01.I06_Schlafzimmer IODev tul
attr KNX01.I06_Schlafzimmer room KNX
define KNX01.I07_Schlafzimmer KNX 1/0/22:dpt1
attr KNX01.I07_Schlafzimmer DbLogInclude state
attr KNX01.I07_Schlafzimmer IODev tul
attr KNX01.I07_Schlafzimmer room KNX
define KNX01.I08_Schlafzimmer KNX 1/0/23:dpt1
attr KNX01.I08_Schlafzimmer DbLogInclude state
attr KNX01.I08_Schlafzimmer IODev tul
attr KNX01.I08_Schlafzimmer room KNX
define DF_housekeeping DOIF ([KNX31.I03_Taster_Haustuere:state] eq "off") \
(\
setreading $SELF cleaningRequest requested\
)\
DOELSEIF([$SELF:cleaningRequest] eq "requested" && [NEATO2:state:sec] > 43200 && [FritzBoxSNSH:stephan] eq "gone" && [FritzBoxSNSH:nadine] eq "gone")\
(\
set NEATO2 startCleaning,\
set Pushover msg starte Neapel title=housekeeping\
)\
DOELSEIF([NEATO2:isDocked:d] = 1)\
(\
setreading $SELF cleaningRequest done\
)\
DOELSEIF([NEATO2:isDocked:d] == 0 && ([FritzBoxSNSH:stephan] ne "gone" || [FritzBoxSNSH:nadine] ne "gone"))\
(\
set NEATO2 sendToBase,\
set Pushover msg "stoppe Reinigung, jemand kommt heim" title=housekeeping\
)\
DOELSEIF([NEATO2:alert])\
(\
set alarmbot message NEATO [NEATO2:alert]\
)\
DOELSEIF([NEATO2:error])\
(\
set alarmbot message NEATO [NEATO2:error]\
)\
DOELSEIF([+60])\
(\
setreading $SELF age [NEATO2:state:sec]\
)
attr DF_housekeeping DOIF_Readings stephan:{([FritzBoxSNSH:stephan] eq "gone" && [FritzBoxSNSOG:stephan] eq "gone") ? "gone" : "present";;},\
nadine:{([FritzBoxSNSH:nadine] eq "gone" && [FritzBoxSNSOG:nadine] eq "gone") ? "gone" : "present";;},\
residents:{([$SELF:nadine] eq "gone" && [$SELF:stephan] eq "gone") ? "gone" : "present";;}
attr DF_housekeeping disable 1
attr DF_housekeeping do always
attr DF_housekeeping room _doif,neato,presence
attr DF_housekeeping selftrigger all
attr DF_housekeeping widgetOverride cmdState:textField-long
define RG_temperatures readingsGroup DS18B20.*:temperature
attr RG_temperatures notime 1
attr RG_temperatures room _readingsGroup
attr RG_temperatures valueSuffix °C
define logdb DbLog ./db_fhem.conf .*:.*
attr logdb DbLogSelectionMode Include
attr logdb DbLogType History
attr logdb asyncMode 1
attr logdb cacheEvents 2
attr logdb cacheLimit 100
attr logdb colEvent 0
attr logdb exportCacheAppend 1
attr logdb room Logging
attr logdb syncInterval 30
attr logdb useCharfilter 1
attr logdb userReadings DbFileSize:lastReduceLogResult.* { (split(' ',`du -m fhem.db`))[0] }
attr logdb valueFn {\
if ($READING eq "work" && $VALUE=~ /.*Wh$/)\
{\
$UNIT="Wh";;\
$VALUE=~ s/(.*)\sWh/$1/;;\
}\
if ($READING eq "power" && $VALUE=~ /.*W$/)\
{\
$UNIT="W";;\
$VALUE=~ s/(.*)\sW/$1/;;\
}\
}
attr logdb verbose 3
define Stromzaehler vz /dev/volkszaehler
attr Stromzaehler DbLogInclude total_power.*,total_energy
attr Stromzaehler event-aggregator total_energy.*:60:none:v
attr Stromzaehler event-on-change-reading total_energy,total_power.*:20,state
attr Stromzaehler group Zähler
attr Stromzaehler room System
attr Stromzaehler stateFormat {sprintf("L1: %d W;; L2: %d W;; L3: %d W;; Pges: %d W", ReadingsVal("Stromzaehler","total_power_L1",0),ReadingsVal("Stromzaehler","total_power_L2",0),ReadingsVal("Stromzaehler","total_power_L3",0),ReadingsVal("Stromzaehler","total_power",0))}
define SVG_Gaszaehler SVG logdb:SVG_Gaszaehler:HISTORY
attr SVG_Gaszaehler endPlotNow 1
attr SVG_Gaszaehler endPlotToday 1
attr SVG_Gaszaehler room SVG
define DF_Heizbetrieb DOIF (["$SELF:status: sommer"])\
(setreading DF_Heizkesselbetrieb status hand_gesperrt)\
(setreading DF_Heizschleifenbetrieb status aus)\
DOELSEIF (["$SELF:status: winter"])\
(setreading DF_Heizkesselbetrieb status automatik)\
(setreading DF_Heizschleifenbetrieb status voll)
attr DF_Heizbetrieb DbLogInclude cmd
attr DF_Heizbetrieb cmdState sommer|winter
attr DF_Heizbetrieb readingList status
attr DF_Heizbetrieb room Gas,_doif
attr DF_Heizbetrieb setList status
attr DF_Heizbetrieb webCmd status
attr DF_Heizbetrieb widgetOverride cmdState:textField-long status:uzsuSelectRadio,winter,sommer
define RE_TEMP_VorlaufHK dummy
attr RE_TEMP_VorlaufHK DbLogInclude temperature
attr RE_TEMP_VorlaufHK event-on-update-reading temperature
attr RE_TEMP_VorlaufHK group PID20,Thermometer
attr RE_TEMP_VorlaufHK room Heizung,OW_Remote,_dummy
attr RE_TEMP_VorlaufHK stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define PID.FUBO PID20 RE_TEMP_VorlaufHK:temperature D_MischerPID
attr PID.FUBO DbLogInclude .*
attr PID.FUBO disable 1
attr PID.FUBO event-on-update-reading p_.*,actuation.*,desired,measured,delta,mischerposition
attr PID.FUBO pidActorCallBeforeSetting PIDActorSet
attr PID.FUBO pidActorInterval 1
attr PID.FUBO pidActorLimitLower -20000
attr PID.FUBO pidActorLimitUpper 2500
attr PID.FUBO pidActorTreshold 0
attr PID.FUBO pidActorValueDecPlaces 0
attr PID.FUBO pidCalcInterval 90
attr PID.FUBO pidFactor_D 3500
attr PID.FUBO pidFactor_I 0.1
attr PID.FUBO pidFactor_P 400
attr PID.FUBO pidIPortionCallBeforeSetting PIDIPortionSet
attr PID.FUBO room Heizung
attr PID.FUBO stateFormat {sprintf("A: %.0f AC: %.1f Soll: %.1f°C Ist: %.1f°C", ReadingsVal("PID.FUBO","actuation",0),ReadingsVal("PID.FUBO","actuationCalc",0),ReadingsVal("PID.FUBO","desired",0),ReadingsVal("PID.FUBO","measured",0),)}
attr PID.FUBO userReadings actuationHysteresis:actuation.* {my $value =  abs(ReadingsVal($name,"actuation",0));; $value > 250 ? $value : 0 }
##define myOWServer OWServer localhost:4304
##attr myOWServer nonblocking 1
##attr myOWServer room OW_Local
##define LOC_TEMP_VorlaufHK OWDevice 28.6B878A060000 30
##attr LOC_TEMP_VorlaufHK DbLogInclude temperature
##attr LOC_TEMP_VorlaufHK IODev myOWServer
##attr LOC_TEMP_VorlaufHK event-on-update-reading temperature
##attr LOC_TEMP_VorlaufHK model DS18B20
##attr LOC_TEMP_VorlaufHK resolution 10
##attr LOC_TEMP_VorlaufHK room OW_Local
##attr LOC_TEMP_VorlaufHK stateFormat T: temperature °C
define RE_TEMP_RuecklaufHK dummy
attr RE_TEMP_RuecklaufHK DbLogInclude temperature
attr RE_TEMP_RuecklaufHK event-on-update-reading temperature
attr RE_TEMP_RuecklaufHK group Thermometer
attr RE_TEMP_RuecklaufHK room Heizung,OW_Remote
attr RE_TEMP_RuecklaufHK stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Ruecklauf_Solar dummy
attr RE_TEMP_Ruecklauf_Solar DbLogInclude temperature
attr RE_TEMP_Ruecklauf_Solar event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_Solar group Thermometer
attr RE_TEMP_Ruecklauf_Solar room Heizung,OW_Remote,Solar
attr RE_TEMP_Ruecklauf_Solar stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Vorlauf_Schwimmbad dummy
attr RE_TEMP_Vorlauf_Schwimmbad DbLogInclude temperature
attr RE_TEMP_Vorlauf_Schwimmbad comment ist jetzt Schwimmbad_Vorlauf
attr RE_TEMP_Vorlauf_Schwimmbad event-on-update-reading temperature
attr RE_TEMP_Vorlauf_Schwimmbad group Thermometer
attr RE_TEMP_Vorlauf_Schwimmbad room Heizung_POOL,OW_Remote,Solar,_dummy
attr RE_TEMP_Vorlauf_Schwimmbad stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Ankleide dummy
attr RE_TEMP_Ankleide DbLogInclude temperature
attr RE_TEMP_Ankleide event-on-update-reading temperature
attr RE_TEMP_Ankleide group ERR_Ankleide,Thermometer
attr RE_TEMP_Ankleide room Heizung_ERR,OW_Remote,_dummy
attr RE_TEMP_Ankleide stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Vorlauf_Solar dummy
attr RE_TEMP_Vorlauf_Solar DbLogInclude temperature
attr RE_TEMP_Vorlauf_Solar event-on-update-reading temperature
attr RE_TEMP_Vorlauf_Solar group Thermometer
attr RE_TEMP_Vorlauf_Solar room Heizung,OW_Remote,Solar
attr RE_TEMP_Vorlauf_Solar stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Vorlauf_WW dummy
attr RE_TEMP_Vorlauf_WW DbLogInclude temperature
attr RE_TEMP_Vorlauf_WW event-on-update-reading temperature
attr RE_TEMP_Vorlauf_WW group Thermometer
attr RE_TEMP_Vorlauf_WW room Heizung,OW_Remote
attr RE_TEMP_Vorlauf_WW stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Ruecklauf_WT_EG dummy
attr RE_TEMP_Ruecklauf_WT_EG DbLogInclude temperature
attr RE_TEMP_Ruecklauf_WT_EG event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_WT_EG group Thermometer
attr RE_TEMP_Ruecklauf_WT_EG room Heizung,OW_Remote
attr RE_TEMP_Ruecklauf_WT_EG stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Vorlauf_EG_Boden dummy
attr RE_TEMP_Vorlauf_EG_Boden DbLogInclude temperature
attr RE_TEMP_Vorlauf_EG_Boden event-on-update-reading temperature
attr RE_TEMP_Vorlauf_EG_Boden group Thermometer
attr RE_TEMP_Vorlauf_EG_Boden room Heizung,OW_Remote
attr RE_TEMP_Vorlauf_EG_Boden stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_FlurOG dummy
attr RE_TEMP_FlurOG DbLogInclude temperature
attr RE_TEMP_FlurOG event-on-update-reading temperature
attr RE_TEMP_FlurOG group ERR_FlurBuero,Thermometer
attr RE_TEMP_FlurOG room Heizung_ERR,OW_Remote,_dummy
attr RE_TEMP_FlurOG stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Ruecklauf_EG_Boden dummy
attr RE_TEMP_Ruecklauf_EG_Boden DbLogInclude temperature
attr RE_TEMP_Ruecklauf_EG_Boden event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_EG_Boden group Thermometer
attr RE_TEMP_Ruecklauf_EG_Boden room Heizung,OW_Remote
attr RE_TEMP_Ruecklauf_EG_Boden stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Ruecklauf_Zirkulation dummy
attr RE_TEMP_Ruecklauf_Zirkulation DbLogInclude temperature
attr RE_TEMP_Ruecklauf_Zirkulation event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_Zirkulation group Thermometer
attr RE_TEMP_Ruecklauf_Zirkulation room Heizung,OW_Remote
attr RE_TEMP_Ruecklauf_Zirkulation stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_WW_Ausgang_Speicher dummy
attr RE_TEMP_WW_Ausgang_Speicher DbLogInclude temperature
attr RE_TEMP_WW_Ausgang_Speicher event-on-update-reading temperature
attr RE_TEMP_WW_Ausgang_Speicher group Thermometer
attr RE_TEMP_WW_Ausgang_Speicher room OW_Remote,_dummy
attr RE_TEMP_WW_Ausgang_Speicher stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Schlafzimmer dummy
attr RE_TEMP_Schlafzimmer DbLogInclude temperature
attr RE_TEMP_Schlafzimmer event-on-update-reading temperature
attr RE_TEMP_Schlafzimmer group ERR_Schlafzimmer,Thermometer
attr RE_TEMP_Schlafzimmer room Heizung_ERR,OW_Remote
attr RE_TEMP_Schlafzimmer stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define rg_wmz readingsGroup repdb_work_Solar.*:.*
attr rg_wmz notime 1
attr rg_wmz room _readingsGroup
define devstateicon dummy
attr devstateicon devStateIcon {my $v=Value("devstateicon");;my $p=33;; $p=int($v/3) if($v ne "up");;  return '<div align="top" style="width:33px;;height:'.(33-$p).'px;;margin-bottom:'.$p.'px;;border: 1px solid #000;;background-color:#888;;"></div>'}
attr devstateicon room x_devel
attr devstateicon stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define icontest dummy
attr icontest devStateIcon 10:cul_cul
attr icontest icon remotecontrol/black_btn_GUIDE2
attr icontest room x_devel
define RE_TEMP_Ruecklauf_Schwimmbad dummy
attr RE_TEMP_Ruecklauf_Schwimmbad event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_Schwimmbad group Thermometer
attr RE_TEMP_Ruecklauf_Schwimmbad room Heizung_POOL,OW_Remote,Solar,_dummy
attr RE_TEMP_Ruecklauf_Schwimmbad stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
#####################################################################################################
define KNX02.O01_Aktor_Brunnen KNX 1/2/0:dpt1
attr KNX02.O01_Aktor_Brunnen DbLogInclude state
attr KNX02.O01_Aktor_Brunnen IODev tul
attr KNX02.O01_Aktor_Brunnen devStateIcon on::off off::on
attr KNX02.O01_Aktor_Brunnen room KNX,Wasser
define KNX02.O02_Aktor_Kuehlschrank KNX 1/2/5:dpt1
attr KNX02.O02_Aktor_Kuehlschrank DbLogInclude state
attr KNX02.O02_Aktor_Kuehlschrank IODev tul
attr KNX02.O02_Aktor_Kuehlschrank devStateIcon on::off off::on
attr KNX02.O02_Aktor_Kuehlschrank event-min-interval .*:15
attr KNX02.O02_Aktor_Kuehlschrank readonly 1
attr KNX02.O02_Aktor_Kuehlschrank room KNX
attr KNX02.O02_Aktor_Kuehlschrank webCmd :
define KNX02.O03_Aktor_Heizung_komplett KNX 1/2/10:dpt1
attr KNX02.O03_Aktor_Heizung_komplett DbLogInclude state
attr KNX02.O03_Aktor_Heizung_komplett IODev tul
attr KNX02.O03_Aktor_Heizung_komplett devStateIcon on::off off::on
attr KNX02.O03_Aktor_Heizung_komplett readonly 1
attr KNX02.O03_Aktor_Heizung_komplett room KNX
attr KNX02.O03_Aktor_Heizung_komplett webCmd :
define KNX02.O04_Aktor_WAMA KNX 1/2/15:dpt1
attr KNX02.O04_Aktor_WAMA DbLogInclude state
attr KNX02.O04_Aktor_WAMA IODev tul
attr KNX02.O04_Aktor_WAMA devStateIcon on::off off::on
attr KNX02.O04_Aktor_WAMA readonly 1
attr KNX02.O04_Aktor_WAMA room KNX,Wasser
define KNX02.O05_Aktor_Kueche_SPM KNX 1/2/20:dpt1
attr KNX02.O05_Aktor_Kueche_SPM DbLogInclude state
attr KNX02.O05_Aktor_Kueche_SPM IODev tul
attr KNX02.O05_Aktor_Kueche_SPM devStateIcon on::off off::on
attr KNX02.O05_Aktor_Kueche_SPM room KNX
define KNX02.O06_Aktor_Schlafzimmer_Wasserbett KNX 1/2/25:dpt1
attr KNX02.O06_Aktor_Schlafzimmer_Wasserbett DbLogInclude state
attr KNX02.O06_Aktor_Schlafzimmer_Wasserbett IODev tul
attr KNX02.O06_Aktor_Schlafzimmer_Wasserbett devStateIcon on::off off::on
attr KNX02.O06_Aktor_Schlafzimmer_Wasserbett room KNX
define KNX02.O07_Aktor_isoft_EMEM KNX 1/2/30:dpt1
attr KNX02.O07_Aktor_isoft_EMEM DbLogInclude state
attr KNX02.O07_Aktor_isoft_EMEM IODev tul
attr KNX02.O07_Aktor_isoft_EMEM devStateIcon on::off off::on
attr KNX02.O07_Aktor_isoft_EMEM event-min-interval .*:15
attr KNX02.O07_Aktor_isoft_EMEM listenonly 1
attr KNX02.O07_Aktor_isoft_EMEM room KNX,Wasser
attr KNX02.O07_Aktor_isoft_EMEM webCmd :
define KNX02.O08_Aktor_Leuchte_Vorraum_Gaestezimmer KNX 1/2/35:dpt1
attr KNX02.O08_Aktor_Leuchte_Vorraum_Gaestezimmer DbLogInclude state
attr KNX02.O08_Aktor_Leuchte_Vorraum_Gaestezimmer IODev tul
attr KNX02.O08_Aktor_Leuchte_Vorraum_Gaestezimmer devStateIcon on::off off::on
attr KNX02.O08_Aktor_Leuchte_Vorraum_Gaestezimmer room KNX
define KNX02.O09_Aktor_Holzvergaser KNX 1/2/40:dpt1
attr KNX02.O09_Aktor_Holzvergaser DbLogInclude state
attr KNX02.O09_Aktor_Holzvergaser IODev tul
attr KNX02.O09_Aktor_Holzvergaser devStateIcon on::off off::on
attr KNX02.O09_Aktor_Holzvergaser room KNX
define KNX02.O10_Aktor_Aussen_Weihnacht_oben KNX 1/2/45:dpt1
attr KNX02.O10_Aktor_Aussen_Weihnacht_oben DbLogInclude state
attr KNX02.O10_Aktor_Aussen_Weihnacht_oben IODev tul
attr KNX02.O10_Aktor_Aussen_Weihnacht_oben devStateIcon on::off off::on
attr KNX02.O10_Aktor_Aussen_Weihnacht_oben room KNX,Weihnachtsbeleuchtung
define KNX02.O11_Aktor_Aussen_Weihnacht_unten KNX 1/2/50:dpt1
attr KNX02.O11_Aktor_Aussen_Weihnacht_unten DbLogInclude state
attr KNX02.O11_Aktor_Aussen_Weihnacht_unten IODev tul
attr KNX02.O11_Aktor_Aussen_Weihnacht_unten devStateIcon on::off off::on
attr KNX02.O11_Aktor_Aussen_Weihnacht_unten readonly 1
attr KNX02.O11_Aktor_Aussen_Weihnacht_unten room KNX,Weihnachtsbeleuchtung
define KNX02.O12_Aktor_Rumpel KNX 1/2/55:dpt1
attr KNX02.O12_Aktor_Rumpel DbLogInclude state
attr KNX02.O12_Aktor_Rumpel IODev tul
attr KNX02.O12_Aktor_Rumpel devStateIcon on::off off::on
attr KNX02.O12_Aktor_Rumpel readonly 1
attr KNX02.O12_Aktor_Rumpel room KNX
attr KNX02.O12_Aktor_Rumpel webCmd :
define KNX02.O01_Status KNX 1/2/1:dpt1
attr KNX02.O01_Status DbLogInclude state
attr KNX02.O01_Status IODev tul
attr KNX02.O01_Status listenonly 1
attr KNX02.O01_Status room KNX,Wasser
define KNX02.O02_Status KNX 1/2/6:dpt1
attr KNX02.O02_Status DbLogInclude state
attr KNX02.O02_Status IODev tul
attr KNX02.O02_Status listenonly 1
attr KNX02.O02_Status room KNX
define KNX02.O03_Status KNX 1/2/11:dpt1
attr KNX02.O03_Status DbLogInclude state
attr KNX02.O03_Status IODev tul
attr KNX02.O03_Status listenonly 1
attr KNX02.O03_Status room KNX
define KNX02.O04_Status KNX 1/2/16:dpt1
attr KNX02.O04_Status DbLogInclude state
attr KNX02.O04_Status IODev tul
attr KNX02.O04_Status listenonly 1
attr KNX02.O04_Status room KNX
define KNX02.O05_Status KNX 1/2/21:dpt1
attr KNX02.O05_Status DbLogInclude state
attr KNX02.O05_Status IODev tul
attr KNX02.O05_Status listenonly 1
attr KNX02.O05_Status room KNX
define KNX02.O06_Status KNX 1/2/26:dpt1
attr KNX02.O06_Status DbLogInclude state
attr KNX02.O06_Status IODev tul
attr KNX02.O06_Status readonly 1
attr KNX02.O06_Status room KNX
define KNX02.O07_Status KNX 1/2/31:dpt1
attr KNX02.O07_Status DbLogInclude state
attr KNX02.O07_Status IODev tul
attr KNX02.O07_Status listenonly 1
attr KNX02.O07_Status room KNX
define KNX02.O08_Status KNX 1/2/36:dpt1
attr KNX02.O08_Status DbLogInclude state
attr KNX02.O08_Status IODev tul
attr KNX02.O08_Status listenonly 1
attr KNX02.O08_Status room KNX
define KNX02.O09_Status KNX 1/2/41:dpt1
attr KNX02.O09_Status DbLogInclude state
attr KNX02.O09_Status IODev tul
attr KNX02.O09_Status listenonly 1
attr KNX02.O09_Status room KNX
define KNX02.O10_Status KNX 1/2/46:dpt1
attr KNX02.O10_Status DbLogInclude state
attr KNX02.O10_Status IODev tul
attr KNX02.O10_Status listenonly 1
attr KNX02.O10_Status room KNX
define KNX02.O11_Status KNX 1/2/51:dpt1
attr KNX02.O11_Status DbLogInclude state
attr KNX02.O11_Status IODev tul
attr KNX02.O11_Status listenonly 1
attr KNX02.O11_Status room KNX
define KNX02.O12_Status KNX 1/2/56:dpt1
attr KNX02.O12_Status DbLogInclude state
attr KNX02.O12_Status IODev tul
attr KNX02.O12_Status listenonly 1
attr KNX02.O12_Status room KNX
define KNX02.O01_Stromwert KNX 1/2/2:dpt7
attr KNX02.O01_Stromwert DbLogInclude power,current
attr KNX02.O01_Stromwert IODev tul
attr KNX02.O01_Stromwert event-on-update-reading power,current
attr KNX02.O01_Stromwert room KNX,Wasser
attr KNX02.O01_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O01_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O02_Stromwert KNX 1/2/7:dpt7
attr KNX02.O02_Stromwert DbLogInclude power,current
attr KNX02.O02_Stromwert IODev tul
attr KNX02.O02_Stromwert event-on-update-reading power,current
attr KNX02.O02_Stromwert room KNX
attr KNX02.O02_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O02_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O03_Stromwert KNX 1/2/12:dpt7
attr KNX02.O03_Stromwert DbLogInclude power,current
attr KNX02.O03_Stromwert IODev tul
attr KNX02.O03_Stromwert event-on-update-reading power,current
attr KNX02.O03_Stromwert room KNX
attr KNX02.O03_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O03_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O04_Stromwert KNX 1/2/17:dpt7:listenonly
attr KNX02.O04_Stromwert DbLogInclude power,current
attr KNX02.O04_Stromwert IODev tul
attr KNX02.O04_Stromwert event-on-update-reading power,current
attr KNX02.O04_Stromwert room KNX
attr KNX02.O04_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O04_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O05_Stromwert KNX 1/2/22:dpt7
attr KNX02.O05_Stromwert DbLogInclude power,current
attr KNX02.O05_Stromwert IODev tul
attr KNX02.O05_Stromwert event-on-update-reading power,current
attr KNX02.O05_Stromwert room KNX
attr KNX02.O05_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O05_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O06_Stromwert KNX 1/2/27:dpt7
attr KNX02.O06_Stromwert DbLogInclude power,current
attr KNX02.O06_Stromwert IODev tul
attr KNX02.O06_Stromwert event-on-update-reading power,current
attr KNX02.O06_Stromwert room KNX
attr KNX02.O06_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O06_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O07_Stromwert KNX 1/2/32:dpt7
attr KNX02.O07_Stromwert DbLogInclude power,current
attr KNX02.O07_Stromwert IODev tul
attr KNX02.O07_Stromwert event-on-update-reading power,current
attr KNX02.O07_Stromwert room KNX
attr KNX02.O07_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O07_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O08_Stromwert KNX 1/2/37:dpt7
attr KNX02.O08_Stromwert DbLogInclude power,current
attr KNX02.O08_Stromwert IODev tul
attr KNX02.O08_Stromwert event-on-update-reading power,current
attr KNX02.O08_Stromwert room KNX
attr KNX02.O08_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O08_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O09_Stromwert KNX 1/2/42:dpt7
attr KNX02.O09_Stromwert DbLogInclude power,current
attr KNX02.O09_Stromwert IODev tul
attr KNX02.O09_Stromwert event-on-update-reading power,current
attr KNX02.O09_Stromwert room KNX
attr KNX02.O09_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O09_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, \
current { calcUserReadings($name,"getG1","currentA") },\
timestamp { ReadingsTimestamp($name,"getG1","power") }
define KNX02.O10_Stromwert KNX 1/2/47:dpt7
attr KNX02.O10_Stromwert DbLogInclude power,current
attr KNX02.O10_Stromwert IODev tul
attr KNX02.O10_Stromwert event-on-update-reading power,current
attr KNX02.O10_Stromwert room KNX
attr KNX02.O10_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O10_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O11_Stromwert KNX 1/2/52:dpt7
attr KNX02.O11_Stromwert DbLogInclude power,current
attr KNX02.O11_Stromwert IODev tul
attr KNX02.O11_Stromwert event-on-update-reading power,current
attr KNX02.O11_Stromwert room KNX
attr KNX02.O11_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O11_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define KNX02.O12_Stromwert KNX 1/2/57:dpt7
attr KNX02.O12_Stromwert DbLogInclude power,current
attr KNX02.O12_Stromwert IODev tul
attr KNX02.O12_Stromwert event-on-update-reading power,current
attr KNX02.O12_Stromwert room KNX
attr KNX02.O12_Stromwert stateFormat I: getG1 mA S: power VA
attr KNX02.O12_Stromwert userReadings power { calcUserReadings($name,"getG1","power")}, current { calcUserReadings($name,"getG1","currentA") }
define D_Wassermenge_statisch dummy
attr D_Wassermenge_statisch room Heizung_POOL
define cmd_ls cmdalias ls .* AS list .*$EVENT.*
attr cmd_ls room cmdalias
define cmd_lastloglines cmdalias lastloglines .* AS {qx(tail -n $EVENT $currlogfile)}
attr cmd_lastloglines comment Aufruf mit lastloglines n, wobei n die anzahl der Zeilen ist
attr cmd_lastloglines room cmdalias
define cmd_roomrename cmdalias roomrename .* AS { for my $name (devspec2array("room=$EVTPART0")){ map {s/$EVTPART0/$EVTPART1/;; fhem("attr $name room $_")} AttrVal($name,'room','') } }
attr cmd_roomrename comment roomadd <devspec> <new_room>
attr cmd_roomrename room cmdalias
define DF_UWP_POOL DOIF ([09:00-16:00] and \
[RE_TEMP_Speicher_unten:temperature] > 80 and \
[RE_TEMP_Speicher_mitte:temperature] > 85 and \
[RE_TEMP_Speicher_oben:temperature] > 90 and \
[RE_TEMP_Vorlauf_Solar:temperature] > 90 and\
[RE_TEMP_Vorlauf_Schwimmbad:temperature] < 200)\
(\
	set VERALTET !!!KNX01.O01_Aktor_Pool_UWP on,\
	set PID.POOL desired 60,\
	attr N_changePOOLVL disable 0\
)\
DOELSE\
(	set PID.POOL desired 0,\
	attr N_changePOOLVL disable 1,\
	set HMW02.O12_Mischer_POOL_kalt on-for-timer 122	)\
(	set VERALTET!!! KNX01.O01_Aktor_Pool_UWP off	)
attr DF_UWP_POOL disable 1
attr DF_UWP_POOL room Heizung_POOL
attr DF_UWP_POOL wait 0:0,1200
attr DF_UWP_POOL widgetOverride cmdState:textField-long
define D_MischerPOOLPID dummy
attr D_MischerPOOLPID room Heizung_POOL,_dummy
define KNX02.O01_Counter KNX 1/2/4:dpt13.010 tul
attr KNX02.O01_Counter DbLogInclude stat.*,total_energy
attr KNX02.O01_Counter IODev tul
attr KNX02.O01_Counter event-on-change-reading state
attr KNX02.O01_Counter room KNX,Wasser
attr KNX02.O01_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
attr KNX02.O01_Counter webCmd ::
define KNX02.O02_Counter KNX 1/2/9:dpt13.010 tul
attr KNX02.O02_Counter DbLogInclude stat.*,total_energy
attr KNX02.O02_Counter IODev tul
attr KNX02.O02_Counter event-on-change-reading state
attr KNX02.O02_Counter room KNX
attr KNX02.O02_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O03_Counter KNX 1/2/14:dpt13.010 tul
attr KNX02.O03_Counter DbLogInclude stat.*,total_energy
attr KNX02.O03_Counter IODev tul
attr KNX02.O03_Counter event-on-change-reading state
attr KNX02.O03_Counter room KNX
attr KNX02.O03_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O04_Counter KNX 1/2/19:dpt13.010 tul
attr KNX02.O04_Counter DbLogInclude stat.*,total_energy
attr KNX02.O04_Counter IODev tul
attr KNX02.O04_Counter event-on-change-reading state
attr KNX02.O04_Counter room KNX
attr KNX02.O04_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O05_Counter KNX 1/2/24:dpt13.010 tul
attr KNX02.O05_Counter DbLogInclude stat.*,total_energy
attr KNX02.O05_Counter IODev tul
attr KNX02.O05_Counter event-on-change-reading state
attr KNX02.O05_Counter room KNX
attr KNX02.O05_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O06_Counter KNX 1/2/29:dpt13.010 tul
attr KNX02.O06_Counter DbLogInclude stat.*,total_energy
attr KNX02.O06_Counter IODev tul
attr KNX02.O06_Counter event-on-change-reading state
attr KNX02.O06_Counter room KNX
attr KNX02.O06_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O07_Counter KNX 1/2/34:dpt13.010 tul
attr KNX02.O07_Counter DbLogInclude stat.*,total_energy
attr KNX02.O07_Counter IODev tul
attr KNX02.O07_Counter event-on-change-reading state
attr KNX02.O07_Counter room KNX
attr KNX02.O07_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O08_Counter KNX 1/2/39:dpt13.010 tul
attr KNX02.O08_Counter DbLogInclude stat.*,total_energy
attr KNX02.O08_Counter IODev tul
attr KNX02.O08_Counter event-on-change-reading state
attr KNX02.O08_Counter room KNX
attr KNX02.O08_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O09_Counter KNX 1/2/44:dpt13.010 tul
attr KNX02.O09_Counter DbLogInclude stat.*,total_energy
attr KNX02.O09_Counter IODev tul
attr KNX02.O09_Counter event-on-change-reading state
attr KNX02.O09_Counter room KNX
attr KNX02.O09_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O10_Counter KNX 1/2/49:dpt13.010 tul
attr KNX02.O10_Counter DbLogInclude stat.*,total_energy
attr KNX02.O10_Counter IODev tul
attr KNX02.O10_Counter event-on-change-reading state
attr KNX02.O10_Counter room KNX
attr KNX02.O10_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O11_Counter KNX 1/2/54:dpt13.010 tul
attr KNX02.O11_Counter DbLogInclude stat.*,total_energy
attr KNX02.O11_Counter IODev tul
attr KNX02.O11_Counter event-on-change-reading state
attr KNX02.O11_Counter room KNX
attr KNX02.O11_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define KNX02.O12_Counter KNX 1/2/59:dpt13.010 tul
attr KNX02.O12_Counter DbLogInclude stat.*,total_energy
attr KNX02.O12_Counter IODev tul
attr KNX02.O12_Counter event-on-change-reading state,total_energy
attr KNX02.O12_Counter room KNX
attr KNX02.O12_Counter userReadings total_energy { calcUserReadings($name,"getG1","total_energy")}
define SVG_Kuehlschrank SVG logdb:SVG_Kuehlschrank:HISTORY
attr SVG_Kuehlschrank plotsize 1500,600
attr SVG_Kuehlschrank room SVG
define DF_HZG_Bad_Wand_FuBo DOIF ([RE_TEMP_Bad:temperature] < [D_TsollBad] )\
(\
	set KNX20.O05_Aktor_PWM_Bad_FuBo value 100,\
	set KNX20.O06_Aktor_PWM_Bad_Wand value 100\
	\
) \
DOELSEIF  ([RE_TEMP_Bad:temperature] > [D_TsollBad])\
(\
	set KNX20.O05_Aktor_PWM_Bad_FuBo value 22,\
	set KNX20.O06_Aktor_PWM_Bad_Wand value 0\
	\
)\

attr DF_HZG_Bad_Wand_FuBo userattr Heizkreise Heizkreise_map structexclude
attr DF_HZG_Bad_Wand_FuBo cmdState heizen|aus
attr DF_HZG_Bad_Wand_FuBo disable 0
attr DF_HZG_Bad_Wand_FuBo event-on-change-reading Alle Events deaktiviert
attr DF_HZG_Bad_Wand_FuBo group ERR_Bad
attr DF_HZG_Bad_Wand_FuBo room Heizung_ERR,_doif
attr DF_HZG_Bad_Wand_FuBo widgetOverride cmdState:textField-long

define DF_HZG_Schlafzimmer DOIF ([RE_TEMP_Schlafzimmer:temperature] < [D_TsollSchlafzimmer]-1)\
	(\
		set KNX20.O01_Aktor_PWM_Schlafzimmer value 100\
	)\
DOELSEIF  ([RE_TEMP_Schlafzimmer:temperature] > [D_TsollSchlafzimmer])\
	(\
		set KNX20.O01_Aktor_PWM_Schlafzimmer value 25\
	)\

attr DF_HZG_Schlafzimmer userattr Heizkreise Heizkreise_map structexclude
attr DF_HZG_Schlafzimmer cmdState heizen|aus
attr DF_HZG_Schlafzimmer disable 0
attr DF_HZG_Schlafzimmer event-on-change-reading Alle Events deaktiviert
attr DF_HZG_Schlafzimmer group ERR_Schlafzimmer
attr DF_HZG_Schlafzimmer room Heizung_ERR,_doif
attr DF_HZG_Schlafzimmer widgetOverride cmdState:textField-long


define DF_HZG_Flur_Buero DOIF ([RE_TEMP_FlurOG:temperature] < [D_TsollFlur])\
( set KNX20.O08_Aktor_PWM_BueroFlur value 100 )\
DOELSEIF\
([RE_TEMP_Schlafzimmer:temperature] < [D_TsollSchlafzimmer]-1 )\
(set KNX20.O08_Aktor_PWM_BueroFlur value 50 )\
DOELSE\
(set KNX20.O08_Aktor_PWM_BueroFlur value 20)
attr DF_HZG_Flur_Buero checkall all
attr DF_HZG_Flur_Buero cmdState Heizen | ein bisschen Heizen | Standby
attr DF_HZG_Flur_Buero disable 0
attr DF_HZG_Flur_Buero do always
attr DF_HZG_Flur_Buero event-on-change-reading Alle Events deaktiviert
attr DF_HZG_Flur_Buero group ERR_FlurBuero
attr DF_HZG_Flur_Buero room Heizung_ERR,_doif
attr DF_HZG_Flur_Buero widgetOverride cmdState:textField-long

define DF_HZG_WoEssKue DOIF ([RE_TEMP_WoZi:temperature] < [D_TsollWoEssKue]-1 )\
(set KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ value 100) \
DOELSEIF  ([RE_TEMP_WoZi:temperature] > [D_TsollWoEssKue] )\
(set KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ value 0)
attr DF_HZG_WoEssKue userattr Heizkreise Heizkreise_map structexclude
attr DF_HZG_WoEssKue cmdState heizen|aus
attr DF_HZG_WoEssKue disable 0
attr DF_HZG_WoEssKue group ERR_WoZiKue
attr DF_HZG_WoEssKue room Heizung_ERR,_doif
attr DF_HZG_WoEssKue widgetOverride cmdState:textField-long
define DF_HZG_Rumpel DOIF (	[RE_TEMP_Rumpel:temperature] < 21 )\
() \
DOELSEIF  ([RE_TEMP_Rumpel:temperature] > 23 )\
()
attr DF_HZG_Rumpel cmdState heizen | aus
attr DF_HZG_Rumpel disable 0
attr DF_HZG_Rumpel group ERR_Rumpel
attr DF_HZG_Rumpel room Heizung_ERR,_doif
attr DF_HZG_Rumpel widgetOverride cmdState:textField-long
define D_TsollSchlafzimmer dummy
attr D_TsollSchlafzimmer fp_fp_test 120,400,2,
attr D_TsollSchlafzimmer group ERR_Schlafzimmer
attr D_TsollSchlafzimmer room Heizung_ERR
attr D_TsollSchlafzimmer setList state:slider,20,0.5,28
attr D_TsollSchlafzimmer webCmd state
define D_TsollAnkleide dummy
attr D_TsollAnkleide fp_fp_test 50,400,2,
attr D_TsollAnkleide group ERR_Ankleide
attr D_TsollAnkleide room Heizung_ERR,_dummy
attr D_TsollAnkleide setList state:slider,20,0.5,28,1
attr D_TsollAnkleide webCmd state
attr D_TsollAnkleide widgetOverride state:slider,20,0.5,28,1
define D_TsollBad dummy
attr D_TsollBad fp_fp_test 190,400,2,
attr D_TsollBad group ERR_Bad
attr D_TsollBad room Heizung_ERR,_dummy
attr D_TsollBad setList state:slider,20,0.5,28
attr D_TsollBad webCmd state
define D_TsollDusche dummy
attr D_TsollDusche group ERR_Bad
attr D_TsollDusche room Heizung_ERR,_dummy
attr D_TsollDusche setList state:slider,20,0.5,28
attr D_TsollDusche stateFormat disabled
attr D_TsollDusche webCmd state
define D_TsollBuero dummy
attr D_TsollBuero group ERR_FlurBuero
attr D_TsollBuero room Heizung_ERR,_dummy
attr D_TsollBuero setList state:slider,20,0.5,28
attr D_TsollBuero webCmd state
define D_TsollWoEssKue dummy
attr D_TsollWoEssKue group ERR_WoZiKue
attr D_TsollWoEssKue room Heizung_ERR,_dummy
attr D_TsollWoEssKue setList state:slider,20,0.5,28
attr D_TsollWoEssKue webCmd state
define D_TsollRumpel dummy
attr D_TsollRumpel group ERR_Rumpel
attr D_TsollRumpel room Heizung_ERR,_dummy
attr D_TsollRumpel setList state:slider,20,0.5,28
attr D_TsollRumpel webCmd state
define D_TsollFlur dummy
attr D_TsollFlur group ERR_FlurBuero
attr D_TsollFlur room Heizung_ERR,_dummy
attr D_TsollFlur setList state:slider,20,0.5,28
attr D_TsollFlur webCmd state
define wetter_prop PROPLANTA Frankfurt+am+Main de
attr wetter_prop DbLogInclude fc0_rad,fc0_prg_ges
attr wetter_prop disable 1
attr wetter_prop forecastDays 4
attr wetter_prop room Solar
attr wetter_prop stateFormat {sprintf("Heute: %d kWh  Morgen: %d kWh  ÜMo: %d kWh  Danach: %d kWh",ReadingsVal($name,"fc0_prg_ges",0),ReadingsVal($name,"fc1_prg_ges",0),ReadingsVal($name,"fc2_prg_ges",0),ReadingsVal($name,"fc3_prg_ges",0),)}\

attr wetter_prop userReadings fc0_prg_ges {ReadingsVal("wetter_prop","fc0_rad",0)*20*0.5;;},fc1_prg_ges {ReadingsVal("wetter_prop","fc1_rad",0)*20*0.5;;},fc2_prg_ges {ReadingsVal("wetter_prop","fc2_rad",0)*20*0.5;;},fc3_prg_ges {ReadingsVal("wetter_prop","fc3_rad",0)*20*0.5;;}
define SVG_Solarertrag SVG logdb:SVG_Solarertrag:HISTORY
attr SVG_Solarertrag endPlotToday 1
attr SVG_Solarertrag plotsize 1500,600
attr SVG_Solarertrag room SVG,Solar
define KNX10.I01_Taster_Flur_Buero_provisorisch KNX 1/3/0:dpt1 tul
attr KNX10.I01_Taster_Flur_Buero_provisorisch IODev tul
attr KNX10.I01_Taster_Flur_Buero_provisorisch room KNX
define KNX10.I02_Taster_Tuer_Wozi_Flur KNX 1/3/1:dpt1 tul
attr KNX10.I02_Taster_Tuer_Wozi_Flur IODev tul
attr KNX10.I02_Taster_Tuer_Wozi_Flur event-on-update-reading state
attr KNX10.I02_Taster_Tuer_Wozi_Flur room KNX
define KNX10.I03_Taster_HZG_Rumpel KNX 1/3/2:dpt1 tul
attr KNX10.I03_Taster_HZG_Rumpel IODev tul
attr KNX10.I03_Taster_HZG_Rumpel room KNX
define KNX10.I04_Taster_Tuer_Esszi_Kueche KNX 1/3/3:dpt1 tul
attr KNX10.I04_Taster_Tuer_Esszi_Kueche IODev tul
attr KNX10.I04_Taster_Tuer_Esszi_Kueche room KNX
define KNX10.I05_Zaehler_Holzvergaser KNX 1/3/4:dpt12 tul
attr KNX10.I05_Zaehler_Holzvergaser DbLogInclude lastliterwork,literpromin,total,power,day_work
attr KNX10.I05_Zaehler_Holzvergaser IODev tul
attr KNX10.I05_Zaehler_Holzvergaser event-aggregator getG1:5:none:v,b:5:linear:mean:60,pwr:60:none:mean:30
attr KNX10.I05_Zaehler_Holzvergaser group KNX,Zähler
attr KNX10.I05_Zaehler_Holzvergaser readonly 1
attr KNX10.I05_Zaehler_Holzvergaser room HolzVergaser,KNX
attr KNX10.I05_Zaehler_Holzvergaser stateFormat total power
attr KNX10.I05_Zaehler_Holzvergaser userReadings total:getG1.* {sprintf("%.3f m³",ReadingsVal($name,"offset",0)+ReadingsNum($name,"getG1",0)*0.001)},\
a:getG1.* differential {ReadingsVal($name,"getG1",0)*60},\
b:a.* {ReadingsVal($name,"a",0)},\
literpromin {sprintf("%.2f l/min",int(100*ReadingsVal($name,"b",0))/100)},\
VL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_HV_VL2","temperature",0))},\
RL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_HV_RLA2","temperature",0))},\
lastliterwork {my $w= sprintf("%.2f Wh",(ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))*1.16)},\
power {my $var = ReadingsNum($name,"literpromin",0)*60*(ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))*1.16;; $var = $var > 0 ? $var : 0;;sprintf("%.0f W",$var)},\
tr {ReadingsVal($name,"a",0)},\
pwr {ReadingsNum($name,"power",0)}\

attr KNX10.I05_Zaehler_Holzvergaser webCmd :
define KNX10.I06 KNX 1/3/5:dpt1 tul
attr KNX10.I06 IODev tul
attr KNX10.I06 room KNX
define KNX10.I07_Solarzaehler KNX 1/3/6:dpt12 tul
attr KNX10.I07_Solarzaehler DbLogInclude lastliterwork,literpromin,total,power,day_work
attr KNX10.I07_Solarzaehler IODev tul
attr KNX10.I07_Solarzaehler event-on-change-reading literpromin,total,power,day_work
attr KNX10.I07_Solarzaehler event-on-update-reading lastliterwork
attr KNX10.I07_Solarzaehler group KNX,Zähler
attr KNX10.I07_Solarzaehler readonly 1
attr KNX10.I07_Solarzaehler room KNX,Solar,System
attr KNX10.I07_Solarzaehler stateFormat total power
attr KNX10.I07_Solarzaehler userReadings total {sprintf("%.3f m³",ReadingsVal($name,"offset",0)+ReadingsNum($name,"getG1",0)*0.001)},\
update_delay:total {ReadingsAge($name, "total",0)},\
a differential {ReadingsVal($name,"getG1",0)*60},\
literpromin {sprintf("%.2f l/min",int(100*ReadingsVal($name,"a",0))/100)},\
VL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_Vorlauf_Solar","temperature",0))},\
RL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_Ruecklauf_Solar","temperature",0))},\
lastliterwork {my $w= sprintf("%.2f Wh",(ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))*1.05)},\
power {sprintf("%.0f W",ReadingsNum($name,"literpromin",0)*60*(ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))*1.05)},\
day_work {sprintf("%.1f kWh",SQLselectSUM("current_day_begin","current_day_end","VALUE",$name,"lastliterwork","funktion")/1000)}
attr KNX10.I07_Solarzaehler webCmd :
define KNX10.I08_Gaszaehler_KNX KNX 1/3/7:dpt12 tul
attr KNX10.I08_Gaszaehler_KNX DbLogInclude total
attr KNX10.I08_Gaszaehler_KNX IODev tul
attr KNX10.I08_Gaszaehler_KNX group KNX,Zähler
attr KNX10.I08_Gaszaehler_KNX readonly 1
attr KNX10.I08_Gaszaehler_KNX room Gas,KNX,System
attr KNX10.I08_Gaszaehler_KNX stateFormat total m3
attr KNX10.I08_Gaszaehler_KNX userReadings total {ReadingsVal($name,"offset",0)+ReadingsNum($name,"getG1",0)*0.01},\
update_delay:total {ReadingsAge("KNX10.I08_Gaszaehler_KNX", "total",0)},\
power:total differential {ReadingsVal($name,"total",0)}
attr KNX10.I08_Gaszaehler_KNX webCmd :
define KNX10.I09_Druckschalter_Brunnen KNX 1/3/8:dpt1 tul
attr KNX10.I09_Druckschalter_Brunnen IODev tul
attr KNX10.I09_Druckschalter_Brunnen event-on-update-reading getG1
attr KNX10.I09_Druckschalter_Brunnen readonly 1
attr KNX10.I09_Druckschalter_Brunnen room KNX,Wasser
attr KNX10.I09_Druckschalter_Brunnen webCmd :
define KNX10.I10_Taster_Garage_Hzg KNX 1/3/9:dpt1 tul
attr KNX10.I10_Taster_Garage_Hzg IODev tul
attr KNX10.I10_Taster_Garage_Hzg room KNX
define KNX10.I11_Taster_KuecheAPLSt_Esszi KNX 1/3/10:dpt1 tul
attr KNX10.I11_Taster_KuecheAPLSt_Esszi IODev tul
attr KNX10.I11_Taster_KuecheAPLSt_Esszi room KNX
define KNX10.I12_Taster_EssziLinksMitte_Kueche KNX 1/3/11:dpt1 tul
attr KNX10.I12_Taster_EssziLinksMitte_Kueche IODev tul
attr KNX10.I12_Taster_EssziLinksMitte_Kueche room KNX
define KNX10.I13_Taster_Tuer_Kueche_Flur KNX 1/3/12:dpt1 tul
attr KNX10.I13_Taster_Tuer_Kueche_Flur IODev tul
attr KNX10.I13_Taster_Tuer_Kueche_Flur room KNX
define KNX10.I14_Taster_Tuer_Kueche_Hzg KNX 1/3/13:dpt1 tul
attr KNX10.I14_Taster_Tuer_Kueche_Hzg IODev tul
attr KNX10.I14_Taster_Tuer_Kueche_Hzg room KNX
define KNX10.I15_Taster_Tuer_Badezimmer_Dusche KNX 1/3/14:dpt1 tul
attr KNX10.I15_Taster_Tuer_Badezimmer_Dusche IODev tul
attr KNX10.I15_Taster_Tuer_Badezimmer_Dusche room KNX
define KNX10.I16_Taster_Klingel KNX 1/3/15:dpt1 tul
attr KNX10.I16_Taster_Klingel IODev tul
attr KNX10.I16_Taster_Klingel event-on-update-reading state
attr KNX10.I16_Taster_Klingel room KNX
define AT_daily_end at *23:59 {\
# my $tagesarbeit = ReadingsVal("D_WMZ_SOLAR","energie_heute",0);;\
# fhem("setreading D_WMZ_SOLAR energie_gestern_gesamt $tagesarbeit");;\
# fhem("deletereading D_WMZ_SOLAR Energie_1");;\
# fhem("deletereading D_WMZ_SOLAR energie_heute");;\
# my $tagesarbeit = ReadingsVal("D_WMZ_FUBO","energie_heute",0);;\
# fhem("setreading D_WMZ_FUBO energie_gestern_gesamt $tagesarbeit");;\
# fhem("deletereading D_WMZ_FUBO Energie_1");;\
# fhem("deletereading D_WMZ_FUBO energie_heute");;\
fhem("set wetter_prop update");;\
}
attr AT_daily_end room _at
define AT_daily_begin at *00:00 set wetter_prop update
attr AT_daily_begin room _at
define DashDevel Dashboard
attr DashDevel userattr dashboard_tab2backgroundimage dashboard_tab2colcount dashboard_tab2devices dashboard_tab2groups dashboard_tab2icon dashboard_tab2name dashboard_tab2rowcentercolwidth dashboard_tab2sorting
attr DashDevel dashboard_tab1groups Thermometer,TEMP,outputs
attr DashDevel dashboard_tab1sorting t0c0,Thermometer,true,367,0,0,0:t0c0,outputs,true,351,0,367,0:t0c0,TEMP,true,374,0,718,0:
attr DashDevel dashboard_width 80%
attr DashDevel room HTTP,x_devel
define CAL Calendar ical url https://calendar.google.com/calendar/ical/okdnhr3ar6li8sdc2prfmkinq8%40group.calendar.google.com/private-8576ed9b65628500ee9d6a10e998abc6/basic.ics 14400
attr CAL hideLaterThan 86400
attr CAL hideOlderThan 86400
attr CAL onCreateEvent { \
$e->{alarm}= $e->{start}-60 if($e->{summary} =~ /test/);;;;\
$e->{alarm}= $e->{start}-2700 if($e->{summary} =~ /Frühschicht/);;;;\
$e->{alarm}= $e->{start}-86400 if($e->{summary} =~ /Spätschicht/);;;;\
$e->{alarm}= $e->{start}-2700 if($e->{summary} =~ /Nachtschicht/);;;;\
$e->{alarm}= $e->{start}-2700 if($e->{summary} =~ /[Ff]rei/);;;;\
\
\
}
attr CAL room Kalender
attr CAL update async
attr CAL widgetOverride onCreateEvent:textField-long
define DF_Weihnacht DOIF ([06:00-{sunrise_abs("REAL",900)}] or [{sunset_abs("REAL",-900)}-23:00] or (([SGS5_Stephan] eq "present" or [SGS5_Nadine] eq "present") and !isday() ) )\
(\
	set FS20_Weihnacht_Dach on,\
	set FS20_Weihnacht_FlurOG on,\
	set FS20_Weihnacht_Wozi on,\
	set KNX02.O10_Aktor_Aussen_Weihnacht_oben on,\
	set KNX02.O11_Aktor_Aussen_Weihnacht_unten on\
) DOELSE\
(\
	set FS20_Weihnacht_Dach off,\
	set FS20_Weihnacht_FlurOG off,\
	set FS20_Weihnacht_Wozi off,\
	set KNX02.O10_Aktor_Aussen_Weihnacht_oben off,\
	set KNX02.O11_Aktor_Aussen_Weihnacht_unten off\
\
)
attr DF_Weihnacht room Weihnachtsbeleuchtung,_doif,presence
attr DF_Weihnacht widgetOverride cmdState:textField-long
define N_CalStart notify CAL_Schichtplan_Stephan:start:.*googlecom.*  { Kalenderstart("$EVENT");; }
attr N_CalStart room Kalender
define N_CalEnde notify CAL_Schichtplan_Stephan:end:.*googlecom.* { Kalenderende("$EVENT");; }
attr N_CalEnde room Kalender,_notify
define D_Urlaub dummy
attr D_Urlaub room Kalender,_dummy
attr D_Urlaub setList ja nein
attr D_Urlaub webCmd ja:nein
define D_Gast dummy
attr D_Gast room Kalender,_dummy
attr D_Gast setList ja nein
attr D_Gast webCmd ja:nein
define D_Fruehschicht dummy
attr D_Fruehschicht room Kalender,_dummy
attr D_Fruehschicht setList ja nein
attr D_Fruehschicht webCmd ja:nein
define D_Spaetschicht dummy
attr D_Spaetschicht room Kalender,_dummy
attr D_Spaetschicht setList ja nein
attr D_Spaetschicht webCmd ja:nein
define D_Nachtschicht dummy
attr D_Nachtschicht room Kalender,_dummy
attr D_Nachtschicht setList ja nein
attr D_Nachtschicht webCmd ja:nein
define D_Tagschicht dummy
attr D_Tagschicht room Kalender,_dummy
attr D_Tagschicht setList ja nein
attr D_Tagschicht webCmd ja:nein
define D_Frei dummy
attr D_Frei room Kalender,_dummy
attr D_Frei setList ja nein
attr D_Frei webCmd ja:nein
define DF_Zeitplan DOIF (["CAL_Schichtplan_Stephan:start"]) ({\
fhem("set Pushover msg TERMIN title=KALENDER priority=1");;\
}\
)DOELSEIF\
([([$SELF:morgens]-3600)])\
(\
set alarmbot message jetzt ist morgens\
##{\
##fhem("set Pushover msg TERMIN title=KALENDER priority=1");;\
##}\
)
attr DF_Zeitplan room Kalender,_doif
define Uhr weblink iframe /fhem/www/pgm2/uhr.html
attr Uhr fp_fp_test 50,1200,1,Huhu
attr Uhr htmlattr width="370" height="120" frameborder="0"
attr Uhr room Ueberwachung
define fp_test FLOORPLAN
attr fp_test room HTTP
define rg_TEMP readingsGroup RE_TEMP_VorlaufHK:temperature RE_TEMP_RuecklaufHK:temperature
attr rg_TEMP alias Temperaturen
attr rg_TEMP mapping {'RE_TEMP_VorlaufHK:temperature' => 'VorlaufHK'}
attr rg_TEMP room _readingsGroup,x_devel
attr rg_TEMP valueFormat { temperature => "%.2f°C", humidity => "%.1f %%", dewpoint => "%.1f&deg;;C"}
define RE_TEMP_Bad dummy
attr RE_TEMP_Bad DbLogInclude temperature
attr RE_TEMP_Bad event-on-update-reading temperature
attr RE_TEMP_Bad group ERR_Bad,Thermometer
attr RE_TEMP_Bad room Heizung_ERR,OW_Remote
attr RE_TEMP_Bad stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_WoZi dummy
attr RE_TEMP_WoZi DbLogInclude temperature
attr RE_TEMP_WoZi event-on-update-reading temperature
attr RE_TEMP_WoZi group ERR_WoZiKue,Thermometer
attr RE_TEMP_WoZi room Heizung_ERR,OW_Remote
attr RE_TEMP_WoZi stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define TABLETUI HTTPSRV ftui/ ./www/tablet Tablet-UI
attr TABLETUI room HTTP
define RE_TEMP_Vorlauf_Kessel dummy
attr RE_TEMP_Vorlauf_Kessel DbLogInclude temperature
attr RE_TEMP_Vorlauf_Kessel event-on-update-reading temperature
attr RE_TEMP_Vorlauf_Kessel group Thermometer
attr RE_TEMP_Vorlauf_Kessel room Heizung,OW_Remote,_dummy
attr RE_TEMP_Vorlauf_Kessel stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}

define N_global_define_RE_TEMP notify global:DEFINED.RE_TEMP.* attr $EVTPART1 room OW_Remote,_dummy,Heizung;;attr $EVTPART1 group Thermometer;;attr $EVTPART1 DbLogInclude temperature;; attr $EVTPART1 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

attr N_global_define_RE_TEMP room _notify
define RE_TEMP_Ruecklauf_Kessel dummy
attr RE_TEMP_Ruecklauf_Kessel DbLogInclude temperature
attr RE_TEMP_Ruecklauf_Kessel event-on-update-reading temperature
attr RE_TEMP_Ruecklauf_Kessel group Thermometer
attr RE_TEMP_Ruecklauf_Kessel room Heizung,OW_Remote,_dummy
attr RE_TEMP_Ruecklauf_Kessel stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define N_global_define_N_RE_TEMP notify global:DEFINED.N_RE_TEMP.* attr $EVTPART1 room OW_Remote,_notify;;attr $EVTPART1 group TEMP
attr N_global_define_N_RE_TEMP room _notify
define SVG_GasVLRL SVG logdb:SVG_GasVLRL:HISTORY
attr SVG_GasVLRL endPlotNow 1
attr SVG_GasVLRL plotsize 1500,600
attr SVG_GasVLRL room SVG,SVG_Heizung
define RE_TEMP_Speicher_01 dummy
attr RE_TEMP_Speicher_01 DbLogInclude temperature
attr RE_TEMP_Speicher_01 event-on-update-reading temperature
attr RE_TEMP_Speicher_01 group Thermometer
attr RE_TEMP_Speicher_01 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_01 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_02 dummy
attr RE_TEMP_Speicher_02 DbLogInclude temperature
attr RE_TEMP_Speicher_02 event-on-update-reading temperature
attr RE_TEMP_Speicher_02 group Thermometer
attr RE_TEMP_Speicher_02 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_02 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_03 dummy
attr RE_TEMP_Speicher_03 DbLogInclude temperature
attr RE_TEMP_Speicher_03 event-on-update-reading temperature
attr RE_TEMP_Speicher_03 group Thermometer
attr RE_TEMP_Speicher_03 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_03 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_04 dummy
attr RE_TEMP_Speicher_04 DbLogInclude temperature
attr RE_TEMP_Speicher_04 comment Irgendwo unter dem unteren Mittenstutzen
attr RE_TEMP_Speicher_04 event-on-update-reading temperature
attr RE_TEMP_Speicher_04 group Thermometer
attr RE_TEMP_Speicher_04 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_04 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_05 dummy
attr RE_TEMP_Speicher_05 DbLogInclude temperature
attr RE_TEMP_Speicher_05 comment Irgendwo über dem unteren Mittenstutzen
attr RE_TEMP_Speicher_05 event-on-update-reading temperature
attr RE_TEMP_Speicher_05 group Thermometer
attr RE_TEMP_Speicher_05 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_05 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_06 dummy
attr RE_TEMP_Speicher_06 DbLogInclude temperature
attr RE_TEMP_Speicher_06 comment Oberer Mittelstutzen
attr RE_TEMP_Speicher_06 event-on-update-reading temperature
attr RE_TEMP_Speicher_06 group Thermometer
attr RE_TEMP_Speicher_06 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_06 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_07 dummy
attr RE_TEMP_Speicher_07 DbLogInclude temperature
attr RE_TEMP_Speicher_07 event-on-update-reading temperature
attr RE_TEMP_Speicher_07 group Thermometer
attr RE_TEMP_Speicher_07 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_07 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_08 dummy
attr RE_TEMP_Speicher_08 DbLogInclude temperature
attr RE_TEMP_Speicher_08 event-on-update-reading temperature
attr RE_TEMP_Speicher_08 group Thermometer
attr RE_TEMP_Speicher_08 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_08 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_09 dummy
attr RE_TEMP_Speicher_09 DbLogInclude temperature
attr RE_TEMP_Speicher_09 event-on-update-reading temperature
attr RE_TEMP_Speicher_09 group Thermometer
attr RE_TEMP_Speicher_09 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_Speicher_09 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define RE_TEMP_Speicher_10 dummy
attr RE_TEMP_Speicher_10 DbLogInclude temperature
attr RE_TEMP_Speicher_10 event-on-update-reading temperature
attr RE_TEMP_Speicher_10 group Thermometer
attr RE_TEMP_Speicher_10 room Heizung,OW_Remote,_dummy,Heizung_Puffer
attr RE_TEMP_Speicher_10 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define testtemp dummy
attr testtemp room _dummy,x_devel
attr testtemp userReadings val2 {my $val1=ReadingsVal($NAME,"val1",0);; $val1 < 3680 ? $val1 : 0;;}
define SVG_PS1500_Detail SVG logdb:SVG_PS1500_Detail:HISTORY
attr SVG_PS1500_Detail plotsize 1400,600
attr SVG_PS1500_Detail room SVG,SVG_Heizung,SVG_Holzvergaser
define D_DuschenUm6 dummy
attr D_DuschenUm6 room _dummy
attr D_DuschenUm6 setList ja nein
attr D_DuschenUm6 webCmd ja:nein
define DF_addLogHourly DOIF ([:59] or [:01])(Log3 dummy47, 3, "dummy47 47";;)
attr DF_addLogHourly disable 1
attr DF_addLogHourly room Logging,_doif
attr DF_addLogHourly widgetOverride cmdState:textField-long
define DF_addLogDaily DOIF ([23:59] or [00:01])()
attr DF_addLogDaily disable 1
attr DF_addLogDaily do always
attr DF_addLogDaily room Logging,_doif
attr DF_addLogDaily widgetOverride cmdState:textField-long
define logPro logProxy
attr logPro room Logging
define DF_FFO_Alarm DOIF (1)({\
fhem("set alarmbot message Feuerwehr Einsatz");;\
fhem("set Pushover msg ALARM title=FFO priority=1");;\
if (ReadingsVal("KNX01.O01_Aktor_Leuchte_Flur_EG_OG","state",0) eq "off") {\
	fhem("set KNX01.O01_Aktor_Leuchte_Flur_EG_OG on-for-timer 300");;;;\
}\
if (ReadingsVal("HMW03.O05_Leuchte_Wegelicht_Decke","state",0) eq "off") {\
	fhem("set KNX31.O05_Aktor_Leuchte_Wegelicht_Decke on;;sleep 300;;set KNX31.O05_Aktor_Leuchte_Wegelicht_Decke off ");;;;\
}\
if ("[KNX01.O03_Aktor_Leuchte_HZGRaum]" eq "off") {\
	fhem("set KNX01.O03_Aktor_Leuchte_HZGRaum on;;sleep 300;;set KNX01.O03_Aktor_Leuchte_HZGRaum off ");;;;\
}})\
({\
my $lastAlarm = ReadingsTimestamp("$SELF","state",0);;\
fhem("setreading $SELF LastAlarm $lastAlarm");;\
})\
()\

attr DF_FFO_Alarm cmdState none1,FME,none3
attr DF_FFO_Alarm do always
attr DF_FFO_Alarm room _doif,x_FFO
attr DF_FFO_Alarm userReadings LastAlarm:state.* {ReadingsTimestamp("$SELF","state",0)},\
LastAlarmState:state.* {echo "test";;}
attr DF_FFO_Alarm wait 0,10,3600
attr DF_FFO_Alarm widgetOverride cmdState:textField-long
define DF_sendAll DOIF ([+:15])(\
	{\
		sendAllTemp();;;;\
		sendAllHeating();;;;\
	}\
)
attr DF_sendAll do always
attr DF_sendAll room Ueberwachung,_doif
attr DF_sendAll widgetOverride cmdState:textField-long
define D_sendAll_Interval dummy
attr D_sendAll_Interval room _dummy
define cmd_alarmtest cmdalias alarmtest AS defmod alarmtest at +00:00:05 set alarmbot message ALARM
attr cmd_alarmtest room cmdalias
define cmd_shutdown cmdalias ssr AS save;;sleep 1;;{WriteStatefile};; sleep 2;; shutdown restart;;
attr cmd_shutdown room cmdalias
define cmd_neustart cmdalias neustart AS save;; {WriteStatefile};; shutdown restart
attr cmd_neustart room cmdalias
define KNX20.O01_Aktor_PWM_Schlafzimmer KNX 1/4/0:dpt5.001
attr KNX20.O01_Aktor_PWM_Schlafzimmer IODev tul
attr KNX20.O01_Aktor_PWM_Schlafzimmer devStateIcon on::off off::on
attr KNX20.O01_Aktor_PWM_Schlafzimmer group KNX,ERR_Schlafzimmer
attr KNX20.O01_Aktor_PWM_Schlafzimmer readonly 1
attr KNX20.O01_Aktor_PWM_Schlafzimmer room Heizung_ERR,KNX
attr KNX20.O01_Aktor_PWM_Schlafzimmer webCmd g1
attr KNX20.O01_Aktor_PWM_Schlafzimmer widgetOverride g1:slider,0,1,100
define KNX20.O02_Aktor_PWM_Ankleide KNX 1/4/2:dpt5.001
attr KNX20.O02_Aktor_PWM_Ankleide IODev tul
attr KNX20.O02_Aktor_PWM_Ankleide devStateIcon on::off off::on
attr KNX20.O02_Aktor_PWM_Ankleide group ERR_Ankleide,KNX
attr KNX20.O02_Aktor_PWM_Ankleide readonly 1
attr KNX20.O02_Aktor_PWM_Ankleide room Heizung_ERR,KNX
attr KNX20.O02_Aktor_PWM_Ankleide webCmd g1
attr KNX20.O02_Aktor_PWM_Ankleide widgetOverride g1:slider,0,1,100
define KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ KNX 1/4/4:dpt5.001
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ IODev tul
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ devStateIcon on::off off::on
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ group ERR_WoZiKue,KNX
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ readonly 1
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ room Heizung_ERR,KNX
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ webCmd g1
attr KNX20.O03_Aktor_PWM_HKV_EG_WANDWZ widgetOverride g1:slider,0,1,100
define KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu KNX 1/4/6:dpt5.001
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu IODev tul
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu devStateIcon on::off off::on
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu group ERR_Rumpel,KNX
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu readonly 1
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu room Heizung_ERR,KNX
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu webCmd g1
attr KNX20.O04_Aktor_PWM_HKV_EG_FuBoNeu widgetOverride g1:slider,0,1,100
##define LOC_TEMP_Vorlauf_Solar OWDevice 28.856820070000 60
##attr LOC_TEMP_Vorlauf_Solar IODev myOWServer
##attr LOC_TEMP_Vorlauf_Solar event-on-update-reading temperature
##attr LOC_TEMP_Vorlauf_Solar model DS18B20
##attr LOC_TEMP_Vorlauf_Solar resolution 10
##attr LOC_TEMP_Vorlauf_Solar room OW_Local
##attr LOC_TEMP_Vorlauf_Solar stateFormat T: temperature °C
define KNX21.O01_Aktor_DimAbs_Schlafzimmer KNX 1/5/0:dpt5.001
attr KNX21.O01_Aktor_DimAbs_Schlafzimmer IODev tul
attr KNX21.O01_Aktor_DimAbs_Schlafzimmer devStateIcon on::off off::on
attr KNX21.O01_Aktor_DimAbs_Schlafzimmer room KNX
attr KNX21.O01_Aktor_DimAbs_Schlafzimmer webCmd g1
attr KNX21.O01_Aktor_DimAbs_Schlafzimmer widgetOverride g1:slider,0,1,100
define KNX21.O02_Aktor_DimAbs_Badewanne KNX 1/5/1:dpt5.001
attr KNX21.O02_Aktor_DimAbs_Badewanne IODev tul
attr KNX21.O02_Aktor_DimAbs_Badewanne devStateIcon on::off off::on
attr KNX21.O02_Aktor_DimAbs_Badewanne room KNX
attr KNX21.O02_Aktor_DimAbs_Badewanne webCmd g1
attr KNX21.O02_Aktor_DimAbs_Badewanne widgetOverride g1:slider,0,1,100
define KNX21.Zentral_Aktor_DimAbs KNX 1/5/4:dpt5.001
attr KNX21.Zentral_Aktor_DimAbs IODev tul
attr KNX21.Zentral_Aktor_DimAbs devStateIcon on::off off::on
attr KNX21.Zentral_Aktor_DimAbs room KNX
attr KNX21.Zentral_Aktor_DimAbs webCmd g1
attr KNX21.Zentral_Aktor_DimAbs widgetOverride g1:slider,0,1,100
define KNX21.Zentral_Fehler KNX 1/5/4:dpt1.002
attr KNX21.Zentral_Fehler IODev tul
attr KNX21.Zentral_Fehler room KNX
attr KNX21.Zentral_Fehler webCmd g1
attr KNX21.Zentral_Fehler widgetOverride g1:slider,0,1,100
define DF_sendInfoRemotebot DOIF ([+:05])(\
	{\
		sendAllTemp();;;;\
		sendAllHeating();;;;\
	}\
)
attr DF_sendInfoRemotebot room Telegram_BOT,Ueberwachung,_doif
attr DF_sendInfoRemotebot widgetOverride cmdState:textField-long
define KNX20.O05_Aktor_PWM_Bad_FuBo KNX 1/4/8:dpt5.001
attr KNX20.O05_Aktor_PWM_Bad_FuBo IODev tul
attr KNX20.O05_Aktor_PWM_Bad_FuBo devStateIcon on::off off::on
attr KNX20.O05_Aktor_PWM_Bad_FuBo group ERR_Bad,KNX
attr KNX20.O05_Aktor_PWM_Bad_FuBo readonly 1
attr KNX20.O05_Aktor_PWM_Bad_FuBo room Heizung_ERR,KNX
attr KNX20.O05_Aktor_PWM_Bad_FuBo webCmd g1
attr KNX20.O05_Aktor_PWM_Bad_FuBo widgetOverride g1:slider,0,1,100
define KNX20.O06_Aktor_PWM_Bad_Wand KNX 1/4/10:dpt5.001
attr KNX20.O06_Aktor_PWM_Bad_Wand IODev tul
attr KNX20.O06_Aktor_PWM_Bad_Wand devStateIcon on::off off::on
attr KNX20.O06_Aktor_PWM_Bad_Wand group ERR_Bad,KNX
attr KNX20.O06_Aktor_PWM_Bad_Wand readonly 1
attr KNX20.O06_Aktor_PWM_Bad_Wand room Heizung_ERR,KNX
attr KNX20.O06_Aktor_PWM_Bad_Wand webCmd g1
attr KNX20.O06_Aktor_PWM_Bad_Wand widgetOverride g1:slider,0,1,100
define KNX20.O07_Aktor_PWM_Dusche_FuBoWand KNX 1/4/12:dpt5.001
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand IODev tul
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand devStateIcon on::off off::on
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand group ERR_Bad,KNX
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand readonly 1
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand room Heizung_ERR,KNX
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand webCmd g1
attr KNX20.O07_Aktor_PWM_Dusche_FuBoWand widgetOverride g1:slider,0,1,100
define KNX20.O08_Aktor_PWM_BueroFlur KNX 1/4/14:dpt5.001
attr KNX20.O08_Aktor_PWM_BueroFlur IODev tul
attr KNX20.O08_Aktor_PWM_BueroFlur devStateIcon on::off off::on
attr KNX20.O08_Aktor_PWM_BueroFlur group ERR_FlurBuero,KNX
attr KNX20.O08_Aktor_PWM_BueroFlur room Heizung_ERR,KNX
attr KNX20.O08_Aktor_PWM_BueroFlur webCmd g1
attr KNX20.O08_Aktor_PWM_BueroFlur widgetOverride g1:slider,0,1,100
define DF_HZG_Ankleide DOIF (	[RE_TEMP_Ankleide:temperature] < [D_TsollAnkleide] )\
	(\
		set KNX20.O02_Aktor_PWM_Ankleide value 100\
	) \
DOELSEIF  (\
	[RE_TEMP_Ankleide:temperature] > [D_TsollAnkleide])\
	(\
		set KNX20.O02_Aktor_PWM_Ankleide value 25\
	)\

attr DF_HZG_Ankleide cmdState heizen|aus
attr DF_HZG_Ankleide disable 0
attr DF_HZG_Ankleide event-on-change-reading Alle Events deaktiviert
attr DF_HZG_Ankleide group ERR_Ankleide
attr DF_HZG_Ankleide room Heizung_ERR,_doif
attr DF_HZG_Ankleide widgetOverride cmdState:textField-long
define DF_WatchStromzaehlerConnected DOIF ([Stromzaehler:state] ne "opened")(set alarmbot message Stromzaehler disconnected)
attr DF_WatchStromzaehlerConnected do always
attr DF_WatchStromzaehlerConnected room Ueberwachung,_doif
attr DF_WatchStromzaehlerConnected wait 60
attr DF_WatchStromzaehlerConnected widgetOverride cmdState:textField-long
define cmd_grep cmdalias grep .* AS {qx(grep -i \'$EVENT\' *.cfg FHEM/99*.pm)}
attr cmd_grep room cmdalias
define SVG_KNX02_Stromwerte SVG logdb:SVG_KNX02_Stromwerte:HISTORY
attr SVG_KNX02_Stromwerte plotsize 1000,800
attr SVG_KNX02_Stromwerte room SVG
define rg_Stromverbrauch readingsGroup <DEVICE>,<Hour>,<HourLast>,<Day>,<DayLast>,<Month>,<MonthLast>,<Year>,<YearLast> <hr> KNX02.O.._Counter:statTotal_energyHour,statTotal_energyHourLast,statTotal_energyDay,statTotal_energyDayLast,statTotal_energyMonth,statTotal_energyMonthLast,statTotal_energyYear,statTotal_energyYearLast <hr> rg_Stromverbrauch:$sum,$sum,$sum,$sum,$sum,$sum,$sum,$sum <hr> Stromzaehler:statTotal_energyHour,statTotal_energyHourLast,statTotal_energyDay,statTotal_energyDayLast,statTotal_energyMonth,statTotal_energyMonthLast,statTotal_energyYear,statTotal_energyYearLast
attr rg_Stromverbrauch firstCalcRow 2
attr rg_Stromverbrauch mapping {'KNX02.O01_Counter' => 'KNX02.O01 Brunnen', 'KNX02.O02_Counter' => 'KNX02.O02 Kühlschrank', 'KNX02.O03_Counter' => 'KNX02.O03 Heizung', 'KNX02.O04_Counter' => 'KNX02.O04 WAMA', 'KNX02.O05_Counter' => 'KNX02.O05 Spülmaschine', 'KNX02.O06_Counter' => 'KNX02.O06 Wasserbett', 'KNX02.O07_Counter' => 'KNX02.O07 isoft EMEM', 'KNX02.O08_Counter' => 'KNX02.O08 ', 'KNX02.O09_Counter' => 'KNX02.O09 Tonstrom Esszi ', 'KNX02.O10_Counter' => 'KNX02.O10 ', 'KNX02.O11_Counter' => 'KNX02.O11 ', 'KNX02.O12_Counter' => 'KNX02.O12 Rumpel Gesamt ', 'rg_Stromverbrauch' => 'Summe'}
attr rg_Stromverbrauch nameStyle style="color:blue;;font-weight:bold"
attr rg_Stromverbrauch room _readingsGroup
attr rg_Stromverbrauch valueFormat %.1f kWh
define stats_KNX statistics KNX02.O.*Counter
attr stats_KNX deltaReadings total_energy
attr stats_KNX ignoreDefaultAssignments 1
attr stats_KNX room System
attr stats_KNX singularReadings KNX02.O.*Counter:total_energy:Delta:Hour|KNX02.O.*Counter:total_energy:Delta:Day|KNX02.O.*Counter:total_energy:Delta:Month|KNX02.O.*Counter:total_energy:Delta:Year
define fhem_sysmon SYSMON
attr fhem_sysmon disable 1
attr fhem_sysmon event-on-change-reading root
attr fhem_sysmon room System,Ueberwachung
attr fhem_sysmon user-defined proc_list:1:Prozess Liste:ps -A
define cmd_roomadd cmdalias roomadd .* AS { for my $name (devspec2array("$EVTPART0")){ my $old_room = AttrVal($name,'room','');; if (index($old_room, $EVTPART1) == -1) {my $new_room = AttrVal($name,'room','') . ",$EVTPART1";; fhem("attr $name room $new_room")} } }
attr cmd_roomadd comment Aufruf: roomadd <devspec> <new_room>
attr cmd_roomadd room cmdalias
define KNX21.O03_Aktor_DimAbs_WaLaWoZi KNX 1/5/2:dpt5.001
attr KNX21.O03_Aktor_DimAbs_WaLaWoZi IODev tul
attr KNX21.O03_Aktor_DimAbs_WaLaWoZi devStateIcon on::off off::on
attr KNX21.O03_Aktor_DimAbs_WaLaWoZi room KNX
attr KNX21.O03_Aktor_DimAbs_WaLaWoZi webCmd g1
attr KNX21.O03_Aktor_DimAbs_WaLaWoZi widgetOverride g1:slider,0,1,100
define KNX21.O04_Aktor_DimAbs KNX 1/5/4:dpt5.001
attr KNX21.O04_Aktor_DimAbs IODev tul
attr KNX21.O04_Aktor_DimAbs devStateIcon on::off off::on
attr KNX21.O04_Aktor_DimAbs readonly 1
attr KNX21.O04_Aktor_DimAbs room KNX
attr KNX21.O04_Aktor_DimAbs webCmd g1
attr KNX21.O04_Aktor_DimAbs widgetOverride g1:slider,0,1,100
define FS20_Weihnacht_Wozi FS20 4900 00
attr FS20_Weihnacht_Wozi DbLogInclude state
attr FS20_Weihnacht_Wozi IODev CUL_0
attr FS20_Weihnacht_Wozi room FS20,Weihnachtsbeleuchtung
define FS20_Weihnacht_FlurOG FS20 4902 00
attr FS20_Weihnacht_FlurOG DbLogInclude state
attr FS20_Weihnacht_FlurOG IODev CUL_0
attr FS20_Weihnacht_FlurOG room FS20,Weihnachtsbeleuchtung
define alarmbot TelegramBot
attr alarmbot defaultPeer 137545657 157487574
attr alarmbot room Telegram_BOT
define SVG_Brunnen SVG logdb:SVG_Brunnen:HISTORY
attr SVG_Brunnen plotsize 1000,1000
attr SVG_Brunnen room SVG,Wasser
define DF_Brunnen DOIF ([KNX10.I09_Druckschalter_Brunnen:getG1] eq "off")\
	(\
	set KNX02.O01_Aktor_Brunnen off\
	)\
DOELSEIF\
([KNX10.I09_Druckschalter_Brunnen:getG1] eq "on" )\
	(\
	set KNX02.O01_Aktor_Brunnen on\
	)\
	(\
	set alarmbot message "Brunnenpumpe läuft bereits seit 15 Minuten!"\
	)\
DOELSEIF([KNX02.O01_Stromwert:getG1] > 3000)\
	(\
	## bei Erhalt am 30.11. auf 2700mA und 45 sekunden gestellt\
	## am 18.12. aufgrund vieler Alarme auf 2900 und 60 sekunden geändert\
	set KNX02.O01_Aktor_Brunnen off,\
	(set alarmbot message ALARM: Brunnenstrom fuer 60 Sekunden ueber 3000mA, Brunnen für 240 sek abgeschaltet)\
	)\
	(\
	set KNX02.O01_Aktor_Brunnen on,\
	set alarmbot message Brunnen wieder an\
	)\
##DOELSEIF([KNX02.O01_Stromwert:getG1] < 80)\
##	(\
##	set KNX02.O01_Aktor_Brunnen off,\
##	(set alarmbot message ALARM: Brunnen: Presscontrol hat abgeschaltet, obwohl Enddruck nicht erreicht)\
##	)
attr DF_Brunnen cmdState Pumpe aus|Pumpe an|Pumpenstrom > 3000mA
attr DF_Brunnen room Wasser,_doif
attr DF_Brunnen wait 0:0,900:60,240
attr DF_Brunnen widgetOverride cmdState:textField-long
define DF_Brunnen_Watchdog DOIF ([KNX02.O01_Stromwert:getG1] > 3000)\
	(\
	## bei Erhalt am 30.11. auf 2700mA und 45 sekunden gestellt\
	## am 18.12. aufgrund vieler Alarme auf 2900 und 60 sekunden geändert\
	set KNX02.O01_Aktor_Brunnen off,\
	(set alarmbot message ALARM: Brunnenstrom fuer 90 Sekunden ueber 3000mA, Brunnen für 240 sek abgeschaltet)\
	)\
	(\
	set KNX02.O01_Aktor_Brunnen on,\
	set alarmbot message Brunnen wieder an\
	)\
\
\
\
##([KNX02.O01_Stromwert:getG1] > 2800)\
##	(\
##		## bei Erhalt am 30.11. auf 2700mA und 45 sekunden gestellt\
##		## am 18.12. aufgrund vieler Alarme auf 2800mA und 60 sekunden geändert\
##		set KNX02.O01_Aktor_Brunnen off,\
##		(set alarmbot message ALARM: Brunnenstrom fuer 60 Sekunden ueber 2700mA, Brunnen für 240 sek abgeschaltet)\
##	)\
##DOELSEIF([KNX10.I09_Druckschalter_Brunnen:getG1] eq "on")\
##	(\
##		set KNX02.O01_Aktor_Brunnen on,\
##		set alarmbot message Brunnen wieder an\
##	)
attr DF_Brunnen_Watchdog cmdState Pumpe sicherheitshalber abgeschaltet | Pumpe verfügbar
attr DF_Brunnen_Watchdog do always
attr DF_Brunnen_Watchdog room Ueberwachung,Wasser,_doif
attr DF_Brunnen_Watchdog wait 90:240
attr DF_Brunnen_Watchdog widgetOverride cmdState:textField-long
define FS20_Weihnacht_Dach FS20 4901 00
attr FS20_Weihnacht_Dach DbLogInclude state
attr FS20_Weihnacht_Dach IODev CUL_0
attr FS20_Weihnacht_Dach room FS20,Weihnachtsbeleuchtung
define SVG_WAMA SVG logdb:SVG_WAMA:HISTORY
attr SVG_WAMA endPlotNow 0
attr SVG_WAMA plotsize 1000,900
attr SVG_WAMA room SVG,Wasser
define DF_WAMA DOIF ([KNX02.O04_Stromwert:current] < 0.033)\
(	\
	set remotebot message WAMA fertig\
)\
(\
	##set KNX02.O04_Aktor_WAMA off\
)\
DOELSEIF([KNX02.O04_Stromwert:current] > 0.033 and [KNX02.O04_Stromwert:current] < 0.042)\
(\
	set KNX32.O01_Aktor_Zirkulation_WW on-for-timer 120,\
	set remotebot message WAMA Zirkulation on\
)\
DOELSEIF([KNX02.O04_Stromwert:current] > 0.048 and [KNX02.O04_Stromwert:current] < 0.052)\
(\
	set remotebot message WAMA Fertig in\
)\
DOELSEIF([KNX02.O04_Stromwert:current] > 0.052 and [KNX02.O04_Stromwert:current] < 1.200)\
(\
	set remotebot message WAMA waschen\
)\
DOELSEIF([KNX02.O04_Stromwert:current] > 8.500)\
(\
	set remotebot message WAMA heizen\
)
attr DF_WAMA room Ueberwachung,Wasser,_doif
attr DF_WAMA wait 0,1800:0:60:0
attr DF_WAMA widgetOverride cmdState:textField-long
define DF_SYSMON DOIF ([+30])(\
(set remotebot message \
CPU-Last: [fhem_sysmon:cpu_idle_stat]\n\
Prozessliste: [fhem_sysmon:proc_list]\n\
[fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$1] MB benutzt, das entspricht einer Auslastung von [fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$2] %, aber \
[fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$3] MB sind noch frei)\
)DOELSEIF ([fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$2] > 80 )((set remotebot message Es sind bereits [fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$2] % belegt, d.h. es sind nur noch\
[fhem_sysmon:root:".*Used:\s(\d+)\sMB,\s(\d+)\s%,\sAvailable:\s(\d+)\sMB.*":$3] MB frei!) )
attr DF_SYSMON do always
attr DF_SYSMON room System,Ueberwachung,_doif
attr DF_SYSMON widgetOverride cmdState:textField-long
define DF_TFK01 DOIF ([TFK_01] eq "opened")\
(\
	set remotebot message Fenster Schlafzimmer offen!\
) \
(\
	set alarmbot message ALARM: Fenster Schlafzimmer offen seit > 30 Minuten\
)\
DOELSEIF ([TFK_01] eq "opened" and [HMW03.I03_Taster_Garagentor_innen_rechts:press_short])\
(\
	set alarmbot message ALARM: Fenster Schlafzimmer offen!\
)\
DOELSEIF ([TFK_01] eq "closed")\
(\
	set remotebot message Fenster Schlafzimmer geschlossen!\
)\

attr DF_TFK01 do always
attr DF_TFK01 room _doif,x_devel
attr DF_TFK01 wait 0,1800:0:0
attr DF_TFK01 widgetOverride cmdState:textField-long
define DF_Stromueberwachung_Aussen DOIF ([KNX02.O10_Stromwert:getG1] < 60 or [KNX02.O10_Stromwert:getG1] > 75)(set KNX02.O10_Aktor_Aussen_Weihnacht_oben off, set remotebot message Aussenbeleuchtung abgeschaltet)
attr DF_Stromueberwachung_Aussen room Ueberwachung,Weihnachtsbeleuchtung,_doif
attr DF_Stromueberwachung_Aussen wait 10
attr DF_Stromueberwachung_Aussen widgetOverride cmdState:textField-long
define KNX100.I01_BWM_Flur_EG_Praesenz KNX 2/0/2:dpt1 tul
attr KNX100.I01_BWM_Flur_EG_Praesenz IODev tul
attr KNX100.I01_BWM_Flur_EG_Praesenz event-on-change-reading 1
attr KNX100.I01_BWM_Flur_EG_Praesenz listenonly 1
attr KNX100.I01_BWM_Flur_EG_Praesenz room KNX
attr KNX100.I01_BWM_Flur_EG_Praesenz webCmd :
define KNX100.I01_BWM_Flur_EG_Helligkeit KNX 2/0/1:dpt9.004 tul
attr KNX100.I01_BWM_Flur_EG_Helligkeit DbLogInclude state
attr KNX100.I01_BWM_Flur_EG_Helligkeit IODev tul
attr KNX100.I01_BWM_Flur_EG_Helligkeit event-on-change-reading state
attr KNX100.I01_BWM_Flur_EG_Helligkeit listenonly 1
attr KNX100.I01_BWM_Flur_EG_Helligkeit room KNX
define KNX100.I01_BWM_Flur_EG_Lichtgruppe KNX 2/0/0:dpt1 tul
attr KNX100.I01_BWM_Flur_EG_Lichtgruppe DbLogInclude state
attr KNX100.I01_BWM_Flur_EG_Lichtgruppe IODev tul
attr KNX100.I01_BWM_Flur_EG_Lichtgruppe event-on-update-reading state,getG1
attr KNX100.I01_BWM_Flur_EG_Lichtgruppe listenonly 1
attr KNX100.I01_BWM_Flur_EG_Lichtgruppe room KNX
define N_global_define_SVG notify global:DEFINED.SVG_.* attr $EVTPART1 room SVG;;attr $EVTPART1 plotsize 1200,400
attr N_global_define_SVG room _notify
define cmd_sendTelegramSVG cmdalias TGSVG .* AS {TelegramBot_ExecuteCommand($defs{"remotebot"}, 137545657, '{plotAsPng("$defs{$EVENT}")}');;;; return;;;;}
attr cmd_sendTelegramSVG room cmdalias
define cmd_sendTelegramMSG cmdalias TGMSG .* AS {TelegramBot_ExecuteCommand($defs{"remotebot"}, 137545657, '{plotAsPng($EVENT)}');;;; return;;;;}
attr cmd_sendTelegramMSG room cmdalias
define cmd_clearSVGCache cmdalias csvg AS set WEB clearSvgCache
attr cmd_clearSVGCache room cmdalias
define DF_presence DOIF ([FritzBoxSNSH:mac_90_94_97_F8_73_51:"(Honor-10.*)"])\
(\
	set alarmbot message Stephans Handy ist zuhause\
)\
DOELSE\
(\
	set alarmbot message Stephans Handy ist nicht mehr zuhause\
)\

attr DF_presence do always
attr DF_presence room _doif,x_devel
attr DF_presence widgetOverride cmdState:textField-long
define DF_Heizung_Offset_Boost DOIF (["$SELF:aktivieren"]) \
	(\
		attr DF_calcVLSoll disable 1,\
		setreading $SELF saved [DF_calcVLSoll:vltemp],\
		setreading PID.FUBO desired [DF_calcVLSoll:vltemp]+5\
		\
	)\
	(	\
		attr DF_calcVLSoll disable 0,\
		setreading DF_calcVLSoll vltemp [$SELF:saved],\
		set $SELF aktivieren inaktiv\
	)
attr DF_Heizung_Offset_Boost cmdState aktiv,inaktiv
attr DF_Heizung_Offset_Boost do always
attr DF_Heizung_Offset_Boost readingList aktivieren
attr DF_Heizung_Offset_Boost room Heizung,_doif
attr DF_Heizung_Offset_Boost setList aktivieren
attr DF_Heizung_Offset_Boost wait 0,900
attr DF_Heizung_Offset_Boost webCmd aktivieren
attr DF_Heizung_Offset_Boost widgetOverride cmdState:textField-long wait:textField-long aktivieren:uzsuSelectRadio,starten
define DF_UEW_PID.FUBO DOIF ([PID_HZFHEM])(set remotebot message PID_HZFHEM liefert seit [PID_HZFHEM:actuation:sec] Sekunden keine Events mehr)
attr DF_UEW_PID.FUBO do resetwait
attr DF_UEW_PID.FUBO repeatcmd 60
attr DF_UEW_PID.FUBO room Heizung,Ueberwachung,_doif
attr DF_UEW_PID.FUBO wait 150
define DF_KNX100.I01_BWM DOIF ([KNX100.I01_BWM_Flur_EG_Lichtgruppe] eq "on" && \
([KNX100.I01_BWM_Flur_EG_Helligkeit:getG1:d] < 60 || [KNX01.O01_Aktor_Leuchte_Flur_EG_OG:status-get] eq "on") )\
	(\
	set KNX01.O01_Aktor_Leuchte_Flur_EG_OG on,\
	set KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch on\
	)\
DOELSEIF([KNX100.I01_BWM_Flur_EG_Lichtgruppe] eq "off")\
	(\
	set KNX01.O01_Aktor_Leuchte_Flur_EG_OG off,\
	set KNX01.O08_Aktor_Leuchte_Flur_EG_provisorisch off\
	)
attr DF_KNX100.I01_BWM event-on-change-reading cmd
attr DF_KNX100.I01_BWM room _doif
attr DF_KNX100.I01_BWM wait 0:30
define SVG_logdb_4 SVG logdb:SVG_logdb_4:HISTORY
attr SVG_logdb_4 plotsize 1200,400
attr SVG_logdb_4 room SVG
define DF_WatchOW_RE_TEMP_Ankleide DOIF (["RE_TEMP_Ankleide:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ankleide do resetwait
attr DF_WatchOW_RE_TEMP_Ankleide event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ankleide group OW
attr DF_WatchOW_RE_TEMP_Ankleide repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ankleide room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ankleide stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ankleide wait 310
define DF_WatchOW_RE_TEMP_Bad DOIF (["RE_TEMP_Bad:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Bad do resetwait
attr DF_WatchOW_RE_TEMP_Bad event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Bad group OW
attr DF_WatchOW_RE_TEMP_Bad repeatcmd 30
attr DF_WatchOW_RE_TEMP_Bad room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Bad stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Bad wait 310
define DF_WatchOW_RE_TEMP_FlurOG DOIF (["RE_TEMP_FlurOG:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_FlurOG do resetwait
attr DF_WatchOW_RE_TEMP_FlurOG event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_FlurOG group OW
attr DF_WatchOW_RE_TEMP_FlurOG repeatcmd 30
attr DF_WatchOW_RE_TEMP_FlurOG room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_FlurOG stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_FlurOG wait 310
define DF_WatchOW_RE_TEMP_RuecklaufHK DOIF (["RE_TEMP_RuecklaufHK:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_RuecklaufHK do resetwait
attr DF_WatchOW_RE_TEMP_RuecklaufHK event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_RuecklaufHK group OW
attr DF_WatchOW_RE_TEMP_RuecklaufHK repeatcmd 30
attr DF_WatchOW_RE_TEMP_RuecklaufHK room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_RuecklaufHK stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_RuecklaufHK wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden DOIF (["RE_TEMP_Ruecklauf_EG_Boden:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_Kessel DOIF (["RE_TEMP_Ruecklauf_Kessel:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_Kessel wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad DOIF (["RE_TEMP_Ruecklauf_Schwimmbad:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_Solar DOIF (["RE_TEMP_Ruecklauf_Solar:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_Solar wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG DOIF (["RE_TEMP_Ruecklauf_WT_EG:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG wait 75
define DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation DOIF (["RE_TEMP_Ruecklauf_Zirkulation:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation do resetwait
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation group OW
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation repeatcmd 30
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation wait 75
define DF_WatchOW_RE_TEMP_Schlafzimmer DOIF (["RE_TEMP_Schlafzimmer:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Schlafzimmer do resetwait
attr DF_WatchOW_RE_TEMP_Schlafzimmer event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Schlafzimmer group OW
attr DF_WatchOW_RE_TEMP_Schlafzimmer repeatcmd 30
attr DF_WatchOW_RE_TEMP_Schlafzimmer room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Schlafzimmer stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Schlafzimmer wait 310
define DF_WatchOW_RE_TEMP_Speicher_01 DOIF ([RE_TEMP_Speicher_01:temperature:d] != 85 ) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_01 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_01 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_01 group OW
attr DF_WatchOW_RE_TEMP_Speicher_01 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_01 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_01 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_01 wait 75
define DF_WatchOW_RE_TEMP_Speicher_02 DOIF ([RE_TEMP_Speicher_02:temperature:d] != 85 ) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_02 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_02 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_02 group OW
attr DF_WatchOW_RE_TEMP_Speicher_02 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_02 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_02 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_02 wait 75
define DF_WatchOW_RE_TEMP_Speicher_03 DOIF (["RE_TEMP_Speicher_03:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_03 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_03 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_03 group OW
attr DF_WatchOW_RE_TEMP_Speicher_03 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_03 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_03 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_03 wait 75
define DF_WatchOW_RE_TEMP_Speicher_04 DOIF (["RE_TEMP_Speicher_04:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_04 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_04 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_04 group OW
attr DF_WatchOW_RE_TEMP_Speicher_04 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_04 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_04 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_04 wait 75
define DF_WatchOW_RE_TEMP_Speicher_05 DOIF (["RE_TEMP_Speicher_05:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_05 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_05 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_05 group OW
attr DF_WatchOW_RE_TEMP_Speicher_05 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_05 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_05 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_05 wait 75
define DF_WatchOW_RE_TEMP_Speicher_06 DOIF (["RE_TEMP_Speicher_06:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_06 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_06 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_06 group OW
attr DF_WatchOW_RE_TEMP_Speicher_06 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_06 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_06 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_06 wait 75
define DF_WatchOW_RE_TEMP_Speicher_07 DOIF (["RE_TEMP_Speicher_07:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_07 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_07 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_07 group OW
attr DF_WatchOW_RE_TEMP_Speicher_07 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_07 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_07 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_07 wait 75
define DF_WatchOW_RE_TEMP_Speicher_08 DOIF (["RE_TEMP_Speicher_08:temperature"]) \
(\
set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)\
(\
set alarmbot message ALARM Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)
attr DF_WatchOW_RE_TEMP_Speicher_08 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_08 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_08 group OW
attr DF_WatchOW_RE_TEMP_Speicher_08 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_08 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_08 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_08 wait 75,600
define DF_WatchOW_RE_TEMP_Speicher_09 DOIF (["RE_TEMP_Speicher_09:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_09 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_09 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_09 group OW
attr DF_WatchOW_RE_TEMP_Speicher_09 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_09 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_09 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_09 wait 75
define DF_WatchOW_RE_TEMP_Speicher_10 DOIF (["RE_TEMP_Speicher_10:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Speicher_10 do resetwait
attr DF_WatchOW_RE_TEMP_Speicher_10 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Speicher_10 group OW
attr DF_WatchOW_RE_TEMP_Speicher_10 repeatcmd 30
attr DF_WatchOW_RE_TEMP_Speicher_10 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Speicher_10 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Speicher_10 wait 75
define DF_WatchOW_RE_TEMP_VorlaufHK DOIF (["RE_TEMP_VorlaufHK:temperature"]) (\
set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)\
(\
set alarmbot message ALARM Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)
attr DF_WatchOW_RE_TEMP_VorlaufHK do resetwait
attr DF_WatchOW_RE_TEMP_VorlaufHK event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_VorlaufHK group OW
attr DF_WatchOW_RE_TEMP_VorlaufHK repeatcmd 30
attr DF_WatchOW_RE_TEMP_VorlaufHK room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_VorlaufHK stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_VorlaufHK wait 75,600
define DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden DOIF (["RE_TEMP_Vorlauf_EG_Boden:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden do resetwait
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden group OW
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden repeatcmd 30
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden wait 75
define DF_WatchOW_RE_TEMP_Vorlauf_Kessel DOIF (["RE_TEMP_Vorlauf_Kessel:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel do resetwait
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel group OW
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel repeatcmd 30
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Vorlauf_Kessel wait 75
define DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad DOIF (["RE_TEMP_Vorlauf_Schwimmbad:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad do resetwait
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad group OW
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad repeatcmd 30
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad wait 75
define DF_WatchOW_RE_TEMP_Vorlauf_Solar DOIF (["RE_TEMP_Vorlauf_Solar:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar do resetwait
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar group OW
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar repeatcmd 30
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Vorlauf_Solar wait 75
define DF_WatchOW_RE_TEMP_Vorlauf_WW DOIF (["RE_TEMP_Vorlauf_WW:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_Vorlauf_WW do resetwait
attr DF_WatchOW_RE_TEMP_Vorlauf_WW event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_Vorlauf_WW group OW
attr DF_WatchOW_RE_TEMP_Vorlauf_WW repeatcmd 30
attr DF_WatchOW_RE_TEMP_Vorlauf_WW room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_Vorlauf_WW stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_Vorlauf_WW wait 75
define DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher DOIF (["RE_TEMP_WW_Ausgang_Speicher:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher do resetwait
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher group OW
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher repeatcmd 30
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher wait 75
define DF_WatchOW_RE_TEMP_WoZi DOIF (["RE_TEMP_WoZi:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_WoZi do resetwait
attr DF_WatchOW_RE_TEMP_WoZi event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_WoZi group OW
attr DF_WatchOW_RE_TEMP_WoZi repeatcmd 30
attr DF_WatchOW_RE_TEMP_WoZi room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_WoZi stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_WoZi wait 310
define DF_Heizkesselbetrieb DOIF ([+:05] or [$SELF:status])(\
{Heizkesselbetrieb("[$SELF:status]")}\
)
attr DF_Heizkesselbetrieb DbLogInclude cmd
attr DF_Heizkesselbetrieb disable 1
attr DF_Heizkesselbetrieb do always
attr DF_Heizkesselbetrieb readingList status
attr DF_Heizkesselbetrieb room Gas,_doif
attr DF_Heizkesselbetrieb setList status
attr DF_Heizkesselbetrieb webCmd status
attr DF_Heizkesselbetrieb widgetOverride cmdState:textField-long status:uzsuSelectRadio,automatik,hand_frei,hand_gesperrt,urlaub
define rg_Stromverbrauch_DBREP readingsGroup <DEVICE>,<Hour>,<HourLast>,<Day>,<DayLast>,<Month>,<MonthLast>,<Year>,<YearLast> <hr> KNX02.O.._Counter:statTotal_energyHour,statTotal_energyHourLast,statTotal_energyDay,statTotal_energyDayLast,statTotal_energyMonth,statTotal_energyMonthLast,statTotal_energyYear,statTotal_energyYearLast <hr> rg_Stromverbrauch:$sum,$sum,$sum,$sum,$sum,$sum,$sum,$sum <hr> Stromzaehler:statTotal_energyHour,statTotal_energyHourLast,statTotal_energyDay,statTotal_energyDayLast,statTotal_energyMonth,statTotal_energyMonthLast,statTotal_energyYear,statTotal_energyYearLast
attr rg_Stromverbrauch_DBREP firstCalcRow 2
attr rg_Stromverbrauch_DBREP mapping {'KNX02.O01_Counter' => 'KNX02.O01 Brunnen', 'KNX02.O02_Counter' => 'KNX02.O02 Kühlschrank', 'KNX02.O03_Counter' => 'KNX02.O03 Heizung', 'KNX02.O04_Counter' => 'KNX02.O04 WAMA', 'KNX02.O05_Counter' => 'KNX02.O05 Spülmaschine', 'KNX02.O06_Counter' => 'KNX02.O06 Wasserbett', 'KNX02.O07_Counter' => 'KNX02.O07 isoft EMEM', 'KNX02.O08_Counter' => 'KNX02.O08 ', 'KNX02.O09_Counter' => 'KNX02.O09 Tonstrom Esszi ', 'KNX02.O10_Counter' => 'KNX02.O10 ', 'KNX02.O11_Counter' => 'KNX02.O11 ', 'KNX02.O12_Counter' => 'KNX02.O12 Rumpel Gesamt ', 'rg_Stromverbrauch' => 'Summe'}
attr rg_Stromverbrauch_DBREP nameStyle style="color:blue;;font-weight:bold"
attr rg_Stromverbrauch_DBREP room _readingsGroup
attr rg_Stromverbrauch_DBREP valueFormat %.1f kWh
define rg_Solar_DBREP readingsGroup <%measure_power>,<01>,<>,<02>,<>,<03>,<>,<04>,<>,<05>,<>,<06>,<>,<07>,<>,<08>,<>,<09>,<>,<10>,<>,<11>,<>,<12>,<>,<13>,<>,<14>,<>,<15>,<>,<16>,<>,<17>,<>,<18>,<>,<19>,<>,<20>,<>,<21>,<>,<22>,<>,<23>,<>,<24>,<>,<25>,<>,<26>,<>,<27>,<>,<28>,<>,<29>,<>,<30>,<>,<31> REP_test:.*-01,<>,.*-02,<>,.*-03,<>,.*-04,<>,.*-05,<>,.*-06,<>,.*-07,<>,.*-08,<>,.*-09,<>,.*-10,<>,.*-11,<>,.*-12,<>,.*-13,<>,.*-14,<>,.*-15,<>,.*-16,<>,.*-17,<>,.*-18,<>,.*-19,<>,.*-20,<>,.*-21,<>,.*-22,<>,.*-23,<>,.*-24,<>,.*-25,<>,.*-26,<>,.*-27,<>,.*-28,<>,.*-29,<>,.*-30,<>,.*-31 \
Tageserzeugung:.*-01,<>,.*-02,<>,.*-03,<>,.*-04,<>,.*-05,<>,.*-06,<>,.*-07,<>,.*-08,<>,.*-09,<>,.*-10,<>,.*-11,<>,.*-12,<>,.*-13,<>,.*-14,<>,.*-15,<>,.*-16,<>,.*-17,<>,.*-18,<>,.*-19,<>,.*-20,<>,.*-21,<>,.*-22,<>,.*-23,<>,.*-24,<>,.*-25,<>,.*-26,<>,.*-27,<>,.*-28,<>,.*-29,<>,.*-30,<>,.*-31 \
Verguetung:.*-01,<>,.*-02,<>,.*-03,<>,.*-04,<>,.*-05,<>,.*-06,<>,.*-07,<>,.*-08,<>,.*-09,<>,.*-10,<>,.*-11,<>,.*-12,<>,.*-13,<>,.*-14,<>,.*-15,<>,.*-16,<>,.*-17,<>,.*-18,<>,.*-19,<>,.*-20,<>,.*-21,<>,.*-22,<>,.*-23,<>,.*-24,<>,.*-25,<>,.*-26,<>,.*-27,<>,.*-28,<>,.*-29,<>,.*-30,<>,.*-31 \
Kosten:.*-01,<>,.*-02,<>,.*-03,<>,.*-04,<>,.*-05,<>,.*-06,<>,.*-07,<>,.*-08,<>,.*-09,<>,.*-10,<>,.*-11,<>,.*-12,<>,.*-13,<>,.*-14,<>,.*-15,<>,.*-16,<>,.*-17,<>,.*-18,<>,.*-19,<>,.*-20,<>,.*-21,<>,.*-22,<>,.*-23,<>,.*-24,<>,.*-25,<>,.*-26,<>,.*-27,<>,.*-28,<>,.*-29,<>,.*-30,<>,.*-31
attr rg_Solar_DBREP cellStyle { "c:0" => 'style="text-align:left;;;;color:green;;;;font-weight:normal"'}
attr rg_Solar_DBREP firstCalcRow 2
attr rg_Solar_DBREP mapping {Bezug => "Bezug (kWh)", Einspeisung => "Einspeisung (kWh)", Tageserzeugung => "Erzeugung (kWh)",\\
Verguetung => "Ertrag (€)", Kosten => "Stromkosten (€)"}
attr rg_Solar_DBREP nameStyle style="text-align:center;;;;color:black;;;;font-weight:bold"
attr rg_Solar_DBREP room _readingsGroup
attr rg_Solar_DBREP valueStyle style="text-align:center"
define DF_KNX10 DOIF (["KNX10:^on$|^off$"] or ["^KNX01.I.*:^on$|^off$"] or ["^KNX31.I.*:^on$|^off$"] or ["^KNX32.I.*:^on$|^off$"])( {taster("$DEVICE","$EVENT")})
attr DF_KNX10 do always
attr DF_KNX10 event-on-change-reading state
attr DF_KNX10 room KNX,_doif
define SVG_logdb_5 SVG logdb:SVG_logdb_5:HISTORY
attr SVG_logdb_5 plotsize 1200,400
attr SVG_logdb_5 room SVG
define DF_setSolarPower DOIF ([+60] and [{sunrise()}-{sunset("1800")}] and [KNX10.I07_Solarzaehler:literpromin:sec] > 70 and [KNX10.I07_Solarzaehler:literpromin:d] != 0)(\
setreading KNX10.I07_Solarzaehler literpromin 0\
)
attr DF_setSolarPower do always
attr DF_setSolarPower room Solar,_doif
define DF_isoft_Watchdog DOIF ([KNX02.O07_Stromwert:getG1] == 0)\
	(\
	set KNX02.O07_Aktor_isoft_EMEM on,\
	(set alarmbot message ALARM: iSoft ist Stromlos!)\
	)\
DOELSE
attr DF_isoft_Watchdog do always
attr DF_isoft_Watchdog event-on-change-reading Alle Events deaktiviert
attr DF_isoft_Watchdog repeatcmd 1800
attr DF_isoft_Watchdog room Ueberwachung,Wasser,_doif
attr DF_isoft_Watchdog wait 1800
attr DF_isoft_Watchdog widgetOverride cmdState:textField-long
define DF_UWP_HK_Garage DOIF ([09:00-17:00] and \
[RE_TEMP_Speicher_02:temperature] > 50 and \
[RE_TEMP_Speicher_03:temperature] > 80 and \
[RE_TEMP_Speicher_05:temperature] > 80 and \
[RE_TEMP_Speicher_08:temperature] > 80 and \
[RE_TEMP_Vorlauf_Solar:temperature] > 85)\
(\
	set HMW01.O02_UWP_HK2 on\
)\
DOELSEIF([06:30-08:58] and [RE_TEMP_Speicher_08:temperature] > 70)\
(	set HMW01.O02_UWP_HK2 on )\
\
DOELSEIF([RE_TEMP_Speicher_08:temperature] < 90)\
(	set HMW01.O02_UWP_HK2 off	)
attr DF_UWP_HK_Garage room Heizung_POOL
define DF_Heizschleifenfunktion DOIF ([+300]) (\
	{Heizschleifenbetrieb("[$SELF:status]");;}\
)
attr DF_Heizschleifenfunktion DbLogInclude cmd
attr DF_Heizschleifenfunktion do always
attr DF_Heizschleifenfunktion readingList status
attr DF_Heizschleifenfunktion room Heizung
attr DF_Heizschleifenfunktion selftrigger all
attr DF_Heizschleifenfunktion setList status
attr DF_Heizschleifenfunktion webCmd status
attr DF_Heizschleifenfunktion widgetOverride cmdState:textField-long status:uzsuSelectRadio,voll,uebergang,aus,rumpel,manuell
define DF_calcVLSoll DOIF ([+:15] or [$SELF:value])(\
{\
my $vltemp = calcVL("[$SELF:value]");;\
fhem("set PID.FUBO desired $vltemp");;\
fhem("set PID_HZFHEM desired $vltemp");;\
fhem("setreading DF_calcVLSoll vltemp $vltemp");;\
}\
)
attr DF_calcVLSoll disable 0
attr DF_calcVLSoll do always
attr DF_calcVLSoll readingList value
attr DF_calcVLSoll room Heizung,_doif
attr DF_calcVLSoll setList value
attr DF_calcVLSoll stateFormat vltemp °C
attr DF_calcVLSoll webCmd value
attr DF_calcVLSoll widgetOverride value:slider,18,0.5,30,1
define DF_UEW_RE_TEMP_VorlaufHK DOIF ([RE_TEMP_VorlaufHK:temperature] > 45) \
(\
set remotebot message DF_UEW_RE_TEMP_VorlaufHK: Vorlauf > 45,\
set Pushover msg DF_UEW_RE_TEMP_VorlaufHK: Vorlauf > 45,\
set DF_controlVL disable,\
set D_HZfhem_Relais1_FUBO_warm 0\
)\
(\
set D_HZfhem_Relais2_FUBO_kalt 270,\
)\
DOELSE\
(\
set DF_controlVL initialize\
)\

attr DF_UEW_RE_TEMP_VorlaufHK room Heizung,Ueberwachung,_doif
attr DF_UEW_RE_TEMP_VorlaufHK wait 0,10:300
define DOIFtools DOIFtools associated DOIF: DFWD_Heizkessel DFWD_PID.FUBO_mischerpos DFWD_apacheOC DF_1500to3000 DF_3000to1500 DF_AnHeizReminder DF_Auswertungen DF_Brunnen DF_BrunnenDEVEL DF_Brunnen_Watchdog DF_FFO_Alarm DF_Gaskessel_Handbetrieb DF_Grenzfuehler DF_HV_Heizbeginn DF_HZG_Ankleide DF_HZG_Bad_Wand_FuBo DF_HZG_Flur_Buero DF_HZG_Rumpel DF_HZG_Schlafzimmer DF_HZG_WoEssKue DF_Heizbetrieb DF_Heizkesselbetrieb DF_Heizschleifenfunktion DF_Heizung_Offset_Boost DF_Jahreszeit DF_KNX10 DF_KNX100.I01_BWM DF_KNX101.I01_BWM_Garage DF_MR DF_RLAtelegram DF_SYSMON DF_Stromueberwachung_Aussen DF_Stromzaehlerauswertung DF_TFK01 DF_UEW_HVTemp_RLA DF_UEW_HVTemp_VL DF_UEW_PID.FUBO DF_UEW_PID.HV_RLA DF_UEW_RE_TEMP_VorlaufHK DF_UEW_SpeicherTemp DF_UEW_logdb DF_UWP_GARAGE DF_UWP_HK_Garage DF_UWP_POOL DF_WAMA DF_WMZ_HZG_main DF_WMZ_Solar DF_WatchOW_RE_TEMP_Ankleide DF_WatchOW_RE_TEMP_Bad DF_WatchOW_RE_TEMP_FlurOG DF_WatchOW_RE_TEMP_HV_RL DF_WatchOW_RE_TEMP_HV_RLA DF_WatchOW_RE_TEMP_HV_VL DF_WatchOW_RE_TEMP_PS3000_01 DF_WatchOW_RE_TEMP_PS3000_02 DF_WatchOW_RE_TEMP_PS3000_03 DF_WatchOW_RE_TEMP_PS3000_04 DF_WatchOW_RE_TEMP_PS3000_05 DF_WatchOW_RE_TEMP_PS3000_06 DF_WatchOW_RE_TEMP_PS3000_07 DF_WatchOW_RE_TEMP_PS3000_08 DF_WatchOW_RE_TEMP_PS3000_09 DF_WatchOW_RE_TEMP_PS3000_10 DF_WatchOW_RE_TEMP_PS3000_11 DF_WatchOW_RE_TEMP_RuecklaufHK DF_WatchOW_RE_TEMP_Ruecklauf_EG_Boden DF_WatchOW_RE_TEMP_Ruecklauf_Kessel DF_WatchOW_RE_TEMP_Ruecklauf_Schwimmbad DF_WatchOW_RE_TEMP_Ruecklauf_Solar DF_WatchOW_RE_TEMP_Ruecklauf_WT_EG DF_WatchOW_RE_TEMP_Ruecklauf_Zirkulation DF_WatchOW_RE_TEMP_Schlafzimmer DF_WatchOW_RE_TEMP_Speicher_01 DF_WatchOW_RE_TEMP_Speicher_02 DF_WatchOW_RE_TEMP_Speicher_03 DF_WatchOW_RE_TEMP_Speicher_04 DF_WatchOW_RE_TEMP_Speicher_05 DF_WatchOW_RE_TEMP_Speicher_06 DF_WatchOW_RE_TEMP_Speicher_07 DF_WatchOW_RE_TEMP_Speicher_08 DF_WatchOW_RE_TEMP_Speicher_09 DF_WatchOW_RE_TEMP_Speicher_10 DF_WatchOW_RE_TEMP_VorlaufHK DF_WatchOW_RE_TEMP_Vorlauf_EG_Boden DF_WatchOW_RE_TEMP_Vorlauf_Kessel DF_WatchOW_RE_TEMP_Vorlauf_Schwimmbad DF_WatchOW_RE_TEMP_Vorlauf_Solar DF_WatchOW_RE_TEMP_Vorlauf_WW DF_WatchOW_RE_TEMP_WW_Ausgang_Speicher DF_WatchOW_RE_TEMP_WoZi DF_WatchStromzaehlerConnected DF_Weihnacht DF_Zaehler_Holzvergaser DF_Zeitplan DF_activateBahnplanTimetable DF_addLogDaily DF_addLogHourly DF_auswertungen DF_calcAllEnergy DF_calcVLSoll DF_changePID DF_choosePID DF_controlVL DF_housekeeping DF_isoft_Watchdog DF_move_heat DF_move_heat_1t3_C1 DF_move_heat_1t3_C2 DF_move_heat_1t3_C3 DF_move_heat_1t3_C4 DF_move_heat_1t3_C5 DF_move_heat_3t1_A1 DF_move_heat_3t1_A2 DF_move_heat_3t1_A3 DF_move_heat_3t1_A4 DF_move_heat_3t1_A5 DF_move_heat_3t1_A6 DF_move_heat_perl DF_mr DF_presence DF_presence3 DF_presenceFB DF_presence_RaumfeldBad DF_presence_SNSG DF_presence_info DF_saveDBCache DF_sendAll DF_sendBahnDelay DF_sendInfoRemotebot DF_setSolarPower DF_stored_heating_Energy DF_stored_shower_Energy DF_test DF_test1 DF_test2 DF_test_Lichtgruppe DF_test_Praesenz DF_verbose DF_watchBCH DF_watchBRT DF_watchBTC DF_watchCrypto DF_watchETH
attr DOIFtools DOIFtoolsEventMonitorInDOIF 1
attr DOIFtools DOIFtoolsExecuteDefinition 1
attr DOIFtools DOIFtoolsExecuteSave 1
attr DOIFtools DOIFtoolsMenuEntry 1
attr DOIFtools DOIFtoolsMyShortcuts ##My Shortcuts:,,list DOIFtools,fhem?cmd=list DOIFtools
attr DOIFtools room _doif
define NadineSbahnFFM_S1_morgens DBPlan 60
attr NadineSbahnFFM_S1_morgens dbplan-station-file /opt/fhem/FHEM/deutschland_bhf.csv
attr NadineSbahnFFM_S1_morgens dbplan_delayed_Journey on
attr NadineSbahnFFM_S1_morgens dbplan_destination Frankfurt Hbf (tief)
attr NadineSbahnFFM_S1_morgens dbplan_journey_prod S-Bahnen
attr NadineSbahnFFM_S1_morgens dbplan_station Frankfurt-Sindlingen
attr NadineSbahnFFM_S1_morgens dbplan_travel_time 08:15
attr NadineSbahnFFM_S1_morgens room x_Bahnplan
attr NadineSbahnFFM_S1_morgens userReadings xFTUI_departure {\
sprintf("[[\"%s\",\"%s\",\"%s\"],[\"%s\",\"%s\",\"%s\"]]",\
	ReadingsVal($name,"travel_vehicle_nr_1",0),\
	ReadingsVal($name,"travel_destination_1",0),\
	ReadingsVal($name,"plan_departure_1",0),\
	ReadingsVal($name,"travel_vehicle_nr_2",0),\
	ReadingsVal($name,"travel_destination_2",0),\
	ReadingsVal($name,"plan_departure_2",0),\
\
)}
define NadineSbahnFFM_S2_abends DBPlan 60
attr NadineSbahnFFM_S2_abends dbplan-station-file /opt/fhem/FHEM/deutschland_bhf.csv
attr NadineSbahnFFM_S2_abends dbplan_delayed_Journey on
attr NadineSbahnFFM_S2_abends dbplan_destination Frankfurt-Zeilsheim
attr NadineSbahnFFM_S2_abends dbplan_journey_prod S-Bahnen
attr NadineSbahnFFM_S2_abends dbplan_max_Journeys 1
attr NadineSbahnFFM_S2_abends dbplan_station Frankfurt Hbf (tief)
attr NadineSbahnFFM_S2_abends dbplan_travel_time 18.05
attr NadineSbahnFFM_S2_abends event-on-update-reading plan_departure_delay_1,plan_departure_1
attr NadineSbahnFFM_S2_abends room x_Bahnplan
define DF_sendBahnDelay DOIF ([08:15-08:35|Mo Di Mi Do Fr] and [NadineSbahnFFM_S1_morgens:plan_departure_delay_1] ne "none" and [NadineSbahnFFM_S1_morgens:plan_departure_delay_1] > 1  and [NadineSbahnFFM_S1_morgens:plan_departure_1] eq "08:32") \
(set nadinebot message "Bahn [NadineSbahnFFM_S1_morgens:travel_vehicle_nr_1], Abfahrt ist [NadineSbahnFFM_S1_morgens:plan_departure_1], ist um [NadineSbahnFFM_S1_morgens:plan_departure_delay_1] Minuten verspätet.")\
DOELSEIF ([17:50-18:15|Mo Di Mi Do] and [NadineSbahnFFM_S2_abends:plan_departure_delay_1] ne "none" and [NadineSbahnFFM_S2_abends:plan_departure_delay_1] > 1 and [NadineSbahnFFM_S2_abends:plan_departure_1] eq "18:07") \
(set nadinebot message "Bahn [NadineSbahnFFM_S2_abends:travel_vehicle_nr_1], Abfahrt ist [NadineSbahnFFM_S2_abends:plan_departure_1], ist um [NadineSbahnFFM_S2_abends:plan_departure_delay_1] Minuten verspätet")\
DOELSEIF ([12:50-13:17|Fr] and [NadineSbahnFFM_S1_freitagmittag:plan_departure_delay_1] ne "none" and [NadineSbahnFFM_S1_freitagmittag:plan_departure_delay_1] > 1 and [NadineSbahnFFM_S1_freitagmittag:plan_departure_1] eq "13:12")\
(set nadinebot message "Bahn [NadineSbahnFFM_S1_freitagmittag:travel_vehicle_nr_1], Abfahrt ist [NadineSbahnFFM_S1_freitagmittag:plan_departure_1], ist um [NadineSbahnFFM_S1_freitagmittag:plan_departure_delay_1] Minuten verspätet")
attr DF_sendBahnDelay do always
attr DF_sendBahnDelay room _doif,x_Bahnplan
define DF_UEW_SpeicherTemp DOIF ([RE_TEMP_Speicher09:temperature] > 70 ) \
({\
my $log_name = "DF_UEW_SpeicherTemp";;\
my @temps=getResTemps();;\
my $gesEne = 0;;\
	foreach (@temps) {\
		my $temp = $_;;\
		fhem("set remotebot message ")\
		my $deltat = $_ - 25;;\
		my $Ene = int(10*($deltat * 1.16 * 150 /1000))/10;;\
		$gesEne += $Ene;;\
		##$message .= "\n" . $_ . "-" . $VLSoll . "=" . $deltat . "+" . $Ene . "kWh";;\
	\
	}\
my $leftEne = 104 - $gesEne;;\
	log_telegram("4",$log_name,"vorhandene Energie: $gesEne\n verbleibender Platz: $leftEne","remotebot");;\
})
attr DF_UEW_SpeicherTemp do always
attr DF_UEW_SpeicherTemp room Heizung,Ueberwachung,_doif
define NadineSbahnFFM_S2_freitagmittag DBPlan 60
attr NadineSbahnFFM_S2_freitagmittag dbplan-station-file /opt/fhem/FHEM/deutschland_bhf.csv
attr NadineSbahnFFM_S2_freitagmittag dbplan_delayed_Journey on
attr NadineSbahnFFM_S2_freitagmittag dbplan_destination Frankfurt-Zeilsheim
attr NadineSbahnFFM_S2_freitagmittag dbplan_journey_prod S-Bahnen
attr NadineSbahnFFM_S2_freitagmittag dbplan_max_Journeys 1
attr NadineSbahnFFM_S2_freitagmittag dbplan_station Frankfurt Hbf (tief)
attr NadineSbahnFFM_S2_freitagmittag dbplan_travel_time 13.05
attr NadineSbahnFFM_S2_freitagmittag event-on-update-reading plan_departure_delay_1,plan_departure_1
attr NadineSbahnFFM_S2_freitagmittag room x_Bahnplan
define NadineSbahnFFM_S1_freitagmittag DBPlan 60
attr NadineSbahnFFM_S1_freitagmittag dbplan-station-file /opt/fhem/FHEM/deutschland_bhf.csv
attr NadineSbahnFFM_S1_freitagmittag dbplan_delayed_Journey on
attr NadineSbahnFFM_S1_freitagmittag dbplan_destination Frankfurt-Sindlingen
attr NadineSbahnFFM_S1_freitagmittag dbplan_journey_prod S-Bahnen
attr NadineSbahnFFM_S1_freitagmittag dbplan_station Frankfurt Hbf (tief)
attr NadineSbahnFFM_S1_freitagmittag dbplan_travel_time 13.00
attr NadineSbahnFFM_S1_freitagmittag event-on-update-reading plan_departure_delay_1,plan_departure_1
attr NadineSbahnFFM_S1_freitagmittag room x_Bahnplan
define DFWD_Heizkessel DOIF (([RE_TEMP_Vorlauf_Kessel] or [RE_TEMP_Ruecklauf_Kessel]) and [HMW02.O04_9k4:zustand] eq "on") ({\
my $log_name = "DFWD_Heizkessel";;\
my $VL = ReadingsNum("RE_TEMP_Vorlauf_Kessel","temperature",0);;\
my $RL = ReadingsNum("RE_TEMP_Ruecklauf_Kessel","temperature",0);;\
my $spreizung = $VL-$RL;;\
my $pwr = $spreizung*1.16*0.238*3600;;\
my $message .= "Vorlauf $VL °C\n";;\
$message .= "Ruecklauf $RL °C\n";;\
$message .= "Spreizung $spreizung °C\n";;\
$message .= "abgefuehrte Leistung: $pwr\n";;\
log_telegram("1",$log_name,"$message","remotebot");;\
})
attr DFWD_Heizkessel do always
attr DFWD_Heizkessel event-on-change-reading cmd
attr DFWD_Heizkessel room Heizung,_doif
define DF_presence_SNSG DOIF ([p_SNSG:state] eq "present")\
(\
	set remotebot message "SNSG ist present, schalte Tonstrom ein",\
	set KNX32.O05_Aktor_Tonstrom_WoEss on\
)
attr DF_presence_SNSG do always
attr DF_presence_SNSG room _doif,presence
define DF_UWP_GARAGE DOIF ([09:00-16:00] and [+300])\
(\
	{UWP_GARAGE();;}\
)
attr DF_UWP_GARAGE disable 1
attr DF_UWP_GARAGE room Heizung_POOL
attr DF_UWP_GARAGE wait 0:0,1200
attr DF_UWP_GARAGE widgetOverride cmdState:textField-long
define tempOWarduino dummy
attr tempOWarduino room OW_Remote,_dummy
define RE_TEMP_TEST dummy
attr RE_TEMP_TEST DbLogInclude temperature
attr RE_TEMP_TEST group Thermometer
attr RE_TEMP_TEST room _dummy,x_devel
define RE_TEMP_TEST2 dummy
attr RE_TEMP_TEST2 DbLogInclude temperature
attr RE_TEMP_TEST2 group Thermometer
attr RE_TEMP_TEST2 room _dummy,x_devel
define RE_TEMP_TEST1 dummy
attr RE_TEMP_TEST1 DbLogInclude temperature
attr RE_TEMP_TEST1 group Thermometer
attr RE_TEMP_TEST1 room _dummy,x_devel
attr RE_TEMP_TEST1 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
define N_tempOWarduino notify tempOWarduino:.* {OWtemp($EVENT,"1")}
attr N_tempOWarduino room OW_Remote,_notify
define SVG_Solartemperaturen SVG logdb:SVG_Solartemperaturen:HISTORY
attr SVG_Solartemperaturen endPlotToday 1
attr SVG_Solartemperaturen plotsize 1500,600
attr SVG_Solartemperaturen room SVG,Solar
define DF_presence_RaumfeldBad DOIF ([p_Raumfeld_Bad:state] eq "present")\
(\
	set remotebot message "RF_Bad ist present, schalte Tonstrom ein",\
	set KNX32.O05_Aktor_Tonstrom_WoEss on\
)
attr DF_presence_RaumfeldBad do always
attr DF_presence_RaumfeldBad room _doif,presence
define DF_presence_info DOIF ([":^presence"])\
(\
	set remotebot message "Device $DEVICE Events $EVENTS"\
)\

attr DF_presence_info do always
attr DF_presence_info event-on-change-reading cmd
attr DF_presence_info room _doif,presence
define nadinebot TelegramBot
attr nadinebot cmdRestrictedPeer 157487574
attr nadinebot defaultPeer 157487574
attr nadinebot pollingTimeout 30
attr nadinebot room Telegram_BOT
define rmssbot TelegramBot
attr rmssbot defaultPeer 137545657
attr rmssbot pollingTimeout 30
attr rmssbot room Telegram_BOT
define KNX31.O01_Aktor_Leuchte_Esszimmer_Decke KNX 1/1/0:dpt1 tul
attr KNX31.O01_Aktor_Leuchte_Esszimmer_Decke IODev tul
attr KNX31.O01_Aktor_Leuchte_Esszimmer_Decke devStateIcon on::off off::on
attr KNX31.O01_Aktor_Leuchte_Esszimmer_Decke room KNX
define KNX31.O01_Status KNX 1/1/1:dpt1 tul
attr KNX31.O01_Status IODev tul
attr KNX31.O01_Status readonly 1
attr KNX31.O01_Status room KNX
define KNX31.O02_Aktor_Leuchte_Buero_Decke KNX 1/1/2:dpt1 tul
attr KNX31.O02_Aktor_Leuchte_Buero_Decke IODev tul
attr KNX31.O02_Aktor_Leuchte_Buero_Decke devStateIcon on::off off::on
attr KNX31.O02_Aktor_Leuchte_Buero_Decke room KNX
define KNX31.O02_Status KNX 1/1/3:dpt1 tul
attr KNX31.O02_Status IODev tul
attr KNX31.O02_Status readonly 1
attr KNX31.O02_Status room KNX
define KNX31.O03_Aktor KNX 1/1/4:dpt1 tul
attr KNX31.O03_Aktor IODev tul
attr KNX31.O03_Aktor devStateIcon on::off off::on
attr KNX31.O03_Aktor room KNX
define KNX31.O03_Status KNX 1/1/5:dpt1 tul
attr KNX31.O03_Status IODev tul
attr KNX31.O03_Status readonly 1
attr KNX31.O03_Status room KNX
define KNX31.O04_Aktor_Leuchte_Wohnzimmer_Decke KNX 1/1/6:dpt1 tul
attr KNX31.O04_Aktor_Leuchte_Wohnzimmer_Decke IODev tul
attr KNX31.O04_Aktor_Leuchte_Wohnzimmer_Decke devStateIcon on::off off::on
attr KNX31.O04_Aktor_Leuchte_Wohnzimmer_Decke room KNX
define KNX31.O04_Status KNX 1/1/7:dpt1 tul
attr KNX31.O04_Status IODev tul
attr KNX31.O04_Status readonly 1
attr KNX31.O04_Status room KNX
define KNX31.O05_Aktor_Leuchte_Wegelicht_Decke KNX 1/1/8:dpt1 tul
attr KNX31.O05_Aktor_Leuchte_Wegelicht_Decke IODev tul
attr KNX31.O05_Aktor_Leuchte_Wegelicht_Decke devStateIcon on::off off::on
attr KNX31.O05_Aktor_Leuchte_Wegelicht_Decke room KNX
define KNX31.O05_Status KNX 1/1/9:dpt1 tul
attr KNX31.O05_Status IODev tul
attr KNX31.O05_Status readonly 1
attr KNX31.O05_Status room KNX
define KNX31.O06_Aktor_Leuchte_Kueche_Decke KNX 1/1/10:dpt1 tul
attr KNX31.O06_Aktor_Leuchte_Kueche_Decke IODev tul
attr KNX31.O06_Aktor_Leuchte_Kueche_Decke devStateIcon on::off off::on
attr KNX31.O06_Aktor_Leuchte_Kueche_Decke room KNX
define KNX31.O06_Status KNX 1/1/11:dpt1 tul
attr KNX31.O06_Status IODev tul
attr KNX31.O06_Status readonly 1
attr KNX31.O06_Status room KNX
define KNX31.O07_Aktor_Leuchte_Dusche_Decke KNX 1/1/12:dpt1 tul
attr KNX31.O07_Aktor_Leuchte_Dusche_Decke IODev tul
attr KNX31.O07_Aktor_Leuchte_Dusche_Decke devStateIcon on::off off::on
attr KNX31.O07_Aktor_Leuchte_Dusche_Decke room KNX
define KNX31.O07_Status KNX 1/1/13:dpt1 tul
attr KNX31.O07_Status IODev tul
attr KNX31.O07_Status readonly 1
attr KNX31.O07_Status room KNX
define KNX31.O08_Aktor_Leuchte_Bad_gross KNX 1/1/14:dpt1 tul
attr KNX31.O08_Aktor_Leuchte_Bad_gross IODev tul
attr KNX31.O08_Aktor_Leuchte_Bad_gross devStateIcon on::off off::on
attr KNX31.O08_Aktor_Leuchte_Bad_gross room KNX
define KNX31.O08_Status KNX 1/1/15:dpt1 tul
attr KNX31.O08_Status IODev tul
attr KNX31.O08_Status readonly 1
attr KNX31.O08_Status room KNX
define KNX31.I01_Taster_Tuer_Schlafzimmer_Ankleide KNX 1/1/16:dpt1 tul
attr KNX31.I01_Taster_Tuer_Schlafzimmer_Ankleide IODev tul
attr KNX31.I01_Taster_Tuer_Schlafzimmer_Ankleide room KNX
define KNX31.I02_Taster_Tuer_Ankleide_Schlafzimmer KNX 1/1/17:dpt1 tul
attr KNX31.I02_Taster_Tuer_Ankleide_Schlafzimmer IODev tul
attr KNX31.I02_Taster_Tuer_Ankleide_Schlafzimmer room KNX
define KNX31.I03_Taster_Haustuere KNX 1/1/18:dpt1 tul
attr KNX31.I03_Taster_Haustuere IODev tul
attr KNX31.I03_Taster_Haustuere room KNX
define KNX31.I04_Taster_Tuer_Ankleide_Flur KNX 1/1/19:dpt1 tul
attr KNX31.I04_Taster_Tuer_Ankleide_Flur IODev tul
attr KNX31.I04_Taster_Tuer_Ankleide_Flur room KNX
define KNX31.I05_Taster_Tuer_Flur_Badezimmer KNX 1/1/20:dpt1 tul
attr KNX31.I05_Taster_Tuer_Flur_Badezimmer IODev tul
attr KNX31.I05_Taster_Tuer_Flur_Badezimmer room KNX
define KNX31.I06_Taster_Tuer_Flur_Ankleide KNX 1/1/21:dpt1 tul
attr KNX31.I06_Taster_Tuer_Flur_Ankleide IODev tul
attr KNX31.I06_Taster_Tuer_Flur_Ankleide room KNX
define KNX31.I07_Taster_FME_ALARM KNX 1/1/22:dpt1 tul
attr KNX31.I07_Taster_FME_ALARM IODev tul
attr KNX31.I07_Taster_FME_ALARM room KNX
define KNX31.I08_Taster_Hzg_Garage KNX 1/1/23:dpt1 tul
attr KNX31.I08_Taster_Hzg_Garage IODev tul
attr KNX31.I08_Taster_Hzg_Garage room KNX
define D_sendHZfhem dummy
attr D_sendHZfhem room _dummy
define LOGhzfhem notify HMW.* {fhem("setreading D_sendHZfhem $NAME $EVENT")}
attr LOGhzfhem room System,_notify
define RE_TEMP_HV_VL dummy
attr RE_TEMP_HV_VL DbLogInclude temperature
attr RE_TEMP_HV_VL group Thermometer
attr RE_TEMP_HV_VL room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_VL stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_HV_RL dummy
attr RE_TEMP_HV_RL DbLogInclude temperature
attr RE_TEMP_HV_RL event-on-update-reading temperature
attr RE_TEMP_HV_RL group Thermometer
attr RE_TEMP_HV_RL room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_RL stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_HV_RLA dummy
attr RE_TEMP_HV_RLA DbLogInclude temperature
attr RE_TEMP_HV_RLA event-on-update-reading temperature
attr RE_TEMP_HV_RLA group Thermometer
attr RE_TEMP_HV_RLA room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_RLA stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_01 dummy
attr RE_TEMP_PS3000_01 DbLogInclude temperature
attr RE_TEMP_PS3000_01 group Thermometer
attr RE_TEMP_PS3000_01 room Heizung,Heizung_Puffer,OW_Remote,_dummy,Heizung_Puffer
attr RE_TEMP_PS3000_01 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_02 dummy
attr RE_TEMP_PS3000_02 DbLogInclude temperature
attr RE_TEMP_PS3000_02 group Thermometer
attr RE_TEMP_PS3000_02 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_02 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_03 dummy
attr RE_TEMP_PS3000_03 DbLogInclude temperature
attr RE_TEMP_PS3000_03 group Thermometer
attr RE_TEMP_PS3000_03 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_03 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_04 dummy
attr RE_TEMP_PS3000_04 DbLogInclude temperature
attr RE_TEMP_PS3000_04 group Thermometer
attr RE_TEMP_PS3000_04 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_04 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_05 dummy
attr RE_TEMP_PS3000_05 DbLogInclude temperature
attr RE_TEMP_PS3000_05 group Thermometer
attr RE_TEMP_PS3000_05 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_05 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_06 dummy
attr RE_TEMP_PS3000_06 DbLogInclude temperature
attr RE_TEMP_PS3000_06 group Thermometer
attr RE_TEMP_PS3000_06 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_06 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_07 dummy
attr RE_TEMP_PS3000_07 DbLogInclude temperature
attr RE_TEMP_PS3000_07 group Thermometer
attr RE_TEMP_PS3000_07 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_07 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_08 dummy
attr RE_TEMP_PS3000_08 DbLogInclude temperature
attr RE_TEMP_PS3000_08 group Thermometer
attr RE_TEMP_PS3000_08 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_08 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_09 dummy
attr RE_TEMP_PS3000_09 DbLogInclude temperature
attr RE_TEMP_PS3000_09 group Thermometer
attr RE_TEMP_PS3000_09 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_09 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_10 dummy
attr RE_TEMP_PS3000_10 DbLogInclude temperature
attr RE_TEMP_PS3000_10 group Thermometer
attr RE_TEMP_PS3000_10 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_10 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_PS3000_11 dummy
attr RE_TEMP_PS3000_11 DbLogInclude temperature
attr RE_TEMP_PS3000_11 group Thermometer
attr RE_TEMP_PS3000_11 room OW_Remote,_dummy,Heizung,Heizung_Puffer
attr RE_TEMP_PS3000_11 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define SVG_PS3000_Detail SVG logdb:SVG_PS3000_Detail:HISTORY
attr SVG_PS3000_Detail plotsize 1400,600
attr SVG_PS3000_Detail room SVG,SVG_Heizung,SVG_Holzvergaser
define DF_AnHeizReminder DOIF (([18:00|01234] && [DF_stored_shower_Energy:timeleft] < 12)||([18:00|56] && [DF_stored_shower_Energy:timeleft] < 15))\
( set alarmbot message anheizen!!! )\
DOELSE\

attr DF_AnHeizReminder room Heizung,HolzVergaser,_doif
attr DF_AnHeizReminder widgetOverride cmdState:textField-long
define SVG_HV_RLA SVG logdb:SVG_HV_RLA:HISTORY
attr SVG_HV_RLA captionPos auto
attr SVG_HV_RLA nrAxis 1,2
attr SVG_HV_RLA plotsize 1400,600
attr SVG_HV_RLA room SVG,SVG_Holzvergaser
define DF_UEW_PID.HV_RLA DOIF ([PID.HV_RLA])(set remotebot message PID.HV_RLA liefert seit [PID.HV_RLA:actuation:sec] Sekunden keine Events mehr)
attr DF_UEW_PID.HV_RLA disable 1
attr DF_UEW_PID.HV_RLA do resetwait
attr DF_UEW_PID.HV_RLA repeatcmd 60
attr DF_UEW_PID.HV_RLA room Heizung,Ueberwachung,_doif
attr DF_UEW_PID.HV_RLA wait 70
define DF_test DOIF ([D_test] =~ /^ok_.*/)\
(set remotebot message "alles klar")
attr DF_test DOIF_Readings showtemp:ReadingsVal([$SELF:sensorselect],"temperature","nix" )
attr DF_test do always
attr DF_test room x_devel
attr DF_test uiTable {\
 $TPL{style2}="	text-align:right;;\
 				width:23px;;\
				position:absolute;;\
				left:13px;;\
				top:26px;;\
				font-weight:bold;;\
				font-size:12px;;\
				color:";;\
 $TPL{knob2}="	knob,\
 				thickness:.3,\
				fgColor:#FFA500,\
				min:7,\
				max:30,\
				width:50,\
				height:50,\
				step:.5,\
				angleArc:270,\
				angleOffset:225,\
				displayInput:false";;\
\
 $TD{0}{0}=" colspan=2 ";;\
  sub FUNC_batt {\
    my($val)=@_;;\
    my $ret="position:absolute;;left:0px;;width:25px;;height:100px;;background:linear-gradient( to bottom,#F8F8E0 ".(100-$val)."px,rgba(0,0,0,0) ".(100-$val)."px);;";;\
    return $ret;;\
  }\
  sub FUNC_batt2 {\
    my($val)=@_;;\
    my $ret="position:absolute;;left:9px;;top:6px;;width:14px;;height:27px;;background:linear-gradient( to bottom,#F8F8E0 ".(100-$val)."%,rgba(0,0,0,0) ".(100-$val)."%);;";;\
    return $ret;;\
  }\
}\
WID([HMsensor_Labor],"uzsuSelectRadio,enable,disable")\
\
"<div style='border-width:2px;;border-style:solid;;border-color:gray;;position:relative;;width:25px;;height:100px;;background:linear-gradient( to top, red 0px,yellow 50px,green 100px);;'>".STY(" ",FUNC_batt([HMdummy_Labor:level])).STY([HMdummy_Labor:level]."%","font-size:9px;;position:absolute;;top:45px;;right:1px")."</div>"|\
"<div style='position:relative'>\
<div style='position:absolute;;left:9px;;top:6px;;width:14px;;height:27px;;background:linear-gradient( to top, red 0%,yellow 50%,green 100%);;'></div>\
".STY(" ",FUNC_batt2([HMdummy_Labor:level])).STY([HMdummy_Labor:level]."%","font-size:6px;;position:absolute;;top:15px;;left:10px").STY(FW_makeImage("measure_battery_0"))."</div>"\
"<div style='position:relative;;width:50px;;height:50px'><div style='position:absolute;;left:0px;;top:0px'>".WID([HMdummy_Labor:measured-temp],$TPL{knob1})."</div><div style='position:absolute;;left:0px;;top:0px'>".WID([HMdummy_Labor:desired-temp],$TPL{knob2},"set")."</div>".STY([HMdummy_Labor:measured-temp:d1],$TPL{style2}.DOIF_hsv([HMdummy_Labor:measured-temp],7,25,240,360,100,100)).STY([HMdummy_Labor:desired-temp:d1],$TPL{style3}.DOIF_hsv([HMdummy_Labor:desired-temp],7,25,240,360,100,100))."</div>"

define DF_WatchOW_RE_TEMP_PS3000_01 DOIF (["RE_TEMP_PS3000_01:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_01 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_01 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_01 group OW
attr DF_WatchOW_RE_TEMP_PS3000_01 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_01 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_01 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_01 wait 75


define DF_WatchOW_RE_TEMP_PS3000_02 DOIF (["RE_TEMP_PS3000_02:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_02 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_02 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_02 group OW
attr DF_WatchOW_RE_TEMP_PS3000_02 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_02 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_02 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_02 wait 75



define DF_WatchOW_RE_TEMP_PS3000_03 DOIF (["RE_TEMP_PS3000_03:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_03 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_03 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_03 group OW
attr DF_WatchOW_RE_TEMP_PS3000_03 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_03 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_03 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_03 wait 75



define DF_WatchOW_RE_TEMP_PS3000_04 DOIF (["RE_TEMP_PS3000_04:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_04 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_04 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_04 group OW
attr DF_WatchOW_RE_TEMP_PS3000_04 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_04 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_04 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_04 wait 75


define DF_WatchOW_RE_TEMP_PS3000_05 DOIF (["RE_TEMP_PS3000_05:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_05 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_05 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_05 group OW
attr DF_WatchOW_RE_TEMP_PS3000_05 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_05 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_05 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_05 wait 75


define DF_WatchOW_RE_TEMP_PS3000_06 DOIF (["RE_TEMP_PS3000_06:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_06 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_06 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_06 group OW
attr DF_WatchOW_RE_TEMP_PS3000_06 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_06 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_06 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_06 wait 75


define DF_WatchOW_RE_TEMP_PS3000_07 DOIF (["RE_TEMP_PS3000_07:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_07 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_07 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_07 group OW
attr DF_WatchOW_RE_TEMP_PS3000_07 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_07 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_07 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_07 wait 75


define DF_WatchOW_RE_TEMP_PS3000_08 DOIF (["RE_TEMP_PS3000_08:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_08 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_08 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_08 group OW
attr DF_WatchOW_RE_TEMP_PS3000_08 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_08 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_08 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_08 wait 75


define DF_WatchOW_RE_TEMP_PS3000_09 DOIF (["RE_TEMP_PS3000_09:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_09 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_09 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_09 group OW
attr DF_WatchOW_RE_TEMP_PS3000_09 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_09 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_09 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_09 wait 75


define DF_WatchOW_RE_TEMP_PS3000_10 DOIF (["RE_TEMP_PS3000_10:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_10 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_10 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_10 group OW
attr DF_WatchOW_RE_TEMP_PS3000_10 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_10 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_10 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_10 wait 75


define DF_WatchOW_RE_TEMP_PS3000_11 DOIF (["RE_TEMP_PS3000_11:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_PS3000_11 do resetwait
attr DF_WatchOW_RE_TEMP_PS3000_11 event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_PS3000_11 group OW
attr DF_WatchOW_RE_TEMP_PS3000_11 repeatcmd 30
attr DF_WatchOW_RE_TEMP_PS3000_11 room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_PS3000_11 stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_PS3000_11 wait 75


define DF_WatchOW_RE_TEMP_HV_RL DOIF (["RE_TEMP_HV_RL:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_HV_RL do resetwait
attr DF_WatchOW_RE_TEMP_HV_RL event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_HV_RL group OW
attr DF_WatchOW_RE_TEMP_HV_RL repeatcmd 30
attr DF_WatchOW_RE_TEMP_HV_RL room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_HV_RL stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_HV_RL wait 75

define DF_WatchOW_RE_TEMP_HV_RLA DOIF (["RE_TEMP_HV_RLA:temperature"]) (\
set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)\
(\
set alarmbot message ALARM Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!\
)
attr DF_WatchOW_RE_TEMP_HV_RLA do resetwait
attr DF_WatchOW_RE_TEMP_HV_RLA event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_HV_RLA group OW
attr DF_WatchOW_RE_TEMP_HV_RLA repeatcmd 30
attr DF_WatchOW_RE_TEMP_HV_RLA room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_HV_RLA stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_HV_RLA wait 75

define DF_WatchOW_RE_TEMP_HV_VL DOIF (["RE_TEMP_HV_VL:temperature"]) (set remotebot message Letzter Messwert von $DEVICE: [$DEVICE:temperature] vor  [$DEVICE:temperature:sec] Sekunden!)
attr DF_WatchOW_RE_TEMP_HV_VL do resetwait
attr DF_WatchOW_RE_TEMP_HV_VL event-on-change-reading cmd
attr DF_WatchOW_RE_TEMP_HV_VL group OW
attr DF_WatchOW_RE_TEMP_HV_VL repeatcmd 30
attr DF_WatchOW_RE_TEMP_HV_VL room Ueberwachung,_doif
attr DF_WatchOW_RE_TEMP_HV_VL stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}
attr DF_WatchOW_RE_TEMP_HV_VL wait 75

define RE_TEMP_AUSSEN dummy
attr RE_TEMP_AUSSEN DbLogInclude temperature
attr RE_TEMP_AUSSEN event-on-update-reading temperature,AVG
attr RE_TEMP_AUSSEN group ERR_Bad,Thermometer
attr RE_TEMP_AUSSEN room Heizung_ERR,OW_Remote
attr RE_TEMP_AUSSEN stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}
attr RE_TEMP_AUSSEN userReadings AVG {SQLselectAVG("oneday", "current_day_end", "VALUE","RE_TEMP_AUSSEN", "temperature","funktion");; }
define DF_controlVL DOIF ([PID.FUBO:actuation])({\
controlVL();;\
})\

attr DF_controlVL do always
attr DF_controlVL event-on-change-reading cmd
attr DF_controlVL room Heizung,_doif
define N_backupCFG notify global:SAVE {\
my $now = strftime "%Y%m%d%H%M%S",localtime();;\
system("cp $attr{global}{configfile} ./backup-cfg/fhem.cfg.$now");;\
system("cp $attr{global}{statefile} ./backup-cfg/fhem.state.$now");;\
}
attr N_backupCFG room System,_notify
define N_backupMyUtils notify global:FILEWRITE.* {\
use File::Basename;;\
my $now = strftime "%Y%m%d%H%M%S",localtime();;\
my $file = fileparse($EVTPART1);;\
fhem("set remotebot message sichere $file");;\
system("cp $EVTPART1 ./backup-cfg/$file.$now");;\
}
attr N_backupMyUtils room System,_notify
define D_HZfhem_Relais1_FUBO_warm dummy
attr D_HZfhem_Relais1_FUBO_warm room _dummy,Heizung
define D_HZfhem_Relais2_FUBO_kalt dummy
attr D_HZfhem_Relais2_FUBO_kalt room _dummy,Heizung
define BTC_HTTPMOD HTTPMOD https://www.bitcoin.de/de/btceur/market 600
attr BTC_HTTPMOD userattr reading01Name reading01Regex reading02Name reading02Regex reading03Name reading03Regex
attr BTC_HTTPMOD reading01Name ticker_price
attr BTC_HTTPMOD reading01Regex id="ticker_price">(.*)<
attr BTC_HTTPMOD reading02Name rate_buy
attr BTC_HTTPMOD reading02Regex id="rate_buy" data-rate="(.*)">
attr BTC_HTTPMOD reading03Name rate_sell
attr BTC_HTTPMOD reading03Regex id="rate_sell" data-rate="(.*)">
attr BTC_HTTPMOD room crypto
attr BTC_HTTPMOD stateFormat ticker_price
attr BTC_HTTPMOD userReadings rate:ticker_price.* {my $v = ReadingsVal($name,"ticker_price",0);; $v =~ s/\.//g;; $v =~ s/,/./;; $v},\
buy:rate_buy.* {my $v = ReadingsVal($name,"rate_buy",0);; $v =~ s/\,//g;; $v},\
sell:rate_sell.* {my $v = ReadingsVal($name,"rate_sell",0);; $v =~ s/\,//g;; $v}
attr BTC_HTTPMOD verbose 2
define DF_watchBTC DOIF ([BTC_HTTPMOD:sell:d] < 10000 || [08:00])\
(\
set alarmbot message Achtung Bitcoins [BTC_HTTPMOD:rate]\nSELL:[BTC_HTTPMOD:sell]\
)
attr DF_watchBTC do always
attr DF_watchBTC room _doif,crypto
define BCH_HTTPMOD HTTPMOD https://www.bitcoin.de/de/bcheur/market 600
attr BCH_HTTPMOD userattr reading01Name reading01Regex reading02Name reading02Regex reading03Name reading03Regex readingFormat
attr BCH_HTTPMOD reading01Name ticker_price
attr BCH_HTTPMOD reading01Regex id="ticker_price">(.*)<
attr BCH_HTTPMOD reading02Name rate_buy
attr BCH_HTTPMOD reading02Regex id="rate_buy" data-rate="(.*)">
attr BCH_HTTPMOD reading03Name rate_sell
attr BCH_HTTPMOD reading03Regex id="rate_sell" data-rate="(.*)">
attr BCH_HTTPMOD room crypto
attr BCH_HTTPMOD stateFormat ticker_price
attr BCH_HTTPMOD userReadings rate:ticker_price.* {my $v = ReadingsVal($name,"ticker_price",0);; $v =~ s/\.//g;; $v =~ s/,/./;; $v},\
buy:rate_buy.* {my $v = ReadingsVal($name,"rate_buy",0);; $v =~ s/\,//g;; $v},\
sell:rate_sell.* {my $v = ReadingsVal($name,"rate_sell",0);; $v =~ s/\,//g;; $v}
attr BCH_HTTPMOD verbose 2
define DF_watchBCH DOIF ([BCH_HTTPMOD:sell] < 2000 || [:00])\
(\
set alarmbot message Achtung BCH [BCH_HTTPMOD:rate]\nSELL:[BCH_HTTPMOD:sell]\
)\

attr DF_watchBCH do always
attr DF_watchBCH room _doif,crypto
define DF_RLAtelegram DOIF ([+60] && [RE_TEMP_BRT:temperature] > 100 && [RE_TEMP_HV_RLA:temperature] > 40 )\
(\
{\
my $message;;\
$message .= "RLA: [RE_TEMP_HV_RLA2:temperature]°C ";;\
$message .= "VL: [RE_TEMP_HV_VL2:temperature]°C\n";;\
$message .= "PWR: [KNX10.I05_Zaehler_Holzvergaser:power]\n";;\
$message .= "Timestamp: ";;\
$message .= ReadingsTimestamp("KNX10.I05_Zaehler_Holzvergaser","power",0);;\
\
fhem("set remotebot message $message");;\
\
})
attr DF_RLAtelegram do always
attr DF_RLAtelegram event-on-change-reading cmd
attr DF_RLAtelegram room HolzVergaser,Telegram_BOT,_doif
define DF_Zaehler_Holzvergaser DOIF ([KNX10.I05_Zaehler_Holzvergaser:getG1])(\
setreading KNX10.I05_Zaehler_Holzvergaser a 0,\
setreading KNX10.I05_Zaehler_Holzvergaser b 0,\
setreading KNX10.I05_Zaehler_Holzvergaser literpromin 0,\
setreading KNX10.I05_Zaehler_Holzvergaser power 0\
)
attr DF_Zaehler_Holzvergaser do resetwait
attr DF_Zaehler_Holzvergaser event-on-change-reading cmd
attr DF_Zaehler_Holzvergaser room Ueberwachung
attr DF_Zaehler_Holzvergaser stateFormat {sprintf("%s - %s",ReadingsVal($name,"state",0),ReadingsTimestamp($name,"state",0))}\

attr DF_Zaehler_Holzvergaser wait 300
define hvfhemTOfhem FHEM2FHEM 192.168.0.31 LOG:D_BRT|D_AGT|OW_HV_.*
attr hvfhemTOfhem room FHEM2FHEM
define RE_TEMP_BRT dummy
attr RE_TEMP_BRT DbLogInclude temperature
attr RE_TEMP_BRT group Thermometer
attr RE_TEMP_BRT room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_BRT stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define N_HVfhem_BRT notify D_BRT:temperature.* setreading RE_TEMP_BRT temperature $EVTPART1
attr N_HVfhem_BRT room FHEM2FHEM,HolzVergaser,OW_Remote,_notify
define systemCommands weblink cmdList pair:Pair:set+cul2+hmPairForSec+60 restart:Restart:shutdown+restart update:UpdateCheck:update+check
attr systemCommands room x_devel
define SVG_links weblink cmdList pair:Pair:set+cul2+hmPairForSec+60 restart:Restart:shutdown+restart update:UpdateCheck:update+check
attr SVG_links room x_devel
define WL_SVG1 weblink htmlCode <a href="http://fhem:8083/fhem?detail=WL_SVG1" \
   title="mehr WL_SVG1">\
	it is me\
   </a>\
   <br/>\
\
   <a href="http://fhem:8083/fhem?detail=SVG_PID.FUBO" \
   title="mehr Informationen">\
   SVG PID.FUBO\
   </a>\
   <br/>\
   \
   <a href="http://fhem:8083/fhem?detail=SVG_PID.FUBO" \
   title="mehr Informationen">\
	SVG_PID.FUBO\
	</a>\

attr WL_SVG1 room x_devel
define WL_SVG_RLA weblink link http://fhem:8083/fhem?detail=SVG_HV_RLA
attr WL_SVG_RLA room x_devel
define SVG_HV_PWR SVG logdb:SVG_HV_PWR:HISTORY
attr SVG_HV_PWR captionPos auto
attr SVG_HV_PWR nrAxis 1,2
attr SVG_HV_PWR plotsize 1400,600
attr SVG_HV_PWR room SVG,SVG_Holzvergaser
define DF_UEW_HVTemp_RLA DOIF ([RE_TEMP_HV_RLA:temperature] > 70)(\
set alarmbot message "Achtung RLA: [RE_TEMP_HV_RLA:temperature]"\
)\

attr DF_UEW_HVTemp_RLA repeatcmd 60
attr DF_UEW_HVTemp_RLA repeatsame 2
attr DF_UEW_HVTemp_RLA room HolzVergaser,Ueberwachung,_doif
attr DF_UEW_HVTemp_RLA widgetOverride cmdState:textField-long
define DF_UEW_HVTemp_VL DOIF ([RE_TEMP_HV_VL:temperature] > 85)(\
set alarmbot message "Achtung HV_VL: [RE_TEMP_HV_VL:temperature]"\
)
attr DF_UEW_HVTemp_VL repeatcmd 60
attr DF_UEW_HVTemp_VL repeatsame 20
attr DF_UEW_HVTemp_VL room HolzVergaser,Ueberwachung,_doif
attr DF_UEW_HVTemp_VL widgetOverride cmdState:textField-long
define D_oldwork dummy
attr D_oldwork room Heizung,System,Ueberwachung
attr D_oldwork userReadings heute {}
define repdb DbRep logdb
attr repdb disable 1
attr repdb fastStart 1
attr repdb room Logging
attr repdb showproctime 1
attr repdb timestamp_begin 2018-11-15 00:00:00
attr repdb timestamp_end 2018-11-15 01:00:00
attr repdb verbose 5
define 01static_DbRep DbRep logdb
attr 01static_DbRep disable 1
attr 01static_DbRep room Logging
attr 01static_DbRep showproctime 1
attr 01static_DbRep timestamp_begin current_day_begin
define DEVEL_logdb DbLog ./db_DEVELfhem.conf .*:.*
attr DEVEL_logdb DbLogType SampleFill/History
attr DEVEL_logdb asyncMode 1
attr DEVEL_logdb colEvent 0
attr DEVEL_logdb disable 1
attr DEVEL_logdb room Logging,x_devel
define DEVEL_repdb DbRep DEVEL_logdb
attr DEVEL_repdb disable 1
attr DEVEL_repdb room Logging,x_devel
define SVG_logdb_3 SVG logdb:SVG_logdb_3:HISTORY
attr SVG_logdb_3 plotsize 1200,400
attr SVG_logdb_3 room SVG
define et eventTypes log/eventTypes.txt
attr et room System
define N_test notify global:INITIALIZED\
{\
fhem("set Xmas off");;\
Log 1, "Adventszeit inaktiv";;\
if (5==1)\
{\
  Log 1, "Adventszeit aktiv";;\
  fhem("set Xmas on");;\
  fhem("include ./weihnachten.cfg");;\
}\
return;;\
}
attr N_test room x_devel
define KNX101.I01_BWM_Garage_WHG_Helligkeit KNX 2/1/1:dpt9.004 tul
attr KNX101.I01_BWM_Garage_WHG_Helligkeit DbLogInclude state
attr KNX101.I01_BWM_Garage_WHG_Helligkeit IODev tul
attr KNX101.I01_BWM_Garage_WHG_Helligkeit event-on-change-reading state
attr KNX101.I01_BWM_Garage_WHG_Helligkeit listenonly 1
attr KNX101.I01_BWM_Garage_WHG_Helligkeit room KNX
define KNX102.I01_Helligkeit KNX 2/2/1:dpt9.004 tul
attr KNX102.I01_Helligkeit DbLogInclude state
attr KNX102.I01_Helligkeit IODev tul
attr KNX102.I01_Helligkeit event-on-change-reading state
attr KNX102.I01_Helligkeit listenonly 1
attr KNX102.I01_Helligkeit room KNX
define KNX101.I01_BWM_Garage_WHG_Lichtgruppe KNX 2/1/0:dpt1 tul
attr KNX101.I01_BWM_Garage_WHG_Lichtgruppe DbLogInclude state
attr KNX101.I01_BWM_Garage_WHG_Lichtgruppe IODev tul
attr KNX101.I01_BWM_Garage_WHG_Lichtgruppe event-on-update-reading state
attr KNX101.I01_BWM_Garage_WHG_Lichtgruppe listenonly 1
attr KNX101.I01_BWM_Garage_WHG_Lichtgruppe room KNX
define KNX102.I01_Lichtgruppe KNX 2/2/0:dpt1 tul
attr KNX102.I01_Lichtgruppe DbLogInclude state
attr KNX102.I01_Lichtgruppe IODev tul
attr KNX102.I01_Lichtgruppe event-on-update-reading state
attr KNX102.I01_Lichtgruppe listenonly 1
attr KNX102.I01_Lichtgruppe room KNX
define KNX101.I01_BWM_Garage_WHG_Praesenz KNX 2/1/2:dpt1 tul
attr KNX101.I01_BWM_Garage_WHG_Praesenz IODev tul
attr KNX101.I01_BWM_Garage_WHG_Praesenz event-on-change-reading 1
attr KNX101.I01_BWM_Garage_WHG_Praesenz listenonly 0
attr KNX101.I01_BWM_Garage_WHG_Praesenz readonly 1
attr KNX101.I01_BWM_Garage_WHG_Praesenz room KNX
attr KNX101.I01_BWM_Garage_WHG_Praesenz webCmd :
define KNX102.I01_Praesenz KNX 2/2/2:dpt1 tul
attr KNX102.I01_Praesenz IODev tul
attr KNX102.I01_Praesenz event-on-change-reading 1
attr KNX102.I01_Praesenz listenonly 1
attr KNX102.I01_Praesenz room KNX
attr KNX102.I01_Praesenz webCmd :
define DF_KNX101.I01_BWM_Garage DOIF ([KNX101.I01_BWM_Garage_WHG_Lichtgruppe] eq "on" && [FS20_Garage:state] eq "off")\
	(\
	set FS20_Garage on,\
	defmod AT_FS20Garage_aus at +00:02:30 {GarageAus()},\
	attr AT_FS20Garage_aus room _at,\
	set remotebot message @137545657 Licht Garage on\
	)\
DOELSEIF([KNX101.I01_BWM_Garage_WHG_Lichtgruppe] eq "on" && [FS20_Garage:state] eq "on")\
	(\
	defmod AT_FS20Garage_aus at +00:02:30 {GarageAus()},\
	set remotebot message @137545657 Licht Garage verlängert\
	)
attr DF_KNX101.I01_BWM_Garage do always
attr DF_KNX101.I01_BWM_Garage event-on-change-reading cmd
attr DF_KNX101.I01_BWM_Garage room _doif
define DF_saveDBCache DOIF ([+45] && [?logdb:CacheUsage] > 150) (\
set remotebot message logdb-Problem: \n[logdb:state]\n[logdb:CacheUsage],\
set logdb exportCache purgeCache,\
set remotebot message logdb-Problem: \n[logdb:state]\n[logdb:CacheUsage],\
attr logdb asyncMode 0\
)
attr DF_saveDBCache do always
attr DF_saveDBCache room Logging,_doif
define DF_test_Praesenz DOIF ([KNX101.I01_BWM_Garage_WHG_Praesenz:getG1])( set remotebot message @137545657 P: $EVENT)\

attr DF_test_Praesenz do always
attr DF_test_Praesenz room _doif,x_devel
define DF_test_Lichtgruppe DOIF ([KNX101.I01_BWM_Garage_WHG_Lichtgruppe:getG1])\
({\
my $ts = ReadingsTimestamp("KNX101.I01_BWM_Garage_WHG_Lichtgruppe","getG1",0);;\
fhem("set remotebot message \@137545657 LG: $EVENTS $ts");;\
})\

attr DF_test_Lichtgruppe do always
attr DF_test_Lichtgruppe room _doif,x_devel
define N_KNX101.I01_BWM_Garage notify KNX101.I01_BWM_Garage_WHG_Lichtgruppe:on \
 set remotebot message @137545657 Licht Garage an;;\
 set FS20_Garage on;;\
 defmod AT_FS20Garage_aus at +00:02:30 set FS20_Garage off;;;; \
 		set remotebot message @137545657 Licht Garage aus;;\
 attr AT_FS20Garage_aus room _at;;
attr N_KNX101.I01_BWM_Garage room KNX,_notify,x_devel
define N_HVfhem_RLA notify OW_HV_RLA:temperature.* setreading RE_TEMP_HV_RLA2 temperature $EVTPART1
attr N_HVfhem_RLA room FHEM2FHEM,HolzVergaser,OW_Remote,_notify
define RE_TEMP_HV_RLA2 dummy
attr RE_TEMP_HV_RLA2 DbLogInclude temperature
attr RE_TEMP_HV_RLA2 event-on-update-reading temperature
attr RE_TEMP_HV_RLA2 group Thermometer
attr RE_TEMP_HV_RLA2 room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_RLA2 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define FileLog_Bahnplan FileLog ./log/BahnPlan-%Y-%m.log NadineSbahnFFM.*
attr FileLog_Bahnplan room Logging,x_Bahnplan
define DF_watchBRT DOIF ([RE_TEMP_BRT:temperature] > 100 && [$SELF:count] == 0)(\
setreading $SELF count 1,\
set alarmbot message "Ofen gestartet. Zuluft offen?"\
)\
DOELSEIF([RE_TEMP_BRT:temperature] > 800 && [$SELF:count] <= 2 )(\
setreading $SELF count 3,\
set alarmbot message "Ofen läuft. Zuluft offen?"\
)\
DOELSEIF([RE_TEMP_BRT:temperature] < 600 && [$SELF:count] == 3 )\
(\
setreading $SELF count 4,\
set alarmbot message "jetzt nachlegen oder Zuluftöffnung schließen!"\
)\
DOELSEIF([RE_TEMP_BRT:temperature] < 300 && [$SELF:count] == 4 )\
(\
setreading $SELF count 0,\
set alarmbot message "Zuluft schließen!"\
)
attr DF_watchBRT room HolzVergaser,_doif
attr DF_watchBRT wait 120:120:120:120
define N_dbrep_send_telegram notify ..static_DbRep:SqlResultRow_.* set remotebot message $EVENT
attr N_dbrep_send_telegram disable 1
attr N_dbrep_send_telegram room Logging,Telegram_BOT,_notify
define 02static_DbRep DbRep logdb
attr 02static_DbRep disable 1
attr 02static_DbRep room Logging
attr 02static_DbRep showproctime 1
attr 02static_DbRep timestamp_begin current_day_begin
define 03static_DbRep DbRep logdb
attr 03static_DbRep disable 1
attr 03static_DbRep room Logging
attr 03static_DbRep showproctime 1
attr 03static_DbRep timestamp_begin current_day_begin
define ETH_HTTPMOD HTTPMOD https://www.bitcoin.de/de/etheur/market 600
attr ETH_HTTPMOD userattr reading01Name reading01Regex reading02Name reading02Regex reading03Name reading03Regex
attr ETH_HTTPMOD reading01Name ticker_price
attr ETH_HTTPMOD reading01Regex id="ticker_price">(.*)<
attr ETH_HTTPMOD reading02Name rate_buy
attr ETH_HTTPMOD reading02Regex id="rate_buy" data-rate="(.*)">
attr ETH_HTTPMOD reading03Name rate_sell
attr ETH_HTTPMOD reading03Regex id="rate_sell" data-rate="(.*)">
attr ETH_HTTPMOD room crypto
attr ETH_HTTPMOD stateFormat ticker_price
attr ETH_HTTPMOD userReadings rate:ticker_price.* {my $v = ReadingsVal($name,"ticker_price",0);; $v =~ s/\.//g;; $v =~ s/,/./;; $v},\
buy:rate_buy.* {my $v = ReadingsVal($name,"rate_buy",0);; $v =~ s/\,//g;; $v},\
sell:rate_sell.* {my $v = ReadingsVal($name,"rate_sell",0);; $v =~ s/\,//g;; $v},\
high:rate_sell.* {ReadingsNum($name,"high",0) > ReadingsNum($name,"sell",0) ? ReadingsNum($name,"sell",0):ReadingsNum($name,"high",0)}
attr ETH_HTTPMOD verbose 2
define DF_watchETH DOIF ([ETH_HTTPMOD:sell:d] < 600 || [:00])\
(\
set alarmbot message Achtung Ether [ETH_HTTPMOD:rate]\nSELL:[ETH_HTTPMOD:sell]\
)
attr DF_watchETH do always
attr DF_watchETH room _doif,crypto
define DF_activateBahnplanTimetable DOIF ([08:10|Mo Di Mi Do Fr]) \
(\
set NadineSbahnFFM_S1_morgens active\
)\
DOELSEIF ([17:45|Mo Di Mi Do]) \
(\
set NadineSbahnFFM_S2_abends active\
)\
DOELSEIF ([12:50-13:17|Fr])\
(\
set NadineSbahnFFM_S1_freitagmittag active,\
set NadineSbahnFFM_S2_freitagmittag active\
)\
DOELSEIF([08:35|Mo Di Mi Do Fr])\
(\
set NadineSbahnFFM_S1_morgens inactive\
)\
DOELSEIF([18:15|Mo Di Mi Do]) \
(\
set NadineSbahnFFM_S2_abends inactive\
)\
DOELSEIF([13:17|Fr])\
(\
set NadineSbahnFFM_S1_freitagmittag inactive,\
set NadineSbahnFFM_S2_freitagmittag inactive\
)
attr DF_activateBahnplanTimetable do always
attr DF_activateBahnplanTimetable room _doif,x_Bahnplan
define DF_watchCrypto DOIF ([BTC_HTTPMOD:sell:d])\
(\
set coinbot message Bitcoins [BTC_HTTPMOD:rate]\nSELL:[BTC_HTTPMOD:sell]\
)\
DOELSEIF([BCH_HTTPMOD:sell:d])\
(\
set coinbot message BCH [BCH_HTTPMOD:rate]\nSELL:[BCH_HTTPMOD:sell]\
)\
DOELSEIF ([ETH_HTTPMOD:sell:d])\
(\
set coinbot message Ether [ETH_HTTPMOD:rate]\ngekauft für 430\
)\
DOELSEIF ([BTG_HTTPMOD:sell:d])\
(\
set coinbot message BTG [BTG_HTTPMOD:rate]\ngekauft für 27\
)\
DOELSEIF(1)\
(\
##&& [08:00-22:00]\
set coinbot message \
	Bitcoins [BTC_HTTPMOD:rate]\nSELL:[BTC_HTTPMOD:rate_sell]\n\n\
	BCH [BCH_HTTPMOD:rate]\nSELL:[BCH_HTTPMOD:rate_sell]\n\n\
	Ether [ETH_HTTPMOD:rate]\nSELL:[ETH_HTTPMOD:rate_sell]\n\n\
)
attr DF_watchCrypto do always
attr DF_watchCrypto room _doif,crypto
define DF_BrunnenDEVEL DOIF ([KNX10.I09_Druckschalter_Brunnen:getG1] eq "off")\
	(\
	set alarmbot message "würde jetzt ausschalten"\
	)\
DOELSEIF\
([KNX10.I09_Druckschalter_Brunnen:getG1] eq "on" )\
	(\
	set alarmbot message "würde jetzt einschalten"\
	)\
	(\
	set alarmbot message "Brunnen defekt!"\
	)\
DOELSEIF([KNX02.O01_Stromwert:getG1] > 3000)\
	(\
	## bei Erhalt am 30.11. auf 2700mA und 45 sekunden gestellt\
	## am 18.12. aufgrund vieler Alarme auf 2900 und 60 sekunden geändert\
	set alarmbot message "würde jetzt ausschalten",\
	(set alarmbot message ALARM: Brunnenstrom fuer 60 Sekunden ueber 3000mA, Brunnen für 240 sek abgeschaltet)\
	)\
	(\
	set alarmbot message "würde jetzt einschalten",\
	set alarmbot message Brunnen wieder an\
	)\
##DOELSEIF([KNX02.O01_Stromwert:getG1] < 80)\
##	(\
##	set KNX02.O01_Aktor_Brunnen off,\
##	(set alarmbot message ALARM: Brunnen: Presscontrol hat abgeschaltet, obwohl Enddruck nicht erreicht)\
##	)
attr DF_BrunnenDEVEL cmdState Pumpe aus|Pumpe an|Pumpenstrom > 3000mA
attr DF_BrunnenDEVEL room Wasser,_doif
attr DF_BrunnenDEVEL wait 0:0,900:60,240
attr DF_BrunnenDEVEL widgetOverride cmdState:textField-long
define hzfhemTOfhem FHEM2FHEM 192.168.0.32 LOG:OWX.*|Endschalter.*
attr hzfhemTOfhem room FHEM2FHEM
define N_HZfhem_OWCOUNTER_WMZ_Heizung_main notify OWX_1D_18DC84000003:B_rate.* setreading D_WMZ_Heizung_main rate $EVTPART1;;
attr N_HZfhem_OWCOUNTER_WMZ_Heizung_main room FHEM2FHEM,_notify
define D_WMZ_Heizung_main dummy
attr D_WMZ_Heizung_main DbLogInclude power,work
attr D_WMZ_Heizung_main event-on-update-reading power,work,rate,literpromin
attr D_WMZ_Heizung_main room FHEM2FHEM,Heizung,_dummy
attr D_WMZ_Heizung_main stateFormat power
attr D_WMZ_Heizung_main userReadings VL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_VorlaufHK","temperature",0))},\
RL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_RuecklaufHK","temperature",0))},\
deltaT {sprintf("%.2f °C",ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))},\
power:rate.* {sprintf("%.0f W",ReadingsNum($name,"rate",0)/52*3600*1.16*(ReadingsNum($name,"deltaT",0)))},\
work:rate.* {sprintf("%.2f Wh",ReadingsNum($name,"rate",0)/52*1.16*ReadingsAge($name,"work",0)*(ReadingsNum($name,"deltaT",0)))},\
literprosec:rate.* {sprintf("%.2f liter/s",ReadingsNum($name,"rate",0)/52)},\
literpromin:rate.* {sprintf("%.2f liter/min",ReadingsNum($name,"rate",0)/52*60)}
define D_WMZ_Solar dummy
attr D_WMZ_Solar DbLogInclude power,work
attr D_WMZ_Solar room Solar,_dummy
attr D_WMZ_Solar stateFormat power
attr D_WMZ_Solar userReadings VL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_Vorlauf_Solar","temperature",0))},\
RL {sprintf("%.2f °C",ReadingsNum("RE_TEMP_Ruecklauf_Solar","temperature",0))},\
deltaT {sprintf("%.2f °C",ReadingsNum($name,"VL",0)-ReadingsNum($name,"RL",0))},\
heat_cap {sprintf("%.6f Wh/l",heat_capacity_solarfluid())},\
power:rate.* {sprintf("%.0f W",ReadingsNum($name,"rate",0)*3600*1.05*ReadingsNum($name,"deltaT",0))},\
work:rate.* {sprintf("%.2f Wh",ReadingsNum($name,"rate",0)*1.05*ReadingsAge($name,"work",0))},\
literprosec:rate.* {sprintf("%.2f liter/s",ReadingsNum($name,"rate",0))},\
literpromin:rate.* {sprintf("%.2f liter/min",ReadingsNum($name,"rate",0)*60)}
define N_HZfhem_OWCOUNTER_WMZ_Solar notify OWX_1D_19DC84000003:A_rate.* setreading D_WMZ_Solar rate $EVTPART1;;
attr N_HZfhem_OWCOUNTER_WMZ_Solar room FHEM2FHEM,_notify
define D_WMZ_Gaskessel dummy
attr D_WMZ_Gaskessel room Gas
define RE_TEMP_HV_VL2 dummy
attr RE_TEMP_HV_VL2 DbLogInclude temperature
attr RE_TEMP_HV_VL2 comment GPIO HVFHEM
attr RE_TEMP_HV_VL2 group Thermometer
attr RE_TEMP_HV_VL2 room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_VL2 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define N_HVfhem_VL notify OW_HV_VL:temperature.* setreading RE_TEMP_HV_VL2 temperature $EVTPART1
attr N_HVfhem_VL room FHEM2FHEM,HolzVergaser,OW_Remote,_notify
define N_HZfhem_KNXCOUNTER_WMZ_Solar notify KNX10.I07_Solarzaehler:power.* setreading D_WMZ_Solar KNX_power $EVTPART1;;
attr N_HZfhem_KNXCOUNTER_WMZ_Solar disable 1
attr N_HZfhem_KNXCOUNTER_WMZ_Solar room FHEM2FHEM,_notify
define SVG_logdb_6 SVG logdb:SVG_logdb_6:HISTORY
attr SVG_logdb_6 plotsize 1200,400
attr SVG_logdb_6 room SVG
define DF_UEW_logdb DOIF ([logdb:state] ne "connected")(\
{log_telegram("1","logdb","Probleme mit der Datenbank:\n[logdb:state]","alarmbot")}\
)
attr DF_UEW_logdb room Logging,Ueberwachung,_doif
define DF_auswertungen DOIF (1)(\
deletereading $SELF .*,\
setreading $SELF RESULTNAME HVWORK_lastyear,\
set repdb sqlCmd SELECT SUM(VALUE) from `history` where DEVICE='KNX10.I05_Zaehler_Holzvergaser' AND READING='lastliterwork' AND TIMESTAMP >='2017-01-01 00:00:00' AND TIMESTAMP <'2017-12-31 00:00:00' AND VALUE > 0\
)\
DOELSEIF(1)(\
deletereading $SELF .*,\
setreading $SELF RESULTNAME HZWORK_lastyear,\
set repdb sqlCmd SELECT SUM(VALUE) from `history` where DEVICE='KNX10.I06_Heizungszaehler_main' AND READING='lastliterwork' AND TIMESTAMP >='2017-01-01 00:00:00' AND TIMESTAMP <'2017-12-31 00:00:00' AND VALUE > 0\
)\
DOELSEIF(1)(\
deletereading $SELF .*,\
setreading $SELF RESULTNAME SOLARWORK_lastyear,\
set repdb sqlCmd SELECT SUM(VALUE) from `history` where DEVICE='KNX10.I07_Solarzaehler' AND READING='lastliterwork' AND TIMESTAMP >='2017-01-01 00:00:00' AND TIMESTAMP <'2017-12-31 00:00:00' AND VALUE > 0\
)\
DOELSEIF([repdb:sqlResultNumRows])(\
{\
fhem("deletereading $SELF .*");;\
sleep 1;;\
my $sqlCMD = ReadingsVal("repdb","sqlCmd","error");;\
fhem("setreading $SELF sqlCmd $sqlCMD");;\
my $rows = ReadingsNum("repdb","sqlResultNumRows","error");;\
my $i;;\
for ($i=1;;$i<=$rows;;$i++)\
	{\
	my $dbrep_reading_name = "SqlResultRow_" . $i;;\
	my $dbrep_reading_value = int(ReadingsVal("repdb",$dbrep_reading_name,"error")/1000);;\
	my $doif_reading_name = ReadingsVal("$SELF","RESULTNAME","none");;\
	fhem("setreading $SELF $doif_reading_name $dbrep_reading_value");;\
	}	\
\
}\
)DOELSEIF(3)\
(\
my $res = SQLselectDIFF("current_year_begin","now","value","Stromzaehler","total_energy","none");;\
fhem("setreading $SELF result $res");;\
\
)
attr DF_auswertungen disable 1
attr DF_auswertungen room Logging,_doif
define N_HZfhem_OWCOUNTER_Stromzaehler notify OWX_1D_22DC84000003:B_rate.* setreading D_test B_rate $EVTPART1;;
attr N_HZfhem_OWCOUNTER_Stromzaehler room FHEM2FHEM,_notify
define D_test dummy
attr D_test room x_devel
attr D_test userReadings power {ReadingsVal($name,"B_rate",0)*3600}\
## 1 imp = 1wh = 3600 Ws \
## 1 wh/h = 1W
define coinbot TelegramBot
attr coinbot defaultPeer 137545657
attr coinbot room Telegram_BOT
define KNX32.O01_Aktor_Zirkulation_WW KNX 1/6/0:dpt1
attr KNX32.O01_Aktor_Zirkulation_WW IODev tul
attr KNX32.O01_Aktor_Zirkulation_WW devStateIcon on::off off::on
attr KNX32.O01_Aktor_Zirkulation_WW room KNX
define KNX32.O01_Status KNX 1/6/1:dpt1
attr KNX32.O01_Status IODev tul
attr KNX32.O01_Status room KNX
define KNX32.O02_Aktor_UWP_3000_1500 KNX 1/6/2:dpt1
attr KNX32.O02_Aktor_UWP_3000_1500 IODev tul
attr KNX32.O02_Aktor_UWP_3000_1500 devStateIcon on::off off::on
attr KNX32.O02_Aktor_UWP_3000_1500 room KNX,Heizung_Puffer
attr KNX32.O02_Aktor_UWP_3000_1500 userReadings Lastswitch { ReadingsTimestamp("KNX32.O02_Aktor_UWP_3000_1500","state",0) }
define KNX32.O02_Status KNX 1/6/3:dpt1
attr KNX32.O02_Status IODev tul
attr KNX32.O02_Status room KNX,Heizung_Puffer
define KNX32.O03_Aktor_UWP_1500_3000 KNX 1/6/4:dpt1
attr KNX32.O03_Aktor_UWP_1500_3000 IODev tul
attr KNX32.O03_Aktor_UWP_1500_3000 devStateIcon on::off off::on
attr KNX32.O03_Aktor_UWP_1500_3000 room KNX,Heizung_Puffer
define KNX32.O03_Status KNX 1/6/5:dpt1
attr KNX32.O03_Status IODev tul
attr KNX32.O03_Status room KNX,Heizung_Puffer
define KNX32.O04_Aktor_Gaskessel_Temperatursimulation KNX 1/6/6:dpt1
attr KNX32.O04_Aktor_Gaskessel_Temperatursimulation IODev tul
attr KNX32.O04_Aktor_Gaskessel_Temperatursimulation devStateIcon on::off off::on
attr KNX32.O04_Aktor_Gaskessel_Temperatursimulation room KNX
define KNX32.O04_Status KNX 1/6/7:dpt1
attr KNX32.O04_Status IODev tul
attr KNX32.O04_Status room KNX
define KNX32.O05_Aktor_Tonstrom_WoEss KNX 1/6/8:dpt1
attr KNX32.O05_Aktor_Tonstrom_WoEss IODev tul
attr KNX32.O05_Aktor_Tonstrom_WoEss devStateIcon on::off off::on
attr KNX32.O05_Aktor_Tonstrom_WoEss room KNX
define KNX32.O05_Status KNX 1/6/9:dpt1
attr KNX32.O05_Status IODev tul
attr KNX32.O05_Status room KNX
define KNX32.O06_Aktor_Leuchte_Garage_Decke KNX 1/6/10:dpt1
attr KNX32.O06_Aktor_Leuchte_Garage_Decke IODev tul
attr KNX32.O06_Aktor_Leuchte_Garage_Decke devStateIcon on::off off::on
attr KNX32.O06_Aktor_Leuchte_Garage_Decke room KNX
define KNX32.O06_Status KNX 1/6/11:dpt1
attr KNX32.O06_Status IODev tul
attr KNX32.O06_Status room KNX
define KNX32.O07_Aktor KNX 1/6/12:dpt1
attr KNX32.O07_Aktor IODev tul
attr KNX32.O07_Aktor devStateIcon on::off off::on
attr KNX32.O07_Aktor room KNX
define KNX32.O07_Status KNX 1/6/13:dpt1
attr KNX32.O07_Status IODev tul
attr KNX32.O07_Status room KNX
define KNX32.O08_Aktor KNX 1/6/14:dpt1
attr KNX32.O08_Aktor IODev tul
attr KNX32.O08_Aktor devStateIcon on::off off::on
attr KNX32.O08_Aktor room KNX
define KNX32.O08_Status KNX 1/6/15:dpt1
attr KNX32.O08_Status IODev tul
attr KNX32.O08_Status room KNX
define KNX32.I01_Taster_Tor_Garage_rechts KNX 1/6/16:dpt1
attr KNX32.I01_Taster_Tor_Garage_rechts IODev tul
attr KNX32.I01_Taster_Tor_Garage_rechts room KNX
define KNX32.I02_Taster_Tor_Garage_links KNX 1/6/17:dpt1
attr KNX32.I02_Taster_Tor_Garage_links IODev tul
attr KNX32.I02_Taster_Tor_Garage_links room KNX
define KNX32.I03_Sensor KNX 1/6/18:dpt1
attr KNX32.I03_Sensor IODev tul
attr KNX32.I03_Sensor room KNX
define KNX32.I04_Sensor KNX 1/6/19:dpt1
attr KNX32.I04_Sensor IODev tul
attr KNX32.I04_Sensor room KNX
define KNX32.I05_Sensor KNX 1/6/20:dpt1
attr KNX32.I05_Sensor IODev tul
attr KNX32.I05_Sensor room KNX
define KNX32.I06_Sensor KNX 1/6/21:dpt1
attr KNX32.I06_Sensor IODev tul
attr KNX32.I06_Sensor room KNX
define KNX32.I07_Sensor KNX 1/6/22:dpt1
attr KNX32.I07_Sensor IODev tul
attr KNX32.I07_Sensor room KNX
define KNX32.I08_Sensor KNX 1/6/23:dpt1
attr KNX32.I08_Sensor IODev tul
attr KNX32.I08_Sensor room KNX
define DF_Gaskessel_Handbetrieb DOIF ([RE_TEMP_Ruecklauf_Kessel:temperature] > 30 )\
(\
set KNX32.O04_Aktor_Gaskessel_Temperatursimulation on,\
set alarmbot message Gaskessel automatik aus\n Ruecklauftemperatur [RE_TEMP_Ruecklauf_Kessel:temperature] > 30 Grad!\
)\
DOELSEIF (0)\
(\
set KNX32.O04_Aktor_Gaskessel_Temperatursimulation off,\
defmod send_Kesseltemp at *+00:10:00 set alarmbot message Gaskessel noch an!\
)\
DOELSEIF (0)\
(\
set KNX32.O04_Aktor_Gaskessel_Temperatursimulation off-for-timer 3600,\
defmod send_Kesseltemp at +01:00:00 set alarmbot message Gaskessel sollte wieder aus sein!\
)\
DOELSEIF (0)\
(\
set KNX32.O04_Aktor_Gaskessel_Temperatursimulation on,\
set alarmbot message Gaskessel aus!\
)
attr DF_Gaskessel_Handbetrieb room Gas,_doif
attr DF_Gaskessel_Handbetrieb wait 300
define N_HZfhem_OWCOUNTER_Gas notify OWX_1D_19DC84000003:B_rate.* setreading D_WMZ_Gaskessel rate $EVTPART1;;
attr N_HZfhem_OWCOUNTER_Gas room FHEM2FHEM,_notify
define repdb_work_HV DbRep logdb
attr repdb_work_HV aggregation day
attr repdb_work_HV device KNX10.I05_Zaehler_Holzvergaser
attr repdb_work_HV disable 1
attr repdb_work_HV reading lastliterwork
attr repdb_work_HV room Logging
attr repdb_work_HV timeDiffToNow 31536000
define repdb_work_Solar DbRep logdb
attr repdb_work_Solar aggregation day
attr repdb_work_Solar device D_WMZ_Solar
attr repdb_work_Solar disable 1
attr repdb_work_Solar reading work
attr repdb_work_Solar room Logging
attr repdb_work_Solar timeDiffToNow 31536000
define repdb_work_HZG_main DbRep logdb
attr repdb_work_HZG_main aggregation day
attr repdb_work_HZG_main device D_WMZ_Heizung_main
attr repdb_work_HZG_main disable 1
attr repdb_work_HZG_main reading work
attr repdb_work_HZG_main room Logging
attr repdb_work_HZG_main timeDiffToNow 31536000
define KNX02.O09_RESET_CTR_HV KNX 1/2/43:dpt1
attr KNX02.O09_RESET_CTR_HV DbLogInclude state
attr KNX02.O09_RESET_CTR_HV IODev tul
attr KNX02.O09_RESET_CTR_HV room KNX
define DF_Auswertungen DOIF (1)({\
for (my $i=0;; $i <= 9;; $i++) {\
	my $solar[$i] = int(10*SQLselectSUM($i, $i, "VALUE","D_WMZ_Solar", "work","funktion")/1000)/10;;\
	fhem("setreading $SELF solar_$i $solar[$i]");;\
}\
})\
DOELSEIF(2)({\
for (my $i=0;; $i <= 9;; $i++) {\
	my $hzg[$i] = int(10*SQLselectSUM($i, $i, "VALUE","D_WMZ_Heizung_main", "work","funktion")/1000)/10;;\
	fhem("setreading $SELF hzg_$i $hzg[$i]");;\
}\
})\
DOELSEIF(3)({\
for (my $i=0;; $i <= 9;; $i++) {\
	my $gas[$i] = int(10*SQLselectSUM($i, $i, "VALUE","D_WMZ_Gaskessel", "work","funktion")/1000)/10;;\
	fhem("setreading $SELF gas_$i $gas[$i]");;\
}\
})\
DOELSEIF(4)({\
for (my $i=0;; $i <= 9;; $i++) {\
	my $hv[$i] = int(10*SQLselectSUM($i, $i, "VALUE","KNX10.I05_Zaehler_Holzvergaser", "lastliterwork","funktion")/1000)/10;;\
	fhem("setreading $SELF hv_$i $hv[$i]");;\
}\
})\
DOELSEIF([23:59])(\
setreading $SELF solar_0 0\
)
attr DF_Auswertungen room Gas,Heizung,Solar,_doif
define DF_HV_Heizbeginn DOIF ([KNX02.O09_Stromwert:power] > 20)\
(	\
	set remotebot message HV an\
)\
DOELSE\
(\
	set remotebot message HV aus\
)
attr DF_HV_Heizbeginn room HolzVergaser,Ueberwachung,_doif
attr DF_HV_Heizbeginn stateFormat { ReadingsAge($name, "cmd",0);;}
attr DF_HV_Heizbeginn userReadings laufzeit { ReadingsAge($name, "cmd",0);;},\
startzeit { ReadingsTimestamp($name, "cmd",0);;}
attr DF_HV_Heizbeginn wait 60:60
attr DF_HV_Heizbeginn widgetOverride cmdState:textField-long
define SVG_HV_PWR_EL SVG logdb:SVG_HV_PWR_EL:HISTORY
attr SVG_HV_PWR_EL captionPos auto
attr SVG_HV_PWR_EL nrAxis 1,2
attr SVG_HV_PWR_EL plotsize 1400,600
attr SVG_HV_PWR_EL room SVG,SVG_Holzvergaser
define DF_test1 DOIF (5)(set remotebot message [KNX02.O09_Stromwert:power])
attr DF_test1 DOIF_Readings showtemp:ReadingsVal([$SELF:sensorselect],"temperature","nix" )
attr DF_test1 do always
attr DF_test1 room x_devel
attr DF_test1 uiTable {\
 $TPL{style2}="	text-align:right;;\
 				width:23px;;\
				position:absolute;;\
				left:13px;;\
				top:26px;;\
				font-weight:bold;;\
				font-size:12px;;\
				color:";;\
 $TPL{knob2}="	knob,\
 				thickness:.3,\
				fgColor:#FFA500,\
				min:7,\
				max:30,\
				width:50,\
				height:50,\
				step:.5,\
				angleArc:270,\
				angleOffset:225,\
				displayInput:false";;\
\
 $TD{0}{0}=" colspan=2 ";;\
  sub FUNC_batt {\
    my($val)=@_;;\
    my $ret="position:absolute;;left:0px;;width:25px;;height:100px;;background:linear-gradient( to bottom,#F8F8E0 ".(100-$val)."px,rgba(0,0,0,0) ".(100-$val)."px);;";;\
    return $ret;;\
  }\
  sub FUNC_batt2 {\
    my($val)=@_;;\
    my $ret="position:absolute;;left:9px;;top:6px;;width:14px;;height:27px;;background:linear-gradient( to bottom,#F8F8E0 ".(100-$val)."%,rgba(0,0,0,0) ".(100-$val)."%);;";;\
    return $ret;;\
  }\
}\
WID([HMsensor_Labor],"uzsuSelectRadio,enable,disable")\
\
"<div style='border-width:2px;;border-style:solid;;border-color:gray;;position:relative;;width:25px;;height:100px;;background:linear-gradient( to top, red 0px,yellow 50px,green 100px);;'>".STY(" ",FUNC_batt([HMdummy_Labor:level])).STY([HMdummy_Labor:level]."%","font-size:9px;;position:absolute;;top:45px;;right:1px")."</div>"|\
"<div style='position:relative'>\
<div style='position:absolute;;left:9px;;top:6px;;width:14px;;height:27px;;background:linear-gradient( to top, red 0%,yellow 50%,green 100%);;'></div>\
".STY(" ",FUNC_batt2([HMdummy_Labor:level])).STY([HMdummy_Labor:level]."%","font-size:6px;;position:absolute;;top:15px;;left:10px").STY(FW_makeImage("measure_battery_0"))."</div>"\
"<div style='position:relative;;width:50px;;height:50px'><div style='position:absolute;;left:0px;;top:0px'>".WID([HMdummy_Labor:measured-temp],$TPL{knob1})."</div><div style='position:absolute;;left:0px;;top:0px'>".WID([HMdummy_Labor:desired-temp],$TPL{knob2},"set")."</div>".STY([HMdummy_Labor:measured-temp:d1],$TPL{style2}.DOIF_hsv([HMdummy_Labor:measured-temp],7,25,240,360,100,100)).STY([HMdummy_Labor:desired-temp:d1],$TPL{style3}.DOIF_hsv([HMdummy_Labor:desired-temp],7,25,240,360,100,100))."</div>"
define D_verboseTelegram dummy
attr D_verboseTelegram event-on-change-reading 1
attr D_verboseTelegram room Telegram_BOT,_dummy
define DF_verbose DOIF ([D_verboseTelegram])(set alarmbot message verbose: $EVENT)
attr DF_verbose do always
attr DF_verbose room _doif
define DF_3000to1500 DOIF ([DF_move_heat:pumpe3t1] && [$SELF:pump_mode] eq "auto")\
(\
set KNX32.O02_Aktor_UWP_3000_1500 [DF_move_heat:pumpe3t1]\
)\
DOELSEIF ([$SELF:pump_mode] eq "man_on")\
	(\
		set KNX32.O02_Aktor_UWP_3000_1500 on,\
		setreading $SELF pump_mode man_on\
	)\
	(\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF ([$SELF:pump_mode] eq "man_off")\
	(\
		set KNX32.O02_Aktor_UWP_3000_1500 off,\
		setreading $SELF pump_mode man_off\
	)\
	(\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF ([$SELF:pump_mode] eq "auto")\
	(\
		set KNX32.O02_Aktor_UWP_3000_1500 [DF_move_heat:pumpe3t1],\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF([05:00] || [RE_TEMP_Speicher_02:temperature] > 65 || [RE_TEMP_PS3000_10:temperature]+2 < [RE_TEMP_Speicher_09:temperature])\
	(\
		set KNX32.O02_Aktor_UWP_3000_1500 off,\
		setreading $SELF pump_mode auto\
	)
attr DF_3000to1500 DbLogInclude Pumpe_3000_1500
attr DF_3000to1500 cmdState auto|an,an|aus,aus|auto|auto
attr DF_3000to1500 do always
attr DF_3000to1500 room Heizung,Heizung_Puffer,HolzVergaser,_doif
attr DF_3000to1500 wait 0:0,3600:0,3600:0
attr DF_3000to1500 widgetOverride cmdState:textField-long
define DF_1500to3000 DOIF ([DF_move_heat:pumpe1t3] && [$SELF:pump_mode] eq "auto")\
(\
set KNX32.O03_Aktor_UWP_1500_3000 [DF_move_heat:pumpe1t3]\
)\
DOELSEIF ([$SELF:pump_mode] eq "man_on")\
	(\
		set KNX32.O03_Aktor_UWP_1500_3000 on,\
		setreading $SELF pump_mode man_on\
	)\
	(\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF ([$SELF:pump_mode] eq "man_off")\
	(\
		set KNX32.O03_Aktor_UWP_1500_3000 off,\
		setreading $SELF pump_mode man_off\
	)\
	(\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF ([$SELF:pump_mode] eq "auto")\
	(\
		set KNX32.O03_Aktor_UWP_1500_3000 [DF_move_heat:pumpe1t3],\
		setreading $SELF pump_mode auto\
	)\
DOELSEIF([18:00])\
	(\
		set KNX32.O03_Aktor_UWP_1500_3000 off,\
		setreading $SELF pump_mode auto\
	)
attr DF_1500to3000 DbLogInclude Pumpe_3000_1500
attr DF_1500to3000 cmdState auto|an,an|aus,aus|auto|auto
attr DF_1500to3000 do always
attr DF_1500to3000 room Heizung,Heizung_Puffer,HolzVergaser,_doif
attr DF_1500to3000 wait 0:0,3600:0,3600:0
attr DF_1500to3000 widgetOverride cmdState:textField-long
define MeinWetter Weather 638242 3600 de
attr MeinWetter room x_devel
define DFWD_apacheOC DOIF ([+300])\
{\
my $result = system('/opt/fhem/FHEMcheckOC');;\
fhem("setreading $SELF ocstate $result");;\
if($result ne 0){\
	fhem("set alarmbot message SERVER APACHE is down");;\
}\
}
attr DFWD_apacheOC disable 1
attr DFWD_apacheOC room _doif
define DF_test2 DOIF ([$SELF:status] eq "debug")(set alarmbot message DEBUG test)\
DOELSEIF\
([$SELF:status] eq "alarm")(set alarmbot message ALARM test)
attr DF_test2 DOIF_Readings showtemp:ReadingsVal([$SELF:sensorselect],"temperature","nix" )
attr DF_test2 do always
attr DF_test2 room x_devel
attr DF_test2 uiTable WID([$SELF:status],"uzsuSelectRadio,debug,alarm")
define Pushover Pushover ah3u4d7p9ajfyz3c826eot5x5k8xon uvzufww65rt2gf1a4xfs5t9e9an3to
attr Pushover comment ALARM title=FFO priority=1\
ALARM title=FHEM priority=1
attr Pushover room Telegram_BOT
define KNX01.O01_Aktor_Leuchte_Flur_EG_OG KNX 1/0/0:dpt1:steuern 1/0/1:dpt1:status
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG DbLogInclude state
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG IODev tul
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG devStateIcon status-on:general_an:Aus status-off:general_aus:Ein steuern.*:hourglass:Aus
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG eventMap /steuern on:Ein/steuern off:Aus/
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG readonly 0
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG room KNX
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG stateRegex /steuern-[sg]et:/steuern-/ /status-get:/status-/
attr KNX01.O01_Aktor_Leuchte_Flur_EG_OG webCmd Ein:Aus
define DF_move_heat DOIF ([+600] &&\
[DF_move_heat_1t3_C1:zustand] eq "true" && \
[DF_move_heat_1t3_C2:zustand] eq "true" &&\
[DF_move_heat_1t3_C3:zustand] eq "true" &&\
[DF_move_heat_1t3_C4:zustand] eq "true" &&\
[DF_move_heat_1t3_C5:zustand] eq "true" &&\
[$SELF:pump_mode1t3] eq "auto" &&\
[KNX32.O03_Aktor_UWP_1500_3000:state:sec] > 300 &&\
[KNX32.O02_Aktor_UWP_3000_1500:state:sec] > 300\
)\
(\
## cmd_1_1\
set KNX32.O02_Aktor_UWP_3000_1500 off,\
set KNX32.O03_Aktor_UWP_1500_3000 on,\
{ log_telegram("0","$SELF","schalte Pumpe 1to3 _ on _\nschalte Pumpe 3to1 _ off _","alarmbot");; }\
)\
DOELSEIF\
([+600] && (\
[DF_move_heat_3t1_A1:zustand] eq "true" || \
	([DF_move_heat_3t1_A2:zustand] eq "true" &&\
	[DF_move_heat_3t1_A3:zustand] eq "true" &&\
	[DF_move_heat_3t1_A4:zustand] eq "true" &&\
	[DF_move_heat_3t1_A5:zustand] eq "true" &&\
	[DF_move_heat_3t1_A6:zustand] eq "true" &&\
	[$SELF:pump_mode3t1] eq "auto"))&&\
[KNX32.O03_Aktor_UWP_1500_3000:state:sec] > 300 &&\
[KNX32.O02_Aktor_UWP_3000_1500:state:sec] > 300\
)\
({\
##cmd_2_1\
if([RE_TEMP_PS3000_11:temperature] > [RE_TEMP_Speicher_10]+5)\
	{\
	fhem("set PID.FUBO reset");;\
	fhem("set DF_controlVL disable");;\
	fhem("set D_HZfhem_Relais1_FUBO_warm 0.1");;\
	fhem("set D_HZfhem_Relais2_FUBO_kalt 150");;\
	}\
	elsif([RE_TEMP_PS3000_11:temperature] < 40 && [RE_TEMP_Speicher_10:temperature] < 40 && [DF_calcVLSoll:vltemp] > [RE_TEMP_VorlaufHK:temperature]+3 )\
	{\
	fhem("set PID.FUBO reset");;\
	fhem("set DF_controlVL disable");;	\
	fhem("set D_HZfhem_Relais2_FUBO_kalt 0");;\
	fhem("set D_HZfhem_Relais1_FUBO_warm 150");;\
	}\
fhem("set KNX32.O03_Aktor_UWP_1500_3000 off");;\
fhem("set KNX32.O02_Aktor_UWP_3000_1500 on");;\
log_telegram("0","$SELF","schalte Pumpe 1to3 _ off _\nschalte Pumpe 3to1 _ on _","alarmbot");;\
})\
(\
##cmd_2_2\
set DF_controlVL initialize\
)\
DOELSEIF([$SELF:pump_mode1t3] eq "man_on")\
	(\
	##cmd_3_1\
		set KNX32.O03_Aktor_UWP_1500_3000 on\
	)\
	(\
	##cmd_3_2\
		setreading $SELF pump_mode1t3 auto,\
		set $SELF checkall\
	)\
DOELSEIF([$SELF:pump_mode1t3] eq "man_off")\
	(\
	##cmd_4_1\
		set KNX32.O03_Aktor_UWP_1500_3000 off,\
		setreading $SELF pump_mode1t3 man_off,\
		set DF_controlVL initialize\
	)\
	(\
	##cmd_4_2\
		setreading $SELF pump_mode1t3 auto,\
		set $SELF checkall\
	)\
DOELSEIF([$SELF:pump_mode3t1] eq "man_on")\
	(\
	##cmd_5_1\
		set KNX32.O02_Aktor_UWP_3000_1500 on,\
		setreading $SELF pump_mode3t1 man_on,\
		{\
			if([RE_TEMP_PS3000_11:temperature] > [DF_calcVLSoll:vltemp]+5)\
				{\
				fhem("set PID.FUBO reset");;\
				fhem("set DF_controlVL disable");;\
				fhem("set D_HZfhem_Relais1_FUBO_warm 0.1");;\
				fhem("set D_HZfhem_Relais2_FUBO_kalt 150");;\
				}\
		}\
	)\
	(\
	##cmd_5_2\
		setreading $SELF pump_mode3t1 auto,\
		set $SELF checkall\
	)\
DOELSEIF([$SELF:pump_mode3t1] eq "man_off")\
	(\
	##cmd_6_1\
		set KNX32.O02_Aktor_UWP_3000_1500 off,\
		setreading $SELF pump_mode3t1 man_off,\
		set DF_controlVL initialize\
	)\
	(\
	##cmd_6_2\
		setreading $SELF pump_mode3t1 auto,\
		set $SELF checkall\
	)\
DOELSEIF([$SELF:pump_mode1t3] eq "auto" && [$SELF:pump_mode3t1] eq "auto" &&\
[KNX32.O03_Aktor_UWP_1500_3000:state:sec] > 150 &&\
[KNX32.O02_Aktor_UWP_3000_1500:state:sec] > 150)\
(\
##cmd_7_1\
set KNX32.O03_Aktor_UWP_1500_3000 off,\
set KNX32.O02_Aktor_UWP_3000_1500 off,\
set DF_controlVL initialize\
)\
(\
##cmd_7_2\
{\
log_telegram("0","$SELF","schalte Pumpe 1to3 _ off _\nschalte Pumpe 3to1 _ off _","alarmbot");;\
}\
)\
DOELSE\
(\
		setreading $SELF pump_mode3t1 auto,\
		setreading $SELF pump_mode1t3 auto,\
		set DF_controlVL initialize\
)
attr DF_move_heat DOIF_Readings VLSoll: [DF_calcVLSoll:vltemp:d],\
spreizung: [RE_TEMP_VorlaufHK:temperature:d] - [RE_TEMP_RuecklaufHK:temperature:d]
attr DF_move_heat disable 1
attr DF_move_heat room Heizung_Puffer,_doif,Solar
attr DF_move_heat selftrigger all
attr DF_move_heat wait 15:15,150:0,3600:0,3600:0,3600:0,30:0
define LD382LED WifiLight RGB LD382:192.168.0.134
attr LD382LED colorCast 0, -20, -20, -25, 0, -10
attr LD382LED whitePoint 1, 0.75, 0.25
define BTG_HTTPMOD HTTPMOD https://www.bitcoin.de/de/btgeur/market 600
attr BTG_HTTPMOD userattr reading01Name reading01Regex reading02Name reading02Regex reading03Name reading03Regex readingFormat
attr BTG_HTTPMOD reading01Name ticker_price
attr BTG_HTTPMOD reading01Regex id="ticker_price">(.*)<
attr BTG_HTTPMOD reading02Name rate_buy
attr BTG_HTTPMOD reading02Regex id="rate_buy" data-rate="(.*)">
attr BTG_HTTPMOD reading03Name rate_sell
attr BTG_HTTPMOD reading03Regex id="rate_sell" data-rate="(.*)">
attr BTG_HTTPMOD room crypto
attr BTG_HTTPMOD stateFormat ticker_price
attr BTG_HTTPMOD userReadings rate:ticker_price.* {my $v = ReadingsVal($name,"ticker_price",0);; $v =~ s/\.//g;; $v =~ s/,/./;; $v},\
buy:rate_buy.* {my $v = ReadingsVal($name,"rate_buy",0);; $v =~ s/\,//g;; $v},\
sell:rate_sell.* {my $v = ReadingsVal($name,"rate_sell",0);; $v =~ s/\,//g;; $v}
attr BTG_HTTPMOD verbose 2
define spotify Spotify f766e1b78d93486480a103f224ce3a11 f1b58132ee8c43d4b5e835503b448df4 https://oskar.pw/
attr spotify webCmd toggle:next:prev:volumeUp:volumeDown
define DF_move_heat_1t3_C1 DOIF ([D_WMZ_Solar:power:d] > 1000)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_1t3_C1 userattr room_map structexclude
attr DF_move_heat_1t3_C1 disable 1
attr DF_move_heat_1t3_C1 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_1t3_C1 stateFormat zustand
define DF_move_heat_1t3_C2 DOIF ([RE_TEMP_Ruecklauf_Solar:temperature:d] > [RE_TEMP_PS3000_02:temperature:d]+1)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSEIF \
([RE_TEMP_Ruecklauf_Solar:temperature:d] < [RE_TEMP_PS3000_02:temperature:d]-1)\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_1t3_C2 userattr room_map structexclude
attr DF_move_heat_1t3_C2 disable 1
attr DF_move_heat_1t3_C2 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_1t3_C2 stateFormat zustand
define DF_move_heat_1t3_C3 DOIF ([RE_TEMP_Speicher_07:temperature:d] > 45)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_1t3_C3 userattr room_map structexclude
attr DF_move_heat_1t3_C3 disable 1
attr DF_move_heat_1t3_C3 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_1t3_C3 stateFormat zustand
define DF_move_heat_1t3_C4 DOIF ([RE_TEMP_Speicher_09:temperature:d] > [RE_TEMP_PS3000_10:temperature:d])\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_1t3_C4 userattr room_map structexclude
attr DF_move_heat_1t3_C4 disable 1
attr DF_move_heat_1t3_C4 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_1t3_C4 stateFormat zustand
define DF_Jahreszeit DOIF ## FrÃ¼hling\
([00:01] && $month>=4 && $month<=5)\
(\
set remotebot message 1\
)\
DOELSEIF\
## Sommer\
([00:01] && $month>=6 && $month<=8)\
(\
set remotebot message 2\
)\
DOELSEIF\
## Herbst\
([00:01] && $month>=9 && $month<=10)\
(\
set remotebot message 3\
)\
DOELSEIF\
## Winter\
([00:01] && $month<=3 || $month>=11)\
(\
set remotebot message 4\
)
attr DF_Jahreszeit cmdState fruehling|sommer|herbst|winter
attr DF_Jahreszeit room x_devel
define FritzBoxSNSH FRITZBOX
attr FritzBoxSNSH INTERVAL 60
attr FritzBoxSNSH allowTR064Command 1
attr FritzBoxSNSH devStateIcon .*on.*off:WLAN_on_gWLAN_off .*on.*on.*:WLAN_on_gWLAN_on WLAN..off.*:WLAN_off
attr FritzBoxSNSH event-on-change-reading mac_.*,stephan.*,nadine.*
attr FritzBoxSNSH room presence
attr FritzBoxSNSH userReadings stephan {ReadingsVal("FritzBoxSNSH","mac_90_94_97_F8_73_51","ccc") eq "inactive" ? "inactive":ReadingsAge("FritzBoxSNSH","mac_90_94_97_F8_73_51","gone");; },\
nadine {ReadingsVal("FritzBoxSNSH","mac_38_94_96_9B_85_07","ccc") eq "inactive" ? "inactive":ReadingsAge("FritzBoxSNSH","mac_38_94_96_9B_85_07","gone");; }
define DF_presenceFB DOIF (["FritzBoxSNSH:mac"])\
({\
my ($dev, $eve) = split(": ","$EVENT");;\
my ($aa, $speed, $rssi) = split(",", "$eve");;\
my ($nam, $net) = split(" ", "$aa");;\
$net = substr($net,1);;\
##chop $rssi;;\
fhem("setreading $SELF _device $dev");;\
fhem("setreading $SELF _name $nam");;\
fhem("setreading $SELF _network $net");;\
fhem("setreading $SELF _speed $speed");;\
fhem("setreading $SELF _rssi $rssi");;\
fhem("setreading $SELF $dev active")\
})\
\

attr DF_presenceFB do always
attr DF_presenceFB event-on-change-reading _.*
attr DF_presenceFB notexist notexist
attr DF_presenceFB room _doif,presence
attr DF_presenceFB widgetOverride cmdState:textField-long
define DF_presence3 DOIF (["FritzBoxSNSH:mac"])(\
{\
my $a, $b = split(": ","$EVENT");;\
fhem("set alarmbot message $a");;\
fhem("set alarmbot message $b");;\
\
})
attr DF_presence3 do always
attr DF_presence3 room _doif,x_devel
define CAL_calview CALVIEW CAL 3600
attr CAL_calview modes next
define DF_move_heat_3t1_A1 DOIF ([RE_TEMP_PS3000_02:temperature:d] > 40 && [RE_TEMP_Speicher_01:temperature:d] < 40 && ([RE_TEMP_HV_VL:temperature] > 80 || [RE_TEMP_HV_VL2:temperature] > 80))\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A1 disable 1
attr DF_move_heat_3t1_A1 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A1 stateFormat zustand
define DF_move_heat_3t1_A2 DOIF ([KNX32.O03_Aktor_UWP_1500_3000:state] eq "off")\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A2 disable 1
attr DF_move_heat_3t1_A2 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A2 stateFormat zustand
define DF_move_heat_3t1_A3 DOIF ([RE_TEMP_Speicher_04:temperature:d] > 50 || [RE_TEMP_AUSSEN:temperature:d] > 21)\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])\
DOELSEIF([RE_TEMP_Speicher_04:temperature:d] < 45 || [RE_TEMP_AUSSEN:temperature:d] < 18)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A3 disable 1
attr DF_move_heat_3t1_A3 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A3 stateFormat zustand
define DF_move_heat_3t1_A4 DOIF (ReadingsVal([DF_Grenzfuehler:grenzfuehler_nice],"temperature","errrorr") < [DF_calcVLSoll:vltemp:d] )\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A4 DOIF_Readings gfTemperature:ReadingsVal([DF_Grenzfuehler:grenzfuehler_nice],"temperature","errrorr")
attr DF_move_heat_3t1_A4 disable 1
attr DF_move_heat_3t1_A4 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A4 stateFormat zustand
define DF_move_heat_3t1_A5 DOIF ([RE_TEMP_PS3000_11:temperature:d] > [RE_TEMP_VorlaufHK:temperature:d]+1)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSEIF([RE_TEMP_PS3000_11:temperature:d] < [RE_TEMP_VorlaufHK:temperature:d]-1)\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A5 disable 1
attr DF_move_heat_3t1_A5 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A5 stateFormat zustand
define DF_move_heat_3t1_A6 DOIF (\
[RE_TEMP_PS3000_11:temperature:d]+2 > [RE_TEMP_Speicher_09:temperature:d] && \
[RE_TEMP_PS3000_11:temperature:d]+5 > [RE_TEMP_Speicher_10:temperature:d] &&\
[RE_TEMP_Speicher_01:temperature:d] < [RE_TEMP_VorlaufHK:temperature]-1\
)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSEIF([RE_TEMP_PS3000_11:temperature:d] < [RE_TEMP_Speicher_09:temperature:d] && [RE_TEMP_PS3000_11:temperature:d] < [RE_TEMP_Speicher_10:temperature:d])\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_3t1_A6 disable 1
attr DF_move_heat_3t1_A6 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_3t1_A6 stateFormat zustand
define DF_Grenzfuehler DOIF ([wetter_prop:fc0_prg_ges])(\
{\
my %temps = getHashTemps();;\
my $ertrag = [$SELF:ertrag:d];;\
my $AT = [RE_TEMP_AUSSEN:temperature:d];;\
my $value = int(($AT*0.15)+4);;\
my $log_name = "DF_Grenzfuehler";;\
\
if($ertrag <= 40)\
{\
$value = 3;;\
log_telegram("0","$SELF","Solarertrag $ertrag kWh < 10: Grenze auf $value","remotebot");;\
}\
elsif($ertrag > 40)\
{\
## entscheidung wird nach AT gefällt \
log_telegram("0","$SELF","Solarertrag $ertrag kWh > 40: Grenze auf $value","remotebot");;\
}\
## Grenze mindestens auf 2, damit ich noch Reserve habe.\
$value = $value < 3 ? 3:$value;;\
$value = $value > 8 ? 8:$value;;\
\
my $zero = $value > 9 ? "":"0";;\
my $grenzfuehler = "15" . $zero . $value;;\
\
fhem("setreading DF_Grenzfuehler grenzfuehler $grenzfuehler");;\
fhem("setreading DF_Grenzfuehler grenzfuehler_nice RE_TEMP_Speicher_$zero$value");;\
\
fhem("setreading DF_Grenzfuehler temperature $temps{$grenzfuehler}");;\
\
\
})
attr DF_Grenzfuehler DOIF_Readings ertrag: [wetter_prop:fc0_prg_ges]
attr DF_Grenzfuehler do always
attr DF_Grenzfuehler room Heizung_Puffer,_doif
attr DF_Grenzfuehler stateFormat grenzfuehler:temperature
define DF_calcAllEnergy DOIF ([+3600])(\
{\
##my $VL = ReadingsNum("RE_TEMP_VorlaufHK","temperature",0);;\
##my $RL = ReadingsNum("RE_TEMP_RuecklaufHK","temperature",0);;\
##my $literpromin = int(10*ReadingsNum("D_WMZ_Heizung_main","literpromin",0))/10;;\
##my $leistung = ReadingsNum("D_WMZ_Heizung_main","power",0);;\
##my $hk1 = sprintf("P: %d W V: %0.2f l/min VL: %0.2f °C RL: %0.2f °C" , $leistung,$literpromin,$VL,$RL);;\
my $hk2 = int(10*SQLselectSUM("current_day_begin", "current_day_end", "VALUE","D_WMZ_Heizung_main", "work","funktion")/1000)/10 . " kWh";;\
my $hk3 = int(10*SQLselectSUM("previous_day_begin", "previous_day_end", "VALUE","D_WMZ_Heizung_main", "work","funktion")/1000)/10 . " kWh";;\
my $hk4 = int(10*SQLselectSUM("30", "0", "VALUE","D_WMZ_Heizung_main", "work","funktion")/1000)/10 . " kWh";;\
fhem("setreading $SELF Heizenergie_heute $hk2;; setreading $SELF Heizenergie_gestern $hk3;; setreading $SELF Heizenergie_30T $hk4");;\
\
##my $VL = ReadingsNum("RE_TEMP_Vorlauf_Solar","temperature",0);;\
##my $RL = ReadingsNum("RE_TEMP_Ruecklauf_Solar","temperature",0);;\
##my $literpromin = ReadingsNum("D_WMZ_Solar","literpromin",0);;  \
##my $leistung = ReadingsNum("D_WMZ_Solar","power",0);;\
##my $sk1 = sprintf("P: %s V: %s VL: %d °C RL: %d °C" , $leistung,$literpromin,$VL,$RL);;\
my $sk2 = int(10*SQLselectSUM("current_day_begin", "current_day_end", "VALUE","D_WMZ_Solar", "work","funktion")/1000)/10 . " kWh";;\
my $sk3 = int(10*SQLselectSUM("previous_day_begin", "previous_day_end", "VALUE","D_WMZ_Solar", "work","funktion")/1000)/10 . " kWh";;\
\
fhem("setreading $SELF Solarenergie_heute $sk2;; setreading $SELF Solarenergie_gestern $sk3");;\
\
##my $VL = ReadingsNum("RE_TEMP_HV_VL","temperature",0);;\
##my $RL = ReadingsNum("RE_TEMP_HV_RLA","temperature",0);;\
##my $literpromin = ReadingsNum("KNX10.I05_Zaehler_Holzvergaser","literpromin",0);;  \
##my $leistung = ReadingsNum("KNX10.I05_Zaehler_Holzvergaser","power",0);;\
##my $hvk1 = sprintf("P: %s V: %s VL: %d °C RLA: %d °C" , $leistung,$literpromin,$VL,$RL);;\
my $hvk2 = int(10*SQLselectSUM("current_day_begin", "current_day_end", "VALUE","KNX10.I05_Zaehler_Holzvergaser", "lastliterwork","funktion")/1000)/10 . " kWh";;\
my $hvk3 = int(10*SQLselectSUM("previous_day_begin", "previous_day_end", "VALUE","KNX10.I05_Zaehler_Holzvergaser", "lastliterwork","funktion")/1000)/10 . " kWh";;\
my $hvk4 = int(10*SQLselectSUM("30", "0", "VALUE","KNX10.I05_Zaehler_Holzvergaser", "lastliterwork","funktion")/1000)/10 . " kWh";;\
\
\
fhem("setreading $SELF Holzenergie_heute $hvk2;; setreading $SELF Holzenergie_gestern $hvk3;; setreading $SELF Holzenergie_30T $hvk4");;\
\
\
my $gv1 =  SQLselectDIFF("current_day_begin", "current_day_end", "VALUE","KNX10.I08_Gaszaehler_KNX", "total","funktion") . " m3";;\
my $gv2 =  SQLselectDIFF("previous_day_begin", "previous_day_end", "VALUE","KNX10.I08_Gaszaehler_KNX", "total","funktion") . " m3";;\
my $sv1 =  SQLselectDIFF("current_day_begin", "current_day_end", "VALUE","Stromzaehler", "total_energy","funktion") . " kWh";;\
my $sv2 =  SQLselectDIFF("previous_day_begin", "previous_day_end", "VALUE","Stromzaehler", "total_energy","funktion") . " kWh";;\
\
fhem("setreading $SELF Gasverbrauch_heute $gv1;; setreading $SELF Gasverbrauch_gestern $gv2;; setreading $SELF Stromverbrauch_heute $sv1;; setreading $SELF Stromverbrauch_gestern $sv2");;\
\
\
}\
)
attr DF_calcAllEnergy room Heizung,_doif
define DF_WMZ_Solar DOIF ([OWX_1D_19DC84000003:"A_rate"] && ([{sunrise()}-{sunset("3600")}]))\
({\
my ($a1,$b1) = split(" ", "$EVENT");;\
fhem("setreading $SELF rate $b1");;\
my $aa = [$SELF:power];;\
my $bb = [$SELF:power:sec];;\
my $cc = [$SELF:workDay];;\
my $dd = (( $aa * $bb ) / 3600 / 1000 ) + $cc;;\
fhem("setreading $SELF workDay $dd");;\
})\
DOELSEIF([23:59])\
(\
setreading $SELF solarerwartung_heute [wetter_prop:fc0_prg_ges],\
setreading $SELF solarerwartung_morgen [wetter_prop:fc1_prg_ges],\
setreading $SELF solarerwartung_uebermorgen [wetter_prop:fc2_prg_ges],\
setreading $SELF workDay 0\
)\
DOELSE\
(\
setreading $SELF rate 0\
)
attr DF_WMZ_Solar DOIF_Readings VL:([RE_TEMP_Vorlauf_Solar:temperature]),\
RL:([RE_TEMP_Ruecklauf_Solar:temperature]),\
deltaT:([$SELF:VL]-[$SELF:RL]),\
heat_cap:({heat_capacity_solarfluid()}),\
power:([$SELF:rate]*3600*1.05*[$SELF:deltaT]),\
work:([$SELF:rate]*1.05*[$SELF:work:sec]),\
literprosec:([$SELF:rate]),\
literpromin:([$SELF:rate]*60)
attr DF_WMZ_Solar DbLogInclude power,literpromin
attr DF_WMZ_Solar do always
attr DF_WMZ_Solar room FHEM2FHEM,Solar,_doif
attr DF_WMZ_Solar selftrigger all
attr DF_WMZ_Solar stateFormat power
define DF_WMZ_HZG_main DOIF ([OWX_1D_18DC84000003:"B_rate"])({\
my ($a1,$b1) = split(" ", "$EVENT");;\
$b1 = $b1/52;;\
fhem("setreading $SELF rate $b1");;\
\
my $aa = [$SELF:power];;\
my $bb = [$SELF:power:sec];;\
my $cc = [$SELF:workDay];;\
my $dd = (( $aa * $bb ) / 3600 / 1000 ) + $cc;;\
fhem("setreading $SELF workDay $dd");;\
})\
DOELSEIF([23:59])\
(\
setreading $SELF workDay 0\
)
attr DF_WMZ_HZG_main DOIF_Readings VL:([RE_TEMP_VorlaufHK:temperature]),\
RL:([RE_TEMP_RuecklaufHK:temperature]),\
deltaT:([$SELF:VL]-[$SELF:RL]),\
p1:([$SELF:rate]*3600*1.16*[$SELF:deltaT]),\
power:([$SELF:p1:d0]),\
work:([$SELF:rate]*1.16*[$SELF:work:sec]),\
literprosec:([$SELF:rate]),\
literpromin:([$SELF:rate]*60)
attr DF_WMZ_HZG_main do always
attr DF_WMZ_HZG_main room FHEM2FHEM,Heizung,_doif
attr DF_WMZ_HZG_main selftrigger all
attr DF_WMZ_HZG_main stateFormat power
define DF_stored_heating_Energy DOIF ([+:15] || [?DF_WMZ_HZG_main:power] || [?DF_WMZ_Solar:power] )(\
{\
my $ene0 = 0;;\
my $ene1 = 0;;\
my $var;;\
my %temps = getHashTemps();;\
my $VLSoll = ReadingsNum("DF_calcVLSoll","vltemp",0);;\
for my $k (keys %temps){\
$var = 0;;\
	if($k =~ /15/){\
			if ($temps{$k}-$VLSoll > 0){\
				\
				$var = int(100*(150*1.16*($temps{$k}-$VLSoll))/1000)/100;;\
				fhem("setreading $SELF $k $var");;\
				$ene0 += $var;;\
			}\
			else\
			{\
				fhem("setreading $SELF $k 0");;\
			}\
	} elsif ($k =~ /30/){\
			if ($temps{$k}-$VLSoll > 0){\
				$var = int(100*(272*1.16*($temps{$k}-$VLSoll))/1000)/100;;\
				fhem("setreading $SELF $k $var");;\
				$ene1 += $var;;\
			}			\
			else\
			{\
				fhem("setreading $SELF $k 0");;\
			}\
	}\
}\
				fhem("setreading $SELF 1500 $ene0");;\
				fhem("setreading $SELF 3000 $ene1");;\
my $HZG_pwr = ReadingsVal("DF_WMZ_HZG_main","power","error");;\
fhem("setreading $SELF HZG_pwr $HZG_pwr");;\
my $Solar_pwr = ReadingsVal("DF_WMZ_Solar","power","error");;\
fhem("setreading $SELF Solar_pwr $Solar_pwr");;\
\
\
\
\
\
### Berechnung, wie lange man noch heizen kann: \
my $heating_pwr_corr = ReadingsVal("DF_WMZ_HZG_main","power","error") - ReadingsVal("DF_WMZ_Solar","power",0);;\
my $heating_pwr_kW = $heating_pwr_corr/1000;;\
my $timeleft = $heating_pwr_kW > 0 ? int(($ene1+$ene0)/$heating_pwr_kW):"in > out";;\
fhem("setreading $SELF ene1 $ene1");;\
fhem("setreading $SELF ene0 $ene0");;\
fhem("setreading $SELF timeleft $timeleft");;\
fhem("setreading $SELF power $heating_pwr_kW");;\
\
\
\
})
attr DF_stored_heating_Energy do always
attr DF_stored_heating_Energy room Heizung_Puffer,Wasser,_doif
define DF_stored_shower_Energy DOIF ([+:15] || [?DF_WMZ_HZG_main:power] || [?DF_WMZ_Solar:power] )(\
{\
my $ene0 = 0;;\
my $ene1 = 0;;\
my $var;;\
my %temps = getHashTemps();;\
my $VLTemp = 35;;\
for my $k (keys %temps){\
$var = 0;;\
	if($k =~ /15/){\
			if ($temps{$k}-$VLTemp > 0){\
				\
				$var = int(100*(150*1.16*($temps{$k}-$VLTemp))/1000)/100;;\
				fhem("setreading $SELF $k $var");;\
				$ene0 += $var;;\
			}\
			else\
			{\
				fhem("setreading $SELF $k 0");;\
			}\
	} elsif ($k =~ /30/){\
			if ($temps{$k}-$VLTemp > 0){\
				$var = int(100*(272*1.16*($temps{$k}-$VLTemp))/1000)/100;;\
				fhem("setreading $SELF $k $var");;\
				$ene1 += $var;;\
			}			\
			else\
			{\
				fhem("setreading $SELF $k 0");;\
			}\
	}\
}\
				fhem("setreading $SELF 1500 $ene0");;\
				fhem("setreading $SELF 3000 $ene1");;\
### Berechnung, wie lange man noch duschen kann: \
my $heating_pwr_corr = ReadingsVal("DF_WMZ_HZG_main","power","error") - ReadingsVal("DF_WMZ_Solar","power",0);;\
my $heating_pwr_kW = $heating_pwr_corr/1000;;\
my $timeleft = $heating_pwr_kW > 0 ? int(($ene1+$ene0)/$heating_pwr_kW):"in > out";;\
fhem("setreading $SELF ene1 $ene1");;\
fhem("setreading $SELF ene0 $ene0");;\
fhem("setreading $SELF timeleft $timeleft");;\
fhem("setreading $SELF power $heating_pwr_kW");;\
})
attr DF_stored_shower_Energy do always
attr DF_stored_shower_Energy room Heizung_Puffer,Wasser,_doif
define MQTT_SERVER MQTT2_SERVER 1883 global
attr MQTT_SERVER autocreate 1
attr MQTT_SERVER room MQTT
attr MQTT_SERVER verbose 5
define MQTT2_DVES_519FAE MQTT2_DEVICE DVES_519FAE
attr MQTT2_DVES_519FAE IODev MQTT_SERVER
attr MQTT2_DVES_519FAE readingList DVES_519FAE:tele/sonoff/LWT:.* LWT\
DVES_519FAE:cmnd/sonoff/POWER:.* POWER\
DVES_519FAE:tele/sonoff/INFO1:.* { json2nameValue($EVENT) }\
DVES_519FAE:tele/sonoff/INFO2:.* { json2nameValue($EVENT) }\
DVES_519FAE:tele/sonoff/INFO3:.* { json2nameValue($EVENT) }\
DVES_519FAE:stat/sonoff/RESULT:.* { json2nameValue($EVENT) }\
DVES_519FAE:stat/sonoff/POWER:.* POWER\
DVES_519FAE:tele/sonoff/STATE:.* { json2nameValue($EVENT) }\
DVES_519FAE:tele/sonoff/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_519FAE room MQTT2_DEVICE
define MQTT2_DVES_314F98 MQTT2_DEVICE DVES_314F98
attr MQTT2_DVES_314F98 IODev MQTT_SERVER
attr MQTT2_DVES_314F98 readingList DVES_314F98:tele/sonoff2/LWT:.* LWT\
DVES_314F98:cmnd/sonoff2/POWER:.* POWER\
DVES_314F98:tele/sonoff2/INFO1:.* { json2nameValue($EVENT) }\
DVES_314F98:tele/sonoff2/INFO2:.* { json2nameValue($EVENT) }\
DVES_314F98:tele/sonoff2/INFO3:.* { json2nameValue($EVENT) }\
DVES_314F98:stat/sonoff2/RESULT:.* { json2nameValue($EVENT) }\
DVES_314F98:stat/sonoff2/POWER:.* POWER\
DVES_314F98:tele/sonoff2/STATE:.* { json2nameValue($EVENT) }\
DVES_314F98:tele/sonoff2/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_314F98 room MQTT2_DEVICE
define MQTT2_DVES_51ACAE MQTT2_DEVICE DVES_51ACAE
attr MQTT2_DVES_51ACAE IODev MQTT_SERVER
attr MQTT2_DVES_51ACAE readingList DVES_51ACAE:tele/sonoff/LWT:.* LWT\
DVES_51ACAE:cmnd/sonoff/POWER:.* POWER\
DVES_51ACAE:tele/sonoff/INFO1:.* { json2nameValue($EVENT) }\
DVES_51ACAE:tele/sonoff/INFO2:.* { json2nameValue($EVENT) }\
DVES_51ACAE:tele/sonoff/INFO3:.* { json2nameValue($EVENT) }\
DVES_51ACAE:stat/sonoff/RESULT:.* { json2nameValue($EVENT) }\
DVES_51ACAE:stat/sonoff/POWER:.* POWER\
DVES_51ACAE:tele/sonoff/STATE:.* { json2nameValue($EVENT) }\
DVES_51ACAE:tele/sonoff/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_51ACAE room MQTT2_DEVICE
define MQTT2_DVES_342E6E MQTT2_DEVICE DVES_342E6E
attr MQTT2_DVES_342E6E IODev MQTT_SERVER
attr MQTT2_DVES_342E6E readingList DVES_342E6E:tele/sonoff/LWT:.* LWT\
DVES_342E6E:cmnd/sonoff/POWER:.* POWER\
DVES_342E6E:tele/sonoff/INFO1:.* { json2nameValue($EVENT) }\
DVES_342E6E:tele/sonoff/INFO2:.* { json2nameValue($EVENT) }\
DVES_342E6E:tele/sonoff/INFO3:.* { json2nameValue($EVENT) }\
DVES_342E6E:stat/sonoff/RESULT:.* { json2nameValue($EVENT) }\
DVES_342E6E:stat/sonoff/POWER:.* POWER\
DVES_342E6E:tele/sonoff/STATE:.* { json2nameValue($EVENT) }\
DVES_342E6E:tele/sonoff/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_342E6E room MQTT2_DEVICE
define MQTT2_DVES_33D5D9 MQTT2_DEVICE DVES_33D5D9
attr MQTT2_DVES_33D5D9 IODev MQTT_SERVER
attr MQTT2_DVES_33D5D9 readingList DVES_33D5D9:tele/sonoff/LWT:.* LWT\
DVES_33D5D9:cmnd/sonoff/POWER:.* POWER\
DVES_33D5D9:tele/sonoff/INFO1:.* { json2nameValue($EVENT) }\
DVES_33D5D9:tele/sonoff/INFO2:.* { json2nameValue($EVENT) }\
DVES_33D5D9:tele/sonoff/INFO3:.* { json2nameValue($EVENT) }\
DVES_33D5D9:stat/sonoff/RESULT:.* { json2nameValue($EVENT) }\
DVES_33D5D9:stat/sonoff/POWER:.* POWER\
DVES_33D5D9:tele/sonoff/STATE:.* { json2nameValue($EVENT) }\
DVES_33D5D9:tele/sonoff/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_33D5D9 room MQTT2_DEVICE
define MQTT2_DVES_2F439F MQTT2_DEVICE DVES_2F439F
attr MQTT2_DVES_2F439F IODev MQTT_SERVER
attr MQTT2_DVES_2F439F readingList DVES_2F439F:tele/sonoff/LWT:.* LWT\
DVES_2F439F:cmnd/sonoff/POWER:.* POWER\
DVES_2F439F:tele/sonoff/INFO1:.* { json2nameValue($EVENT) }\
DVES_2F439F:tele/sonoff/INFO2:.* { json2nameValue($EVENT) }\
DVES_2F439F:tele/sonoff/INFO3:.* { json2nameValue($EVENT) }\
DVES_2F439F:stat/sonoff/RESULT:.* { json2nameValue($EVENT) }\
DVES_2F439F:stat/sonoff/POWER:.* POWER\
DVES_2F439F:tele/sonoff/STATE:.* { json2nameValue($EVENT) }\
DVES_2F439F:tele/sonoff/UPTIME:.* { json2nameValue($EVENT) }
attr MQTT2_DVES_2F439F room MQTT2_DEVICE
define DF_move_heat_1t3_C5 DOIF ([RE_TEMP_Speicher_02:temperature:d] > [RE_TEMP_VorlaufHK:temperature:d]+2)\
(setreading $SELF zustand true,\
set remotebot message $SELF [$SELF:zustand])\
DOELSE\
(setreading $SELF zustand false,\
set remotebot message $SELF [$SELF:zustand])
attr DF_move_heat_1t3_C5 userattr room_map structexclude
attr DF_move_heat_1t3_C5 disable 1
attr DF_move_heat_1t3_C5 room Heizung_Puffer,_doif,Solar
attr DF_move_heat_1t3_C5 stateFormat zustand
define test DbRep logdb
attr test room x_devel
attr test timestamp_begin current_day_begin
define DF_move_heat_perl DOIF ([+120])(\
{\
move_heat();;\
}\
)
attr DF_move_heat_perl do always
attr DF_move_heat_perl event-on-change-reading condition.*
attr DF_move_heat_perl room Heizung_Puffer
attr DF_move_heat_perl webCmd cmd_1
define MyEasterEgg weblink htmlCode { FRITZBOX_fritztris("FritzboxSNSH") }
attr MyEasterEgg room presence
define DF_changePID DOIF ([PID.FUBO:delta] < 5 && [PID.FUBO:measured] < 38)(\
attr PID.FUBO pidFactor_D 100,\
attr PID.FUBO pidFactor_I 50,\
attr PID.FUBO pidFactor_P 600,\
set PID.FUBO reset\
)\
DOELSEIF([PID.FUBO:delta] > 5 || [PID.FUBO:measured] > 40)(\
attr PID.FUBO pidFactor_D 8000,\
attr PID.FUBO pidFactor_I 0.001,\
attr PID.FUBO pidFactor_P 1000,\
set PID.FUBO reset\
)\
## so, dann können wir hier mal erfahrungen sammeln: \
## P = 100 -> Unsinn, da bei 1° delta nur 100ms rauskommen, der Mischer aber erst bei 200 mS (neu) fährt. \
## Ab wann soll der Mischer fahren? -> 0,25° delta. daraus folgt: P minimum -> 800\
\
## Idee: da könnte man ja jetzt I verwenden... \
## P 500, I 50. Daraus ergibt sich, dass der Mischer nach 4 Zyklen 200ms fährt. und danach? \
## Mal gucken, der D steuert massiv entgegen... also wird der etwas kleiner. 100?\
## Alte Werte:\
## D 5000\
## I 0.1\
## P 450
attr DF_changePID disable 1
attr DF_changePID room Heizung,_doif
define FritzBoxSNSOG FRITZBOX 192.168.0.2
attr FritzBoxSNSOG room presence
attr FritzBoxSNSOG userReadings stephan {ReadingsVal($name,"mac_90_94_97_F8_73_51","ccc") eq "inactive" ? "inactive":ReadingsAge($name,"mac_90_94_97_F8_73_51","gone");; },\
nadine {ReadingsVal($name,"mac_38_94_96_9B_85_07","ccc") eq "inactive" ? "inactive":ReadingsAge($name,"mac_38_94_96_9B_85_07","gone");; }
define N_HVfhem_RL notify OW_HV_RL:temperature.* setreading RE_TEMP_HV_RL2 temperature $EVTPART1
attr N_HVfhem_RL room FHEM2FHEM,HolzVergaser,OW_Remote,_notify
define RE_TEMP_HV_RL2 dummy
attr RE_TEMP_HV_RL2 DbLogInclude temperature
attr RE_TEMP_HV_RL2 event-on-update-reading temperature
attr RE_TEMP_HV_RL2 group Thermometer
attr RE_TEMP_HV_RL2 room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_RL2 stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define RE_TEMP_AGT dummy
attr RE_TEMP_AGT DbLogInclude temperature
attr RE_TEMP_AGT group Thermometer
attr RE_TEMP_AGT room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_AGT stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define N_HVfhem_AGT notify D_AGT:temperature.* setreading RE_TEMP_AGT temperature $EVTPART1
attr N_HVfhem_AGT room FHEM2FHEM,HolzVergaser,OW_Remote,_notify
define RE_TEMP_HV_Kessel dummy
attr RE_TEMP_HV_Kessel DbLogInclude temperature
attr RE_TEMP_HV_Kessel group Thermometer
attr RE_TEMP_HV_Kessel room HolzVergaser,OW_Remote,_dummy
attr RE_TEMP_HV_Kessel stateFormat {sprintf("T: %.2f °C %s",ReadingsVal($name,"temperature",0),ReadingsTimestamp($name,"temperature",0))}\

define N_HZfhem_EndschalterRelais12 notify Endschalter_Relais12:status:.* { $EVTPART1 eq "offen" ? fhem("set remotebot message Mischer offen") : fhem("setreading PID.FUBO mischerposition 0") }
attr N_HZfhem_EndschalterRelais12 room FHEM2FHEM,Heizung,_notify
define DFWD_PID.FUBO_mischerpos DOIF ([PID.FUBO:mischerposition] > 150000 && [RE_TEMP_Speicher_10:temperature] < [DF_calcVLSoll:vltemp] && [RE_TEMP_HV_VL2:temperature] < 50 && [KNX32.O02_Aktor_UWP_3000_1500:setG1] eq "off")\
(set PID.FUBO stop)\
(set alarmbot message stoppe PID weil ganz offen und Speicher leer)\
DOELSEIF([RE_TEMP_HV_VL2:temperature] > 60 && [KNX32.O02_Aktor_UWP_3000_1500:setG1] eq "on")\
(set PID.FUBO reset)\
(set PID.FUBO start)\
(set alarmbot message starte PID weil HV jetzt in Betrieb)
attr DFWD_PID.FUBO_mischerpos disable 1
attr DFWD_PID.FUBO_mischerpos room Heizung,_doif
attr DFWD_PID.FUBO_mischerpos wait 30:30
define NEATO1 BOTVAC abc2006@gmx.de neato 300
attr NEATO1 actionInterval 30
attr NEATO1 room neato
attr NEATO1 webCmd startCleaning:stop:sendToBase
define NEATO2 BOTVAC abc2006@gmx.de neato 30
attr NEATO2 room neato
attr NEATO2 webCmd startCleaning:stop:sendToBase
define DF_mr DOIF ([D_test] =~ /^ok_.*/)\
(set remotebot message "alles klar")
attr DF_mr do always
attr DF_mr room x_devel
attr DF_mr uiTable WID([D_test],"uzsuSelectRadio,on-for-timer 1,")\

define DF_MR DOIF (["$SELF:button"]) \
	(	\
	set eltako ein\
	)\
	## warte 5s\
	(\
	set eltako aus\
	)\
	## warte 2 Minuten\
	(	\
	set eltako ein\
	)\
	## warte 5s\
	(\
	set eltako aus\
	)
attr DF_MR cmdState on|off
attr DF_MR readingList mybutton mybegin myend
attr DF_MR room _doif,x_devel
attr DF_MR setList button:noArg
attr DF_MR wait 0,5,120,5
attr DF_MR webCmd button
define PID_HZFHEM PID20 RE_TEMP_VorlaufHK:temperature D_MischerPOOLPID
attr PID_HZFHEM DbLogInclude .*
attr PID_HZFHEM event-on-change-reading p_.*,actuation.*,desired,measured,delta
attr PID_HZFHEM pidActorInterval 1
attr PID_HZFHEM pidActorLimitLower 0
attr PID_HZFHEM pidActorLimitUpper 270
attr PID_HZFHEM pidActorTreshold 0
attr PID_HZFHEM pidActorValueDecPlaces 0
attr PID_HZFHEM pidCalcInterval 120
attr PID_HZFHEM pidFactor_D 5
attr PID_HZFHEM pidFactor_I 1
attr PID_HZFHEM pidFactor_P 5
attr PID_HZFHEM room Heizung
define DF_Stromzaehlerauswertung DOIF (1)(\
{\
my $first = SQLselectSingle("SELECT VALUE,TIMESTAMP from `history` where DEVICE='Stromzaehler' AND READING='total_energy' and AND TIMESTAMP >='2018-01-01 00:00:00' AND TIMESTAMP <'2018-01-01 01:00:00' order by TIMESTAMP asc LIMIT 1");;\
my $last = SQLselectSingle("SELECT VALUE,TIMESTAMP from `history` where DEVICE='Stromzaehler' AND READING='total_energy' and AND TIMESTAMP >='2018-12-20 00:00:00' AND TIMESTAMP <'2018-12-31 23:59:59' order by TIMESTAMP asc LIMIT 1");;\
fhem("setreading $SELF first $first");;\
fhem("setreading $SELF last $last");;\
\
}\
)
attr DF_Stromzaehlerauswertung room Logging
define SVG_PID_HZFHEM SVG logdb:SVG_PID_HZFHEM:HISTORY
attr SVG_PID_HZFHEM endPlotNow 1
attr SVG_PID_HZFHEM plotsize 1300,800
attr SVG_PID_HZFHEM room Heizung,SVG,x_devel
define DF_choosePID DOIF ([$SELF:status] eq "FUBO")(\
	set PID_HZFHEM stop,\
	set PID.FUBO reset,\
	set PID.FUBO start\
)\
DOELSEIF([$SELF:status] eq "HZFHEM")(\
	set PID.FUBO stop,\
	set PID_HZFHEM reset,\
	set PID_HZFHEM start	\
)
attr DF_choosePID DbLogInclude cmd
attr DF_choosePID do always
attr DF_choosePID readingList status
attr DF_choosePID room Heizung
attr DF_choosePID selftrigger all
attr DF_choosePID setList status
attr DF_choosePID webCmd status
attr DF_choosePID widgetOverride status:uzsuSelectRadio,FUBO,HZFHEM
